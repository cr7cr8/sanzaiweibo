{"version":3,"sources":["Images/logo.svg","Images/clippath.svg","contexts/axios.js","config.js","contexts/ThemeContextProvider.jsx","RegisterForm.jsx","contexts/UserContextProvider.jsx","ColorSetter.jsx","FontSizeSetter.jsx","AvatarSetter.jsx","BackPictureSetter.jsx","Button.jsx","WidthSetter.jsx","ThemeSetter.jsx","LoginForm.jsx","LogoutForm.jsx","Avatar.jsx","Avatar2.jsx","Navbar.jsx","LinkPlugin.jsx","ImgTag.jsx","Uploader.jsx","ImagePlugin.jsx","DraftEditor4.jsx","EmojiPlugin.jsx","MentionPlugin.jsx","Content.jsx","BackPicture.jsx","App.js","serviceWorker.js","index.js"],"names":["module","exports","getToken","localStorage","getItem","axios","interceptors","request","use","response","defaults","headers","common","url","ThemeContext","createContext","useFontSize","valuePC","valuePhone","isComputer","useMediaQuery","query","useState","fontSizePC","setFontSizePC","fontSizePhone","setFontSizePhone","value","pre","Math","max","toFixed","pc","phone","ThemeContextProvider","props","useContext","UserContext","userName","themeData","setThemeData","useEffect","setColor1","color1","setColor2","color2","setColor3","color3","setColor4","color4","setColor5","color5","setBothFontSize1","fontSizePC1","fontSizePhone1","setBothFontSize2","fontSizePC2","fontSizePhone2","setBothFontSize3","fontSizePC3","fontSizePhone3","setBothFontSize4","fontSizePC4","fontSizePhone4","setBothFontSize5","fontSizePC5","fontSizePhone5","setLogoImageSizePC","logoImageSizePC","setLogoImageSizePhone","logoImageSizePhone","setLogoTextSizePC","logoTextSizePC","setLogoTextSizePhone","logoTextSizePhone","setAvatarSizePC","avatarSizePC","setAvatarSizePhone","avatarSizePhone","setBackPicOrianPC","backPicOrianPC","setBackPicOrianPhone","backPicOrianPhone","setBackPicOpacity","backPicOpacity","setEditorWidthPC","editorWidthPC","setEditorWidthPhone","editorWidthPhone","setFontSize1","setFontSize2","setFontSize3","setFontSize4","setFontSize5","width","minWidth","maxWidth","ratioRemAndPx","setRatioRemAndPx","setLogoSize","useCallback","setAvatarSize","setBackPicOrian","setEditorWidth","newWidth","newMin","newMax","min","theme","useMemo","fontSize1","fontSize2","fontSize3","fontSize4","fontSize5","logoImageSize","logoTextSize","avatarSize","backPicOrian","editorWidth","editorMinWidth","editorMaxWidth","uploadTheme","post","then","console","log","data","catch","err","downloadTheme","get","showThemeSetter","setShowThemeSetter","showLogin","setShowLogin","showRegister","setShowRegister","showLogout","setShowLogout","Provider","children","Div","styled","div","DivSub","RegisterForm","register","setuserName","password","setPassword","onClick","e","htmlFor","id","type","placeholder","onChange","currentTarget","style","marginTop","UserContextProvider","jwtDecode","setUserName","friendsList","setFriendsList","Set","contentList","setContentList","downloadContentList","map","content","_id","length","alert","arr","sort","item1","item2","contentNum","setContentNum","countContentNum","Number","userBackPicture","setUserBackPicture","isMobile","responseType","onDownloadProgress","progressEvent","base64","btoa","Uint8Array","reduce","byte","String","fromCharCode","userAvatar","setUserAvatar","downloadAvatar","picDataList","setPicDataList","uploadBackPicture","pic","FormData","append","JSON","stringify","filename","name","trim","ownerName","uploadTime","Date","now","onUploadProgress","percentCompleted","floor","loaded","total","uploadAvatar","login","setItem","window","location","assign","logout","removeItem","uploadFriendsList","friendsArr","filter","includes","uploadContentList","preHtml","deleteContentList","poster","colorArr","SVG","opacity","height","version","xmlns","x","y","stroke","fill","strokeWidth","ColorBlog","attrs","backgroundColor","color","clipPath","match","Pannel","getRGB","str","red","green","blue","alpha","ColorSetter","setColor","count","useRef","current","indexArr","key","colorElement","indexC","r","g","b","temp","i","push","element","FontSizeSetter","fontSize","setFontSize","AvartarSetter","inputRef","setPic","marginBottom","display","ref","files","click","src","URL","createObjectURL","BackPictureSetter","Button_","button","Button","WidthSetter","pos","ThemeSetter","index","setIndex","justifyContent","alignItems","position","left","top","zIndex","flexDirection","overflow","boxShadow","defaultValue","target","right","AvatarSetter","LoginForm","LogoutForm","isSmall","replace","img","oriantation","LongMentionOffHead","imgurl","peopleName","borderTopLeftRadius","borderBottomLeftRadius","isFriendBefore","answer","confirm","people","isFirefox","borderRadius","backgroundPosition","backgroundImage","backgroundRepeat","backgroundSize","LongMentionOffBody","lineHeight","Avatar4","imgOnly","verticalAlign","random","toString","LogoDiv","MenuDiv","Navbar","logo","ratio","linkStyleMap","linkStyle","textDecoration","ImgTag","isIcon","setSrc","Uploader","insertImageBlock","deleteImageBlock","EditorContext","showPlugin","toggleShow","isOn","picList","setPicList","uploadProgress","setUploadProgress","percent","uploadPicture","flexWrap","prop","setOn","Object","keys","item","ImageUnit","textAlign","marginRight","disabled","marginLeft","document","getElementById","progress","setProgress","downloadPicture","callback","imgUrl","imgId","iconid","picid","obj","deleteFromObject","hasOwnProperty","keyPart","k","indexOf","genKey","result","characters","charactersLength","charAt","externalES","externalSetEditorState","imgdata","selection","getSelection","contentState","getCurrentContent","currentBlock","getBlockForKey","getEndKey","blockMap","getBlockMap","blocksBefore","toSeq","takeUntil","v","blocksAfter","skipUntil","rest","newBlockKey","newBlockKey2","newBlocks","getKey","ContentBlock","text","Immutable","fromJS","imgData","newBlockMap","concat","toOrderedMap","merge","selectionBefore","selectionAfter","anchorKey","anchorOffset","focusKey","focusOffset","isBackward","hasFocus","EditorState","block","getType","getText","getFocusKey","ImagePluginPanel","imagePlugin","editorState","setEditorState","createImagePlugin","emojiUrl","emoji","insertEmoji","toArray","anchorStartKey","anchorStartOffset","newContent","Modifier","replaceText","newSelection","acceptSelection","getEmoji","forEach","icon","emojiPlugin","keyBindingFn","getEditorState","ctrlKey","shiftKey","keyCode","handleKeyCommand","command","oldSelection","getBlocksAsArray","blockKey","blockText","getCharacterList","getEntity","applyEntity","emojiKey","matchArr","regx","RegExp","array","exec","start","offset","entityKey","createEntity","getLastCreatedEntityKey","taggingEmoji","decorators","strategy","contentBlock","findEntityRanges","character","component","offsetKey","end","decoratedText","iconRef","className","EmojiPluginPanel","float","onMouseEnter","onMouseOut","borderWidth","getEmojiAll","icons","createEmojiPlugin","mentionPlugin","tabIndex","MentionComponent","mentionHeadKey","mentionBodyKey","person","mentionType","friendName","contentEditable","suppressContentEditableWarning","inputFriendName","flexGrow","mentionBodyText","getData","hasOnAtTag","isAtOn","tagKey","handleBeforeInput","chars","evenTimeStamp","hasfocus","anchorFocusKey","anchorFocusOffset","contentLenth","contentFocusAt","shortMentionOff","longMentionOnAt","longMentionOnOther","longMentionOff","createTag","tagName","mergeEntityData","substring","taggingMention","Array","isArray","createMentionPlugin","linkPlugin","LinkComponent","linkType","linkAddress","linkHost","href","event","entityType","getStyle","removeInlineStyle","linkOff","taggingLink","createLinkPlugin","panelMappingObj","DraftEditor4","setShowPlugin","createEmpty","stateToHTML","setPreHtml","editor","readOnly","setReadOnly","width_","minWidth_","maxWidth_","panelName","panelArr","setPanelArr","stateToPreHtml","es","preHtml_","defaultBlockTag","blockStyleFn","attributes","blockRenderers","imageBlock","toObject","inlineStyles","entityStyleFn","entity","mutablity","host","address","background_image","margin","Compo","dropItem","typeName","newContentState","inserBotomBlock","borderStyle","borderTopWidth","borderBottomWidth","minHeight","whiteSpace","focus","customStyleFn","blockRenderMap","Map","blockRendererFn","editable","blockContent","plugins","newState","RichUtils","stripPastedStyles","handlePastedText","html","wordBreak","persist","CommentEditor","articleId","setCommentObj","paddingLeft","paddingRight","commentNum","SubCommentEditor","commentId","setSubCommentObj","Content","commentObj","subCommentObj","renderHtml","contentToRent","ReactHtmlParser","transform","node","attribs","cursor","innerHTML","preventDefault","substr","paddingTop","paddingBottom","formatDistanceToNow","postingTime","locale","zhCN","comment","subCommentNum","subcommentsArr","subcomment","Div0","BackPicture","App","Boolean","hostname","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister","error","message"],"mappings":"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","file":"static/js/main.e19b993b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.23a61dbb.svg\";","module.exports = __webpack_public_path__ + \"static/media/clippath.4d716ddf.svg\";","import axios from \"axios\";\r\n\r\n\r\n\r\naxios.interceptors.request.use(\r\n  function fn1(request) {\r\n  \r\n    return request\r\n  }\r\n \r\n) \r\n\r\n\r\naxios.interceptors.response.use(\r\n\r\n  function fn1(response) {\r\n  \r\n    return response\r\n  }\r\n \r\n)\r\n\r\n\r\n\r\n\r\nif (getToken()) { axios.defaults.headers.common['x-auth-token'] = getToken() }\r\n\r\n\r\nfunction getToken() {\r\n\r\n  return localStorage.getItem(\"token\")\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst api = axios;\r\nasync function exec() {\r\n\r\n  // First request will be served from network\r\n  const response = await api.get('http://192.168.0.100/api/picture/downloadpicture/5fd0526dff03da27a48ce6d1',\r\n    { responseType: 'arraybuffer', })\r\n\r\n  // `response.request` will contain the origin `axios` request object\r\n\r\n\r\n  alert(response.request.fromCache)\r\n\r\n  // Second request to same endpoint will be served from cache\r\n  let anotherResponse = await api.get('http://192.168.0.100/api/picture/downloadpicture/5fd0526dff03da27a48ce6d1',\r\n    { responseType: 'arraybuffer', })\r\n\r\n  // `response.request` will contain `fromCache` boolean\r\n  alert(anotherResponse.request.fromCache)\r\n\r\n\r\n  anotherResponse = await api.get('http://192.168.0.100/api/picture/downloadpicture/5fd0526dff03da27a48ce6d1',\r\n    { responseType: 'arraybuffer', })\r\n\r\n  // `response.request` will contain `fromCache` boolean\r\n  alert(anotherResponse.request.fromCache)\r\n}\r\n//  exec()\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default axios;","\r\n\r\n\r\n\r\nlet url=\"\"\r\n\r\nif(process.env.NODE_ENV === \"development\"){\r\n\r\n   // url=\"http://localhost/api\"\r\n    url=\"http://192.168.0.103/api\"\r\n}\r\nelse{\r\n    url=\"/api\"\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default url;","\r\nimport React, { createContext, useContext, useEffect, useState, useReducer, useRef, useMemo, useCallback, useLayoutEffect } from 'react';\r\nimport styled, { ThemeProvider, css } from \"styled-components\";\r\nimport url from \"../config\";\r\n\r\nimport jwtDecode from 'jwt-decode';\r\n\r\n\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\nimport { UserContext } from './UserContextProvider';\r\nexport const ThemeContext = createContext();\r\n\r\n\r\nconst useFontSize = (valuePC, valuePhone) => {\r\n\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n    const [fontSizePC, setFontSizePC] = useState(valuePC);\r\n    const [fontSizePhone, setFontSizePhone] = useState(valuePhone);\r\n\r\n    function setFontSize(value) {\r\n        isComputer\r\n            ? setFontSizePC((pre) => Math.max((pre + value).toFixed(1), 0.1))\r\n            : setFontSizePhone((pre) => Math.max((pre + value).toFixed(1), 0.1))\r\n    }\r\n\r\n    function setBothFontSize(pc, phone) {\r\n        setFontSizePC(pc);\r\n        setFontSizePhone(phone);\r\n    }\r\n\r\n    return [fontSizePC, fontSizePhone, setFontSize, setBothFontSize]\r\n}\r\n\r\n\r\nconst ThemeContextProvider = (props) => {\r\n\r\n    // const count = useRef(0);\r\n    // useEffect(function () {\r\n    //     console.log(\"painting ThemeContext --- \", count.current)\r\n    //     return function () { count.current++; }\r\n    // })\r\n\r\n    const { userName ,axios } = useContext(UserContext)\r\n    const [themeData, setThemeData] = useState(null);\r\n\r\n\r\n\r\n    useEffect(function () {\r\n        if (themeData) {\r\n\r\n            setColor1(themeData.color1);\r\n            setColor2(themeData.color2);\r\n            setColor3(themeData.color3);\r\n            setColor4(themeData.color4);\r\n            setColor5(themeData.color5);\r\n\r\n\r\n            setBothFontSize1(themeData.fontSizePC1, themeData.fontSizePhone1);\r\n            setBothFontSize2(themeData.fontSizePC2, themeData.fontSizePhone2);\r\n            setBothFontSize3(themeData.fontSizePC3, themeData.fontSizePhone3);\r\n            setBothFontSize4(themeData.fontSizePC4, themeData.fontSizePhone4);\r\n            setBothFontSize5(themeData.fontSizePC5, themeData.fontSizePhone5);\r\n\r\n\r\n            setLogoImageSizePC(themeData.logoImageSizePC);\r\n            setLogoImageSizePhone(themeData.logoImageSizePhone);\r\n\r\n            setLogoTextSizePC(themeData.logoTextSizePC);\r\n            setLogoTextSizePhone(themeData.logoTextSizePhone);\r\n\r\n            setAvatarSizePC(themeData.avatarSizePC);\r\n            setAvatarSizePhone(themeData.avatarSizePhone);\r\n\r\n            setBackPicOrianPC(themeData.backPicOrianPC);\r\n            setBackPicOrianPhone(themeData.backPicOrianPhone);\r\n            setBackPicOpacity(themeData.backPicOpacity);\r\n\r\n            setEditorWidthPC(themeData.editorWidthPC);\r\n            setEditorWidthPhone(themeData.editorWidthPhone);\r\n        }\r\n\r\n    }, [themeData])\r\n\r\n\r\n\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n\r\n\r\n    const [color1, setColor1] = useState(\"rgb(62,39,35,0.8)\");    //Navbar-logo-textColor\r\n    const [color2, setColor2] = useState(\"rgb(255,224,130,0.8)\");  //Navbar-bar-backgourndColor  pic-uploader-pannel\r\n    const [color3, setColor3] = useState(\"rgb(162,39,135,0.3)\");      //LoginForm LogoutForm  RegisterForm App-content AvatarSetter\r\n    const [color4, setColor4] = useState(\"rgb(255,224,130,0.5)\");\r\n    const [color5, setColor5] = useState(\"rgb(62,39,35,0.5)\");\r\n\r\n\r\n    const [fontSizePC1, fontSizePhone1, setFontSize1, setBothFontSize1] = useFontSize(2, 1.5); //Navbar-button , ThemeSetter-button, self-avatar,FontSizeSetter-button\r\n    const [fontSizePC2, fontSizePhone2, setFontSize2, setBothFontSize2] = useFontSize(2, 1.5); //content-editor-text content-text avatar-with-perpleName\r\n\r\n\r\n    const [fontSizePC3, fontSizePhone3, setFontSize3, setBothFontSize3] = useFontSize(2, 2);\r\n    const [fontSizePC4, fontSizePhone4, setFontSize4, setBothFontSize4] = useFontSize(2, 2);\r\n    const [fontSizePC5, fontSizePhone5, setFontSize5, setBothFontSize5] = useFontSize(2, 2);\r\n\r\n\r\n    const [logoImageSizePC, setLogoImageSizePC] = useState(48);\r\n    const [logoImageSizePhone, setLogoImageSizePhone] = useState(48);\r\n    const [logoTextSizePC, setLogoTextSizePC] = useState(1.5);\r\n    const [logoTextSizePhone, setLogoTextSizePhone] = useState(2);\r\n\r\n    const [avatarSizePC, setAvatarSizePC] = useState(70);\r\n    const [avatarSizePhone, setAvatarSizePhone] = useState(50);\r\n\r\n    const [backPicOrianPC, setBackPicOrianPC] = useState(\"horizontal\");\r\n    const [backPicOrianPhone, setBackPicOrianPhone] = useState(\"horizontal\");\r\n    const [backPicOpacity, setBackPicOpacity] = useState(0.5);\r\n\r\n    const [editorWidthPC, setEditorWidthPC] = useState({ width: 80, minWidth: 0, maxWidth: 50000 })\r\n    const [editorWidthPhone, setEditorWidthPhone] = useState({ width: 100, minWidth: 0, maxWidth: 50000 })\r\n\r\n    const [ratioRemAndPx,setRatioRemAndPx] = useState(16)\r\n\r\n\r\n\r\n    const setLogoSize = useCallback(function (value) {\r\n        isComputer\r\n            ? (function () {\r\n                setLogoImageSizePC((pre) => Math.max((pre + 20 * value).toFixed(1), 1))\r\n                setLogoTextSizePC((pre) => Math.max((pre + value).toFixed(1), 0.1))\r\n            }())\r\n            : (function () {\r\n                setLogoImageSizePhone((pre) => Math.max((pre + 20 * value).toFixed(1), 1))\r\n                setLogoTextSizePhone((pre) => Math.max((pre + value).toFixed(1), 0.1))\r\n            }())\r\n\r\n    }, []);\r\n\r\n\r\n    const setAvatarSize = useCallback(function (value) {\r\n        isComputer\r\n            ? setAvatarSizePC((pre) => Math.max((pre + value).toFixed(1), 10))\r\n            : setAvatarSizePhone((pre) => Math.max((pre + value).toFixed(1), 10))\r\n    }, []);\r\n\r\n    const setBackPicOrian = useCallback(function (value) {\r\n        isComputer\r\n            ? setBackPicOrianPC(value)\r\n            : setBackPicOrianPhone(value)\r\n    }, [])\r\n\r\n    const setEditorWidth = useCallback(function (newWidth, newMin, newMax) {\r\n        isComputer\r\n            ? setEditorWidthPC(\r\n                function (pre) {\r\n                    const { width = 0, minWidth = 0, maxWidth = 0 } = pre;\r\n                    return {\r\n                        width: Math.min(Math.max((width + newWidth).toFixed(1), 0), 100),\r\n                        minWidth: Math.max((minWidth + newMin),0),\r\n                        maxWidth: Math.max((maxWidth + newMax),0),\r\n                    }\r\n                })\r\n            : setEditorWidthPhone(\r\n                function (pre) {\r\n                    const { width, minWidth, maxWidth } = pre;\r\n                    return {\r\n                        width: Math.min(Math.max((width + newWidth).toFixed(1), 0), 100),\r\n                        minWidth: Math.max((minWidth + newMin),0),\r\n                        maxWidth: Math.max((maxWidth + newMax),0),\r\n                    }\r\n\r\n                })\r\n\r\n\r\n    }, [])\r\n\r\n\r\n    const theme = useMemo(function () {\r\n\r\n        return {\r\n            color1, color2, color3, color4, color5,\r\n            fontSizePC1, fontSizePC2, fontSizePC3, fontSizePC4, fontSizePC5,\r\n            fontSizePhone1, fontSizePhone2, fontSizePhone3, fontSizePhone4, fontSizePhone5,\r\n            logoImageSizePC, logoImageSizePhone,\r\n            logoTextSizePC, logoTextSizePhone,\r\n            avatarSizePC, avatarSizePhone,\r\n            backPicOrianPC, backPicOrianPhone,\r\n            backPicOpacity,\r\n            editorWidthPC, editorWidthPhone,\r\n\r\n            fontSize1: isComputer ? fontSizePC1 + \"rem\" : fontSizePhone1 + \"rem\",\r\n            fontSize2: isComputer ? fontSizePC2 + \"rem\" : fontSizePhone2 + \"rem\",\r\n            fontSize3: isComputer ? fontSizePC3 + \"rem\" : fontSizePhone3 + \"rem\",\r\n            fontSize4: isComputer ? fontSizePC4 + \"rem\" : fontSizePhone4 + \"rem\",\r\n            fontSize5: isComputer ? fontSizePC5 + \"rem\" : fontSizePhone5 + \"rem\",\r\n\r\n            logoImageSize: isComputer ? logoImageSizePC + \"px\" : logoImageSizePhone + \"px\",\r\n            logoTextSize: isComputer ? logoTextSizePC + \"em\" : logoTextSizePhone + \"em\",\r\n\r\n            avatarSize: isComputer ? avatarSizePC + \"px\" : avatarSizePhone + \"px\",\r\n\r\n            backPicOrian: isComputer ? backPicOrianPC : backPicOrianPhone,\r\n\r\n            editorWidth: isComputer ? editorWidthPC.width + \"%\" : editorWidthPhone.width + \"%\",\r\n            editorMinWidth: isComputer ? editorWidthPC.minWidth + \"px\" : editorWidthPhone.minWidth + \"px\",\r\n            editorMaxWidth: isComputer ? editorWidthPC.maxWidth + \"px\" : editorWidthPhone.maxWidth + \"px\",\r\n\r\n            ratioRemAndPx,setRatioRemAndPx,\r\n        }\r\n    }, [color1, color2, color3, color4, color5,\r\n        fontSizePC1, fontSizePC2, fontSizePC3, fontSizePC4, fontSizePC5,\r\n        fontSizePhone1, fontSizePhone2, fontSizePhone3, fontSizePhone4, fontSizePhone5,\r\n        logoImageSizePC, logoImageSizePhone,\r\n        logoTextSizePC, logoTextSizePhone,\r\n        avatarSizePC, avatarSizePhone,\r\n        backPicOrianPC, backPicOrianPhone,\r\n        backPicOpacity,\r\n        editorWidthPC, editorWidthPhone,\r\n\r\n        ratioRemAndPx,setRatioRemAndPx,\r\n    ]);\r\n\r\n\r\n\r\n\r\n\r\n    const uploadTheme = useCallback(function () {\r\n\r\n        userName && axios.post(`${url}/theme`, { theme })\r\n            .then((response) => { console.log(response.data) })\r\n            .catch((err) => { console.log(err.response) })\r\n\r\n    }, [theme])\r\n\r\n\r\n    const downloadTheme = useCallback(function () {\r\n        userName && axios.get(`${url}/theme`)\r\n            .then(({ data }) => {\r\n\r\n            \r\n                data && setThemeData(data.theme)\r\n\r\n                // console.log(data)\r\n            })\r\n            .catch(err => {\r\n                console.log(err.response)\r\n            })\r\n    }, [useState]);\r\n\r\n    useMemo(downloadTheme, [userName]);\r\n\r\n\r\n\r\n\r\n\r\n\r\n    const [showThemeSetter, setShowThemeSetter] = useState(false);\r\n    const [showLogin, setShowLogin] = useState(false);\r\n    const [showRegister, setShowRegister] = useState(false);\r\n    const [showLogout, setShowLogout] = useState(false);\r\n\r\n\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{\r\n\r\n            color1, color2, color3, color4, color5,\r\n            setColor1, setColor2, setColor3, setColor4, setColor5,\r\n\r\n            fontSize1: isComputer ? fontSizePC1 : fontSizePhone1, setFontSize1,\r\n            fontSize2: isComputer ? fontSizePC2 : fontSizePhone2, setFontSize2,\r\n            fontSize3: isComputer ? fontSizePC3 : fontSizePhone3, setFontSize3,\r\n            fontSize4: isComputer ? fontSizePC4 : fontSizePhone4, setFontSize4,\r\n            fontSize5: isComputer ? fontSizePC5 : fontSizePhone5, setFontSize5,\r\n\r\n            logoImageSize: isComputer ? logoImageSizePC : logoImageSizePhone,\r\n            logoTextSize: isComputer ? logoTextSizePC : logoTextSizePhone,\r\n            setLogoSize,\r\n\r\n            avatarSize: isComputer ? avatarSizePC : avatarSizePhone,\r\n            setAvatarSize,\r\n\r\n            backPicOrian: isComputer ? backPicOrianPC : backPicOrianPhone,\r\n            setBackPicOrian,\r\n\r\n            backPicOpacity,\r\n            setBackPicOpacity,\r\n\r\n            editorWidth: isComputer ? editorWidthPC : editorWidthPhone,\r\n            setEditorWidth,\r\n\r\n            showThemeSetter, setShowThemeSetter,\r\n            showLogin, setShowLogin,\r\n            showRegister, setShowRegister,\r\n            showLogout, setShowLogout,\r\n\r\n            uploadTheme,\r\n            theme,\r\n\r\n            ratioRemAndPx,setRatioRemAndPx,\r\n\r\n        }}>\r\n            <ThemeProvider theme={theme}>\r\n                {props.children}\r\n            </ThemeProvider>\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport default ThemeContextProvider;","import React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport ThemeSetter from './ThemeSetter';\r\n\r\nimport logo from './Images/logo.svg';\r\n\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n// import { ThemeContext } from 'styled-components';\r\n\r\n\r\n\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\n\r\nconst Div = styled.div`\r\n    z-index:10;\r\n    display: flex;\r\n    background-color: rgb(25,25,25,0.2);\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    left: 0; \r\n    top: 0;\r\n`\r\n\r\nconst DivSub = styled.div`\r\n    display: flex;\r\n    position:relative;\r\n    flex-direction:column;\r\n    width: ${function ({ isComputer }) { return isComputer ? \"50%\" : \"80%\" }};\r\n    height:${function ({ isComputer }) { return isComputer ? \"70%\" : \"90%\" }};\r\n    background-color: ${function ({ theme }) { return theme.color3 }};\r\n    /* justify-content: center; */\r\n    align-items: center;\r\n    font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n    box-shadow: 0px 0px 2px #5f5f5f,\r\n                /* offset */\r\n                0px 0px 0px 5px #ecf0f3,\r\n                /*bottom right */\r\n                8px 8px 15px #a7aaaf,\r\n                /* top left */\r\n                -8px -8px 15px #ffffff;\r\n\r\n             \r\n    \r\n    & > div:nth-child(1){     \r\n        align-self:flex-end;\r\n    }\r\n\r\n    & > div >input , label,  button:nth-child(1) {\r\n        font-size: ${function ({ theme }) { return theme.fontSize1 }};\r\n    }\r\n    & > div >input  {\r\n        width: ${function ({ isComputer }) { return isComputer ? \"auto\" : \"100%\" }};\r\n    }\r\n                \r\n`\r\n\r\n\r\nconst RegisterForm = () => {\r\n\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n    const {\r\n   \r\n\r\n        register,\r\n    } = useContext(UserContext)\r\n\r\n\r\n    const {\r\n\r\n        showRegister, setShowRegister, theme,\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n    const [userName, setuserName] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n\r\n    return (\r\n        showRegister &&\r\n        <Div>\r\n\r\n            <DivSub isComputer={isComputer}>\r\n\r\n\r\n                <div>\r\n                    <button\r\n                        onClick={function (e) {\r\n                            setShowRegister(false)\r\n\r\n                        }}\r\n                    >close</button>\r\n                </div>\r\n\r\n                <div>\r\n                    <label htmlFor=\"login\">login</label>\r\n                    <br />\r\n                    <input id=\"login\" type=\"text\" value={userName} placeholder=\" \"\r\n                        onChange={function (e) {\r\n                            setuserName(e.currentTarget.value)\r\n                        }}\r\n\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label htmlFor=\"password\">password</label>\r\n                    <br />\r\n                    <input id=\"password\" type=\"password\" value={password} placeholder=\" \"\r\n                        onChange={function (e) {\r\n                            setPassword(e.currentTarget.value)\r\n                        }}\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label htmlFor=\"password\">password again</label>\r\n                    <br />\r\n                    <input id=\"password\" type=\"password\" placeholder=\" \" />\r\n                </div>\r\n\r\n                <div>\r\n                    <button style={{ marginTop: \"10px\" }}\r\n\r\n                        onClick={function () {\r\n                            register(userName, password, theme);\r\n                        }}\r\n\r\n                    >Submit</button>\r\n                </div>\r\n\r\n            </DivSub>\r\n        </Div>\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default RegisterForm;","import React, { createContext, useEffect, useState, useReducer, useRef, useMemo, useCallback, useLayoutEffect } from 'react';\r\nimport styled, { ThemeProvider, css } from \"styled-components\";\r\nimport axios from './axios';\r\nimport url from \"../config\";\r\n\r\nimport jwtDecode from 'jwt-decode';\r\n\r\n\r\nimport {\r\n    isMobile,\r\n    isFirefox,\r\n    isChrome,\r\n    browserName,\r\n    engineName,\r\n} from \"react-device-detect\";\r\n\r\n\r\nimport RegisterForm from '../RegisterForm';\r\nimport { connect } from 'mongoose';\r\n\r\nexport const UserContext = createContext();\r\n\r\n\r\n\r\nconst UserContextProvider = (props) => {\r\n\r\n\r\n\r\n    const [userName, setUserName] = useState(\r\n        localStorage.getItem(\"token\")\r\n            ? jwtDecode(localStorage.getItem(\"token\")).userName\r\n            : \"\"\r\n    );\r\n\r\n    const [friendsList, setFriendsList] = useState(userName?[userName]:[])\r\n    function uploadFriendsList(friendsArr) {\r\n        if (!userName) { console.log(\"Please login first\"); alert(\"please login first\"); return null }\r\n\r\n        axios.post(`${url}/user/updatefriendslist`, friendsArr).then((response) => {\r\n            console.log(response.data)\r\n\r\n            console.log(contentList)\r\n\r\n            console.log(friendsArr)\r\n            setContentList(pre=>{\r\n                const arr = pre.filter(function(content){\r\n                    return friendsArr.includes(content.ownerName)\r\n                })\r\n                return arr\r\n            })\r\n\r\n\r\n        }).catch(err => { console.log(err) })\r\n    }\r\n\r\n    useMemo(downloadFriendsList, [userName])\r\n    function downloadFriendsList() {\r\n        if (!userName) { return null }\r\n        axios.get(`${url}/user/getfriendslist`).then((response) => {\r\n\r\n            setFriendsList([... new Set([...response.data,userName])])\r\n\r\n\r\n        }).catch(err => { console.log(err) })\r\n\r\n    }\r\n\r\n\r\n   \r\n    const [contentList, setContentList] = useState([])\r\n    function uploadContentList(preHtml) {\r\n\r\n        return userName && axios.post(`${url}/article`, {\r\n            ownerName: userName,\r\n            content: preHtml,\r\n        }).then((response) => {\r\n\r\n            setContentList(pre => {\r\n\r\n                return [response.data, ...pre,]\r\n            })\r\n            return response\r\n        })\r\n\r\n    }\r\n    \r\n    useMemo(downloadContentList, [userName])\r\n    function downloadContentList() {\r\n\r\n        if (!userName) {\r\n            return axios.get(`${url}/article/all2`).then((response) => {\r\n\r\n                setContentList(pre => {\r\n\r\n                    const arr = [...response.data].sort(function (item1, item2) {\r\n\r\n                        if (item1._id > item2._id) { return -1 }\r\n                        else if (item1._id < item2._id) { return 1 }\r\n                        else { return 0 }\r\n                    })\r\n\r\n                    return arr\r\n                })\r\n                return response\r\n            })\r\n        }\r\n        else {\r\n\r\n            return axios.post(`${url}/article/all`, contentList.map(function (content) {\r\n                return content._id\r\n            })).then((response) => {\r\n\r\n           //     console.log(response.data)\r\n\r\n                setContentList(pre => {\r\n                    if (response.data.length === 0) {\r\n                        \r\n                    (friendsList.length>1)&&alert(\"\");\r\n                    \r\n                    return pre }\r\n\r\n                    const arr = [...pre, ...response.data].sort(function (item1, item2) {\r\n\r\n                        if (item1._id > item2._id) { return -1 }\r\n                        else if (item1._id < item2._id) { return 1 }\r\n                        else { return 0 }\r\n                    })\r\n\r\n                    console.log(arr)\r\n                    return arr\r\n                })\r\n                return response\r\n            })\r\n\r\n\r\n\r\n\r\n            return axios.get(`${url}/article/all`).then((response) => {\r\n\r\n                setContentList(pre => {\r\n\r\n                    const arr = [...pre, ...response.data].sort(function (item1, item2) {\r\n\r\n                        if (item1._id > item2._id) { return -1 }\r\n                        else if (item1._id < item2._id) { return 1 }\r\n                        else { return 0 }\r\n                    })\r\n\r\n                    console.log(arr)\r\n                    return arr\r\n                })\r\n                return response\r\n            })\r\n\r\n        }\r\n    }\r\n\r\n\r\n    function deleteContentList(id) {\r\n        return userName && axios.get(`${url}/article/delete/${id}`).then(function (response) {\r\n            setContentList((pre) => {\r\n                return pre.filter(poster => { return poster._id !== id })\r\n\r\n            })\r\n            return response\r\n        })\r\n\r\n    }\r\n\r\n    const [contentNum, setContentNum] = useState(0)\r\n    function countContentNum() {\r\n        userName && axios.get(`${url}/article/count`).then(response => {\r\n\r\n            setContentNum(Number(response.data))\r\n        })\r\n\r\n\r\n    }\r\n    useMemo(countContentNum, [userName, friendsList,contentList])\r\n\r\n\r\n\r\n    const [userBackPicture, setUserBackPicture] = useState();\r\n    function uploadBackPicture(pic) {\r\n        if (!userName) { console.log(\"Please login first\"); alert(\"please login first\"); return null }\r\n\r\n        const data = new FormData();\r\n        data.append('file', pic);\r\n\r\n        data.append('obj',\r\n            JSON.stringify({\r\n                filename: pic.name.trim(),\r\n                ownerName: userName,\r\n                uploadTime: Date.now(),\r\n\r\n            })\r\n        );\r\n\r\n        return axios.post(`${url}/backpicture/uploadbackpicture`, data, {\r\n            headers: { 'content-type': 'multipart/form-data' },\r\n\r\n\r\n            //   responseType: 'arraybuffer',\r\n            onUploadProgress: progressEvent => {\r\n                let percentCompleted = Math.floor((progressEvent.loaded * 100) / progressEvent.total);\r\n                console.log(\"Uploading backPicture --- \" + percentCompleted);\r\n\r\n                //percentCompleted === 100 &&   alert(\"upload backPicture done\")\r\n                //  setProgress(percentCompleted+\"%\");\r\n                //  percentCompleted === 100\r\n                //     ? setPercentage(\"Finished\")\r\n                //    : setPercentage(percentCompleted + \"%\")\r\n            },\r\n        }).then((response) => {\r\n\r\n            // downloadBackPicture()\r\n\r\n        })\r\n    }\r\n    useMemo(downloadBackPicture, [userName])\r\n    function downloadBackPicture() {\r\n        //   console.log(\"start downloading back pic\")\r\n        //   if (!userName) { return null }\r\n        axios.get(userName ? `${url}/backpicture/downloadbackpicture/${userName}` : isMobile ? \"https://picsum.photos/500/800\" : \"https://picsum.photos/1000/800\",\r\n            {\r\n\r\n                responseType: 'arraybuffer',\r\n                onDownloadProgress: function (progressEvent) {\r\n                    //     console.log(\"Downloading backPicture --- \" + (progressEvent.loaded * 100 / progressEvent.total).toFixed(2))\r\n                }\r\n            }\r\n\r\n\r\n        ).then((response) => {\r\n\r\n\r\n            const base64 = btoa(\r\n                new Uint8Array(response.data).reduce(\r\n                    (data, byte) => data + String.fromCharCode(byte),\r\n                    '',\r\n                ),\r\n            );\r\n\r\n\r\n            setUserBackPicture(\"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64)\r\n        })\r\n            .catch(err => { console.log(err.response) })\r\n\r\n\r\n    }\r\n\r\n\r\n    const [userAvatar, setUserAvatar] = useState();\r\n    function uploadAvatar(pic) {\r\n\r\n        if (!userName) { console.log(\"Please login first\"); alert(\"please login first\"); return null }\r\n\r\n        const data = new FormData();\r\n        data.append('file', pic);\r\n\r\n        data.append('obj',\r\n            JSON.stringify({\r\n                filename: pic.name.trim(),\r\n                ownerName: userName,\r\n                uploadTime: Date.now(),\r\n\r\n            })\r\n        );\r\n\r\n\r\n        axios.post(`${url}/avatar/uploadavatar`, data, {\r\n            headers: { 'content-type': 'multipart/form-data' },\r\n\r\n\r\n            responseType: 'arraybuffer',\r\n            onUploadProgress: progressEvent => {\r\n                let percentCompleted = Math.floor((progressEvent.loaded * 100) / progressEvent.total);\r\n                console.log(percentCompleted);\r\n                //  setProgress(percentCompleted+\"%\");\r\n                //  percentCompleted === 100\r\n                //     ? setPercentage(\"Finished\")\r\n                //    : setPercentage(percentCompleted + \"%\")\r\n            },\r\n        }).then((response) => {\r\n\r\n\r\n            downloadAvatar()\r\n\r\n        })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n    useMemo(downloadAvatar, [userName])\r\n    function downloadAvatar() {\r\n\r\n        if (!userName) { return null }\r\n        axios.get(`${url}/avatar/downloadavatar/${userName}`,\r\n            {\r\n\r\n                responseType: 'arraybuffer',\r\n                onDownloadProgress: function (progressEvent) {\r\n                    //  console.log((progressEvent.loaded * 100 / progressEvent.total).toFixed(2))\r\n                }\r\n            }\r\n\r\n\r\n        )\r\n            .then((response) => {\r\n\r\n\r\n                const base64 = btoa(\r\n                    new Uint8Array(response.data).reduce(\r\n                        (data, byte) => data + String.fromCharCode(byte),\r\n                        '',\r\n                    ),\r\n                );\r\n\r\n                setUserAvatar(\"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64)\r\n            })\r\n            .catch(err => { console.log(err.response) })\r\n\r\n    }\r\n\r\n\r\n    const [picDataList, setPicDataList] = useState({})\r\n\r\n\r\n\r\n\r\n    function login(userName, password) {\r\n        axios.post(`${url}/user/login`, {\r\n            userName,\r\n            password\r\n\r\n        }).then(response => {\r\n            console.log(response.data)\r\n\r\n            localStorage.setItem(\"token\", response.headers[\"x-auth-token\"])\r\n            window.location.assign(\"/\")\r\n            console.log(jwtDecode(localStorage.getItem(\"token\")));\r\n        }).catch(err => {\r\n            alert(err.response)\r\n            console.log(err.response)\r\n        })\r\n    }\r\n\r\n    function register(userName, password, theme) {\r\n        axios.post(`${url}/user/register`, {\r\n            userName,\r\n            password,\r\n            theme,\r\n\r\n        }).then(response => {\r\n            console.log(response.data)\r\n\r\n            localStorage.setItem(\"token\", response.headers[\"x-auth-token\"])\r\n            console.log(jwtDecode(localStorage.getItem(\"token\")));\r\n\r\n            window.location.assign(\"/\")\r\n        }).catch(err => {\r\n            alert(err.response)\r\n            console.log(err.response)\r\n        })\r\n    }\r\n\r\n    function logout() {\r\n        localStorage.removeItem(\"token\")\r\n        window.location.assign(\"/\")\r\n    }\r\n\r\n\r\n    return (\r\n\r\n        <UserContext.Provider value={{\r\n            userName, setUserName,\r\n            userBackPicture, setUserBackPicture, uploadBackPicture,\r\n            userAvatar, setUserAvatar, uploadAvatar,\r\n            login, register, logout, axios,\r\n            picDataList, setPicDataList,\r\n            friendsList, setFriendsList, uploadFriendsList,\r\n            contentList, setContentList, downloadContentList, uploadContentList, deleteContentList,\r\n            countContentNum, contentNum, setContentNum,\r\n\r\n        }}>\r\n            {props.children}\r\n        </UserContext.Provider>\r\n\r\n    );\r\n}\r\n\r\nexport default UserContextProvider;\r\n\r\n","import React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\n\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\n\r\n\r\n\r\nconst colorArr = [\r\n    [\"rgb(183,28,28)\", \"rgb(198,40,40)\", \"rgb(211,47,47)\", \"rgb(229,57,53)\", \"rgb(244,67,54)\", \"rgb(239,83,80)\", \"rgb(229,115,115)\", \"rgb(239,154,154)\", \"rgb(255,205,210)\", \"rgb(255,235,238)\"],\r\n    [\"rgb(136,14,79)\", \"rgb(173,20,87)\", \"rgb(194,24,91)\", \"rgb(216,27,96)\", \"rgb(233,30,99)\", \"rgb(236,64,122)\", \"rgb(240,98,146)\", \"rgb(244,143,177)\", \"rgb(248,187,208)\", \"rgb(252,228,236)\"],\r\n    [\"rgb(74,20,140)\", \"rgb(106,27,154)\", \"rgb(123,31,162)\", \"rgb(142,36,170)\", \"rgb(156,39,176)\", \"rgb(171,71,188)\", \"rgb(186,104,200)\", \"rgb(206,147,216)\", \"rgb(225,190,231)\", \"rgb(243,229,245)\"],\r\n    [\"rgb(49,27,146)\", \"rgb(69,39,160)\", \"rgb(81,45,168)\", \"rgb(94,53,177)\", \"rgb(103,58,183)\", \"rgb(126,87,194)\", \"rgb(149,117,205)\", \"rgb(179,157,219)\", \"rgb(209,196,233)\", \"rgb(237,231,246)\"],\r\n    [\"rgb(26,35,126)\", \"rgb(40,53,147)\", \"rgb(48,63,159)\", \"rgb(57,73,171)\", \"rgb(63,81,181)\", \"rgb(92,107,192)\", \"rgb(121,134,203)\", \"rgb(159,168,218)\", \"rgb(197,202,233)\", \"rgb(232,234,246)\"],\r\n    [\"rgb(13,71,161)\", \"rgb(21,101,192)\", \"rgb(25,118,210)\", \"rgb(30,136,229)\", \"rgb(33,150,243)\", \"rgb(66,165,245)\", \"rgb(100,181,246)\", \"rgb(144,202,249)\", \"rgb(187,222,251)\", \"rgb(227,242,253)\"],\r\n    [\"rgb(1,87,155)\", \"rgb(2,119,189)\", \"rgb(2,136,209)\", \"rgb(3,155,229)\", \"rgb(3,169,244)\", \"rgb(41,182,246)\", \"rgb(79,195,247)\", \"rgb(129,212,250)\", \"rgb(179,229,252)\", \"rgb(225,245,254)\"],\r\n    [\"rgb(0,96,100)\", \"rgb(0,131,143)\", \"rgb(0,151,167)\", \"rgb(0,172,193)\", \"rgb(0,188,212)\", \"rgb(38,198,218)\", \"rgb(77,208,225)\", \"rgb(128,222,234)\", \"rgb(178,235,242)\", \"rgb(224,247,250)\"],\r\n    [\"rgb(0,77,64)\", \"rgb(0,105,92)\", \"rgb(0,121,107)\", \"rgb(0,137,123)\", \"rgb(0,150,136)\", \"rgb(38,166,154)\", \"rgb(77,182,172)\", \"rgb(128,203,196)\", \"rgb(178,223,219)\", \"rgb(224,242,241)\"],\r\n    [\"rgb(27,94,32)\", \"rgb(46,125,50)\", \"rgb(56,142,60)\", \"rgb(67,160,71)\", \"rgb(76,175,80)\", \"rgb(102,187,106)\", \"rgb(129,199,132)\", \"rgb(165,214,167)\", \"rgb(200,230,201)\", \"rgb(232,245,233)\"],\r\n    [\"rgb(51,105,30)\", \"rgb(85,139,47)\", \"rgb(104,159,56)\", \"rgb(124,179,66)\", \"rgb(139,195,74)\", \"rgb(156,204,101)\", \"rgb(174,213,129)\", \"rgb(197,225,165)\", \"rgb(220,237,200)\", \"rgb(241,248,233)\"],\r\n    [\"rgb(130,119,23)\", \"rgb(158,157,36)\", \"rgb(175,180,43)\", \"rgb(192,202,51)\", \"rgb(205,220,57)\", \"rgb(212,225,87)\", \"rgb(220,231,117)\", \"rgb(230,238,156)\", \"rgb(240,244,195)\", \"rgb(249,251,231)\"],\r\n    [\"rgb(245,127,23)\", \"rgb(249,168,37)\", \"rgb(251,192,45)\", \"rgb(253,216,53)\", \"rgb(255,235,59)\", \"rgb(255,238,88)\", \"rgb(255,241,118)\", \"rgb(255,245,157)\", \"rgb(255,249,196)\", \"rgb(255,253,231)\"],\r\n    [\"rgb(255,111,0)\", \"rgb(255,143,0)\", \"rgb(255,160,0)\", \"rgb(255,179,0)\", \"rgb(255,193,7)\", \"rgb(255,202,40)\", \"rgb(255,213,79)\", \"rgb(255,224,130)\", \"rgb(255,236,179)\", \"rgb(255,248,225)\"],\r\n    [\"rgb(230,81,0)\", \"rgb(239,108,0)\", \"rgb(245,124,0)\", \"rgb(251,140,0)\", \"rgb(255,152,0)\", \"rgb(255,167,38)\", \"rgb(255,183,77)\", \"rgb(255,204,128)\", \"rgb(255,224,178)\", \"rgb(255,243,224)\"],\r\n    [\"rgb(191,54,12)\", \"rgb(216,67,21)\", \"rgb(230,74,25)\", \"rgb(244,81,30)\", \"rgb(255,87,34)\", \"rgb(255,112,67)\", \"rgb(255,138,101)\", \"rgb(255,171,145)\", \"rgb(255,204,188)\", \"rgb(251,233,231)\"],\r\n    [\"rgb(62,39,35)\", \"rgb(78,52,46)\", \"rgb(93,64,55)\", \"rgb(109,76,65)\", \"rgb(121,85,72)\", \"rgb(141,110,99)\", \"rgb(161,136,127)\", \"rgb(188,170,164)\", \"rgb(215,204,200)\", \"rgb(239,235,233)\"],\r\n    [\"rgb(33,33,33)\", \"rgb(66,66,66)\", \"rgb(97,97,97)\", \"rgb(117,117,117)\", \"rgb(158,158,158)\", \"rgb(189,189,189)\", \"rgb(224,224,224)\", \"rgb(238,238,238)\", \"rgb(245,245,245)\", \"rgb(250,250,250)\"],\r\n    [\"rgb(38,50,56)\", \"rgb(55,71,79)\", \"rgb(69,90,100)\", \"rgb(84,110,122)\", \"rgb(96,125,139)\", \"rgb(120,144,156)\", \"rgb(144,164,174)\", \"rgb(176,190,197)\", \"rgb(207,216,220)\", \"rgb(236,239,241)\"],\r\n]\r\n\r\nconst SVG = ({ opacity }) => {\r\n    return (\r\n        <svg style={{ opacity: opacity }} width=\"100%\" height=\"100%\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\r\n            <rect x=\"0\" y=\"0\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"25%\" y=\"0\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"50%\" y=\"0\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"75%\" y=\"0\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n\r\n            <rect x=\"0\" y=\"25%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"25%\" y=\"25%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"50%\" y=\"25%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"75%\" y=\"25%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n\r\n            <rect x=\"0\" y=\"50%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"25%\" y=\"50%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"50%\" y=\"50%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"75%\" y=\"50%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n\r\n            <rect x=\"0\" y=\"75%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"25%\" y=\"75%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n            <rect x=\"50%\" y=\"75%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"#eee\" strokeWidth=\"1\" />\r\n            <rect x=\"75%\" y=\"75%\" width=\"25%\" height=\"25%\" stroke=\"none\" fill=\"gray\" strokeWidth=\"1\" />\r\n\r\n        </svg>\r\n    )\r\n}\r\n\r\nconst ColorBlog = styled.div.attrs(function (props) {\r\n    return {\r\n        style: {\r\n            backgroundColor: props.color,\r\n            clipPath: props.match ? \"circle(40%)\" : \"\",\r\n        }\r\n    }\r\n\r\n})`\r\n   width: 40px;\r\n   height:40px;\r\n   margin:1px;\r\n`\r\n\r\nconst Pannel = styled.div`\r\n   \r\n    /* background-color:red; */\r\n    display: flex;\r\n    justify-content: center;\r\n    /* align-items:center; */\r\n    \r\n    /* align-items: ${function(){ return  !useMediaQuery({ query: '(hover: none)' })?\"flex-start\":\"flex-start\"   }}; */\r\n    \r\n    width: auto;\r\n    height:100%;\r\n    overflow:visible;\r\n    flex-direction:column;\r\n\r\n\r\n    & > div:nth-child(1){\r\n        display: flex;\r\n        justify-content: center;\r\n        background-color:tan;\r\n    };\r\n    & > div:nth-child(2){\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items:center;\r\n        background-color:transparent;\r\n    };\r\n`\r\nfunction getRGB(str) {\r\n    var match = str.match(/rgba?\\((\\d{1,3}), ?(\\d{1,3}), ?(\\d{1,3})\\)?(?:, ?(\\d(?:\\.\\d?))\\))?/);\r\n    return match ? {\r\n        red: match[1],\r\n        green: match[2],\r\n        blue: match[3],\r\n        alpha: match[4],\r\n    } : {};\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst ColorSetter = ({ color, setColor }) => {\r\n\r\n    const count = useRef(0);\r\n    useEffect(function () {\r\n        console.log(\"painting ColorSetter --- \", count.current)\r\n        return function () { count.current++; }\r\n    });\r\n\r\n\r\n\r\n    const { red, green, blue, alpha } = getRGB(color);\r\n\r\n\r\n    return (\r\n\r\n        <Pannel>\r\n\r\n            <div>\r\n                {colorArr.map(function (arr, indexArr) {\r\n\r\n                    return (\r\n                        <div key={indexArr}>\r\n                            {\r\n                                arr.map(function (colorElement, indexC) {\r\n                                    return (\r\n                                        <ColorBlog\r\n                                            key={indexC}\r\n                                            color={colorElement}\r\n                                            match={colorElement === `rgb(${red},${green},${blue})`}\r\n                                            onClick={function () {\r\n\r\n                                                setColor(\r\n                                                    function () {\r\n                                                        const { red: r, green: g, blue: b } = getRGB(colorElement);\r\n\r\n                                                        return `rgb(${r},${g},${b},${alpha})`\r\n                                                    }\r\n                                                )\r\n                                            }}\r\n\r\n                                        />\r\n                                    )\r\n\r\n                                })\r\n                            }\r\n                        </div>\r\n                    )\r\n                })}\r\n            </div>\r\n\r\n            <div>\r\n                {(function () {\r\n                    const temp = []\r\n                    for (let i = 0; i < 10; i++) {\r\n\r\n                        temp.push(\r\n\r\n                            <ColorBlog\r\n                                key={i}\r\n                                match={alpha === (1.1 - (i + 1) / 10).toFixed(1)}\r\n                                color={`rgb(${red},${green},${blue},1)`}\r\n                                onClick={function (e) {\r\n                                    setColor(\r\n                                        function () {\r\n\r\n                                            return `rgb(${red},${green},${blue},${(1.1 - (i + 1) / 10).toFixed(1)})`\r\n                                        }\r\n                                    )\r\n                                }}\r\n                            >\r\n                                <SVG opacity={((i + 1) / 10 - 0.1).toFixed(1)} />\r\n                            </ColorBlog>\r\n\r\n                        )\r\n                    }\r\n                    return temp.map(function (element) {\r\n                        return element\r\n                    })\r\n\r\n                })()}\r\n            </div>\r\n\r\n\r\n\r\n        </Pannel>\r\n\r\n    );\r\n}\r\n\r\nexport default ColorSetter;","import React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\n\r\n\r\nconst Div = styled.div`\r\n\r\ndisplay:flex;\r\njustify-content:center;\r\nalign-items:center;\r\nbackground-color:${function ({ theme }) { return theme.color3 }};\r\nwidth:100%;\r\nheight:100%;\r\n\r\n& > button{\r\n    font-size:${function({theme}){return theme.fontSize1 }};\r\n}\r\n`\r\n\r\n\r\nconst FontSizeSetter = ({ fontSize,setFontSize }) => {\r\n\r\n\r\n    const count = useRef(0);\r\n    useEffect(function () {\r\n        console.log(\"painting FontSizeSetter --- \", count.current)\r\n        return function () { count.current++; }\r\n    });\r\n\r\n\r\n    return (\r\n\r\n        <Div>\r\n            <button\r\n                 onClick={function(){\r\n                     setFontSize(0.1)\r\n                 }}   \r\n\r\n            >Increase 0.1 to {fontSize}rem</button>\r\n           \r\n            <button\r\n             onClick={function(){\r\n                setFontSize(-0.1)\r\n            }}    \r\n            \r\n            >Decrease 0.1 to {fontSize}rem</button>\r\n        </Div>\r\n\r\n    );\r\n}\r\n\r\nexport default FontSizeSetter;","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport axios from './contexts/axios';\r\n\r\n\r\n\r\nconst Pannel = styled.div`\r\n\r\n    display: flex; \r\n    justify-content: center;\r\n    align-items:center;\r\n    width: 100%;\r\n    height:100%;\r\n    overflow:visible;\r\n    flex-direction:column;\r\n    background-color:${function ({ theme }) { return theme.color3 }};\r\n\r\n\r\n    & > button{\r\n        font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n    }\r\n\r\n\r\n`\r\n\r\n\r\n\r\nconst AvartarSetter = () => {\r\n    const inputRef = useRef()\r\n    const [pic, setPic] = useState()\r\n\r\n    const {\r\n        userName,\r\n        uploadAvatar,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n        setAvatarSize,\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <Pannel>\r\n            {userName && <>\r\n                <input type=\"file\" style={{ marginBottom: \"10px\", width: \"100%\", display: \"none\" }} ref={inputRef}\r\n\r\n                    onClick={function (e) {\r\n                        e.currentTarget.value = null;\r\n                    }}\r\n\r\n                    onChange={function (e) {\r\n                        // alert((e.currentTarget.files[0].name).trim());\r\n                        e.currentTarget.files[0].name.trim().match(/\\.(gif|jpe?g|tiff|png|webp|bmp)$/i)\r\n                            ? setPic(e.currentTarget.files[0])\r\n                            : setPic(null);\r\n                    }}\r\n                />\r\n\r\n                <button\r\n                    style={{ marginBottom: \"10px\" }}\r\n                    onClick={function (e) {\r\n                        setPic(null)\r\n                        inputRef.current.click()\r\n                    }}\r\n                >\r\n                    Pick a image\r\n            </button>\r\n\r\n\r\n                {pic && <div style={{ marginBottom: \"10px\" }}>{pic.name}</div>}\r\n\r\n                {pic && <img src={pic ? URL.createObjectURL(pic) : \"\"} width=\"100px\" />}\r\n\r\n\r\n                <button style={{ marginTop: \"10px\" }}\r\n\r\n\r\n\r\n                    // disabled={percentage !== \"Upload\"}\r\n                    onClick={function (e) {\r\n                        pic ? uploadAvatar(pic)\r\n                            : alert(\"no pic is selected\")\r\n                    }}\r\n                >\r\n                    Submit\r\n            </button>\r\n\r\n            </>}\r\n\r\n            <button\r\n                onClick={function () {\r\n                    setAvatarSize(5)\r\n                }}\r\n\r\n            >Bigger</button>\r\n            <button\r\n                onClick={function () {\r\n                    setAvatarSize(-5)\r\n                }}\r\n            >Smaller</button>\r\n\r\n\r\n        </Pannel>\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default AvartarSetter;\r\n\r\n\r\n","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport axios from './contexts/axios';\r\n\r\n\r\nimport url from \"./config\";\r\n\r\n\r\nconst Pannel = styled.div`\r\n\r\n    display: flex; \r\n    justify-content: center;\r\n    align-items:center;\r\n    width: 100%;\r\n    height:100%;\r\n    overflow:visible;\r\n    flex-direction:column;\r\n    background-color:${function ({ theme }) { return theme.color3 }};\r\n\r\n\r\n    &  button{\r\n        font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n    }\r\n\r\n\r\n`\r\n\r\n\r\nconst BackPictureSetter = () => {\r\n    const [pic, setPic] = useState()\r\n\r\n    const {\r\n        userName,\r\n        setUserBackPicture,\r\n        uploadBackPicture,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n\r\n        backPicOrian,\r\n        setBackPicOrian,\r\n        backPicOpacity,\r\n        setBackPicOpacity,\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n\r\n\r\n    const inputRef = useRef()\r\n\r\n\r\n    return (\r\n\r\n        <Pannel>\r\n\r\n\r\n            {userName && <>\r\n                <input type=\"file\" style={{ marginBottom: \"10px\", width: \"100%\", display: \"none\" }} ref={inputRef}\r\n\r\n                    onClick={function (e) {\r\n                        e.currentTarget.value = null;\r\n                    }}\r\n\r\n                    onChange={function (e) {\r\n                        // alert((e.currentTarget.files[0].name).trim());\r\n                        e.currentTarget.files[0].name.trim().match(/\\.(gif|jpe?g|tiff|png|webp|bmp)$/i)\r\n                            ? setPic(e.currentTarget.files[0])\r\n                            : setPic(null);\r\n                    }}\r\n                />\r\n\r\n                <button\r\n                    style={{ marginBottom: \"10px\" }}\r\n                    onClick={function (e) {\r\n                        setPic(null)\r\n                        inputRef.current.click()\r\n                    }}\r\n                >\r\n                    Pick a image\r\n            </button>\r\n\r\n\r\n                {pic && <div style={{ marginBottom: \"10px\" }}>{pic.name}</div>}\r\n\r\n                {pic && <img src={pic ? URL.createObjectURL(pic) : \"\"} width=\"100px\" />}\r\n\r\n\r\n                <button style={{ marginTop: \"10px\" }}\r\n\r\n\r\n\r\n                    // disabled={percentage !== \"Upload\"}\r\n                    onClick={function (e) {\r\n\r\n                      \r\n                        pic ? uploadBackPicture(pic).then(function () {\r\n                            pic && setUserBackPicture(URL.createObjectURL(pic))\r\n                        })\r\n                            : alert(\"no pic is selected\")\r\n\r\n\r\n                    }}\r\n                >\r\n                    Submit\r\n            </button>\r\n            </>}\r\n         \r\n\r\n                    {backPicOrian===\"horizontal\"?\"Horizontal\":\"Verticle\"}\r\n                   \r\n                        <button\r\n                        onClick={function(){\r\n\r\n                            setBackPicOrian(backPicOrian===\"horizontal\"?\"verticle\":\"horizontal\")\r\n                        }}\r\n                        \r\n                        \r\n                        >{backPicOrian===\"horizontal\"?\"setTo Verticle\":\"setTo Horizontal\"}</button>\r\n                   <div>   \r\n                      <button\r\n                        onClick={function(){\r\n                            setBackPicOpacity(pre=>{\r\n\r\n                                return (Math.min(pre+0.1,1))\r\n                            })\r\n                        }}\r\n                      \r\n                      \r\n                      ></button>\r\n                      <button\r\n                        onClick={function(){\r\n                            setBackPicOpacity(pre=>{\r\n\r\n                                return (Math.max(pre-0.1,0))\r\n                            })\r\n                        }}\r\n                      \r\n                      \r\n                      ></button>\r\n                  </div>\r\n\r\n        </Pannel>\r\n\r\n    );\r\n}\r\n\r\nexport default BackPictureSetter;","\r\nimport React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes, ThemeContext as ThemeStyledContext } from \"styled-components\";\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\n\r\nconst Button_ = styled.button`\r\n      font-size:   ${function ({ theme }) { return theme.fontSize1 }};\r\n`\r\n\r\n\r\nexport default function Button(props) {\r\n\r\n\r\n    const {\r\n\r\n        fontSize1,\r\n\r\n\r\n    } = useContext(ThemeContext);\r\n\r\n    return (\r\n            <Button_ {...props}>{props.children}</Button_>\r\n    );\r\n}\r\n\r\n","\r\nimport React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport Button from './Button';\r\n\r\n\r\n\r\n\r\nconst Div = styled.div`\r\n\r\ndisplay:flex;\r\njustify-content:center;\r\nalign-items:center;\r\nbackground-color:${function ({ theme }) { return theme.color3 }};\r\nwidth:100%;\r\nheight:100%;\r\nflex-direction:column;\r\n\r\n& > button{\r\n    font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n}\r\n`\r\n\r\n\r\n\r\nexport default function WidthSetter(...props) {\r\n\r\n\r\n    const { } = useContext(ThemeContext)\r\n    const { setEditorWidth, editorWidth } = useContext(ThemeContext)\r\n\r\n    return (\r\n\r\n        <Div>\r\n\r\n\r\n       \r\n                <Button\r\n                    onClick={function (e) {\r\n                        setEditorWidth(5, 0, 0)\r\n                    }}\r\n                >\r\n                    Add width {editorWidth.width}%\r\n            </Button>\r\n\r\n         \r\n                <Button\r\n                    onClick={function (e) {\r\n                        setEditorWidth(-5, 0, 0)\r\n                    }}\r\n                >\r\n                    Reduce width {editorWidth.width}%\r\n            </Button> \r\n        \r\n                <Button\r\n                    onClick={function (e) {\r\n                        setEditorWidth(0, 10, 0)\r\n                    }}\r\n                >\r\n                    Add minWidth {editorWidth.minWidth}px\r\n            </Button> \r\n        \r\n                <Button\r\n                    onClick={function (e) {\r\n                        setEditorWidth(0, -10, 0)\r\n                    }}\r\n                >\r\n                    reduce minWidth {editorWidth.minWidth}px\r\n            </Button> \r\n\r\n        </Div>\r\n\r\n    );\r\n}\r\n\r\n","\r\n\r\nimport React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\n\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\n// import colorsys, { rgb2Cmyk } from 'colorsys';\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\n\r\nimport ColorSetter from \"./ColorSetter\";\r\nimport FontSizeSetter from \"./FontSizeSetter\";\r\nimport AvatarSetter from \"./AvatarSetter\";\r\nimport BackPictureSetter from './BackPictureSetter';\r\nimport WidthSetter from './WidthSetter';\r\n\r\nlet pos = \"editorWidth\";\r\n\r\nconst ThemeSetter = () => {\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n\r\n\r\n\r\n    const {\r\n\r\n        color1, color2, color3, color4,\r\n        setColor1, setColor2, setColor3, setColor4,\r\n\r\n        logoImageSize, logoTextSize,\r\n        setLogoSize,\r\n\r\n        fontSize1, fontSize2, fontSize3, fontSize4, fontSize5,\r\n        setFontSize1, setFontSize2, setFontSize3, setFontSize4, setFontSize5,\r\n\r\n        showThemeSetter, setShowThemeSetter,\r\n\r\n        uploadTheme,\r\n\r\n\r\n    } = useContext(ThemeContext);\r\n\r\n    const [index, setIndex] = useState(pos)\r\n\r\n\r\n    return (\r\n        showThemeSetter &&\r\n        <div style={{\r\n            display: \"flex\",\r\n            //   backgroundColor: \"rgb(255,100,255,0.2)\",\r\n\r\n\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            position: \"fixed\",\r\n            width: \"100%\", left: \"0px\", top: \"0px\",\r\n            height: \"100%\",\r\n            zIndex: 10,\r\n        }}>\r\n            <div style={{\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                alignItems: isComputer ? \"center\" : \"flex-start\", //\"center\",   \r\n\r\n                //alignItems:  \"flex-start\", //\"center\",   \r\n                //alignItems: \"center\", \r\n\r\n\r\n                // backgroundColor: \"rgb(255,255,255,0.5)\",\r\n                width: isComputer ? \"80%\" : \"90%\", height: isComputer ? \"80%\" : \"90%\",\r\n                overflow: \"auto\",\r\n                boxShadow: `\r\n                0px 0px 2px #5f5f5f,\r\n                /* offset */\r\n                0px 0px 0px 5px #ecf0f3,\r\n                /*bottom right */\r\n                8px 8px 15px #a7aaaf,\r\n                /* top left */\r\n                -8px -8px 15px #ffffff`,\r\n\r\n\r\n                backgroundColor: color3,\r\n            }}>\r\n\r\n                <div style={{\r\n                    display: \"flex\", position: \"sticky\",\r\n                    top: \"0\", left: \"0\", justifyContent: \"center\", width: \"100%\",\r\n                    backgroundColor: color2,\r\n                }}>\r\n\r\n                    <select defaultValue={pos}\r\n\r\n                        style={{\r\n                            fontSize: fontSize1 + \"rem\"\r\n                        }}\r\n\r\n                        onChange={function (e) {\r\n                            pos = String(e.target.value)\r\n                            setIndex(pos)\r\n\r\n                        }}\r\n                    >\r\n                        <option value=\"color1\" >logo</option>\r\n                        <option value=\"color2\" ></option>\r\n                        <option value=\"color3\" ></option>\r\n                        <option value=\"color4\" ></option>\r\n\r\n\r\n                        <option value=\"0\" >logo</option>\r\n                        <option value=\"1\" ></option>\r\n                        <option value=\"2\" ></option>\r\n                        <option value=\"3\" ></option>\r\n                        <option value=\"4\" ></option>\r\n                        <option value=\"5\" ></option>\r\n\r\n                        <option value=\"avatar\"></option>\r\n                        <option value=\"backPicture\"></option>\r\n                        <option value=\"editorWidth\"></option>\r\n                    </select>\r\n                    <button style={{ position: \"absolute\", right: \"0px\", fontSize: fontSize1 + \"rem\" }} onClick={function () {\r\n                        setShowThemeSetter(false);\r\n                        uploadTheme();\r\n                    }}\r\n                    ></button>\r\n                </div>\r\n\r\n\r\n                {index === \"color1\" && <ColorSetter color={color1} setColor={setColor1} />}\r\n                {index === \"color2\" && <ColorSetter color={color2} setColor={setColor2} />}\r\n                {index === \"color3\" && <ColorSetter color={color3} setColor={setColor3} />}\r\n                {index === \"color4\" && <ColorSetter color={color4} setColor={setColor4} />}\r\n\r\n                {index === \"0\" && <FontSizeSetter fontSize={logoTextSize} setFontSize={setLogoSize} />}\r\n                {index === \"1\" && <FontSizeSetter fontSize={fontSize1} setFontSize={setFontSize1} />}\r\n                {index === \"2\" && <FontSizeSetter fontSize={fontSize2} setFontSize={setFontSize2} />}\r\n                {index === \"3\" && <FontSizeSetter fontSize={fontSize3} setFontSize={setFontSize3} />}\r\n                {index === \"4\" && <FontSizeSetter fontSize={fontSize4} setFontSize={setFontSize4} />}\r\n                {index === \"5\" && <FontSizeSetter fontSize={fontSize5} setFontSize={setFontSize5} />}\r\n\r\n                {index === \"avatar\" && <AvatarSetter />}\r\n                {index === \"backPicture\" && <BackPictureSetter />}\r\n                {index === \"editorWidth\" && <WidthSetter />}\r\n\r\n\r\n            </div>\r\n        </div>\r\n\r\n    );\r\n}\r\n\r\nexport default ThemeSetter;\r\n","import React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\n\r\nimport { Link } from 'react-router-dom';\r\nimport ThemeSetter from './ThemeSetter';\r\n\r\n\r\nconst Div = styled.div`\r\nz-index:10;\r\n    display: flex;\r\n    background-color: rgb(25,25,25,0.2);\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    left: 0; \r\n    top: 0;\r\n`\r\nconst DivSub = styled.div`\r\n    display: flex;\r\n    position:relative;\r\n    flex-direction:column;\r\n    width: ${function ({ isComputer }) { return isComputer ? \"50%\" : \"80%\" }};\r\n    height:${function ({ isComputer }) { return isComputer ? \"70%\" : \"90%\" }};\r\n    background-color: ${function ({ theme }) { return theme.color3 }};\r\n    /* justify-content: center; */\r\n    align-items: center;\r\n    font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n    box-shadow: 0px 0px 2px #5f5f5f,\r\n                /* offset */\r\n                0px 0px 0px 5px #ecf0f3,\r\n                /*bottom right */\r\n                8px 8px 15px #a7aaaf,\r\n                /* top left */\r\n                -8px -8px 15px #ffffff;\r\n    \r\n            \r\n\r\n    \r\n    \r\n\r\n    & > div:nth-child(1){     \r\n             align-self:flex-end;\r\n    }\r\n\r\n    & > div >input , label,  button:nth-child(1) {\r\n        font-size: ${function ({ theme }) { return theme.fontSize1 }};\r\n    }\r\n    & > div >input  {\r\n        width: ${function ({ isComputer }) { return isComputer ? \"auto\" : \"100%\" }};\r\n    }\r\n    \r\n\r\n   \r\n\r\n  \r\n`\r\n\r\n\r\n\r\n\r\nconst LoginForm = () => {\r\n\r\n\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n    const {\r\n    //    userName, setUserName,\r\n\r\n        login,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n\r\n        showLogin, setShowLogin,\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n    const [userName, setUserName] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n\r\n\r\n    return (\r\n\r\n        showLogin &&\r\n        <Div>\r\n\r\n            <DivSub isComputer={isComputer}>\r\n\r\n                <div>\r\n                    <button\r\n                        onClick={function (e) {\r\n                            setShowLogin(false)\r\n\r\n                        }}\r\n                    >close</button>\r\n                </div>\r\n\r\n                <div>\r\n                    <label htmlFor=\"login\">login</label>\r\n                    <br />\r\n                    <input id=\"login\" type=\"text\" placeholder=\"\" value={userName}\r\n                        onChange={function (e) {\r\n                            setUserName(e.currentTarget.value);\r\n                        }}\r\n\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label htmlFor=\"password\">password</label>\r\n                    <br />\r\n                    <input id=\"password\" type=\"password\" placeholder=\" \" value={password}\r\n                        onChange={function (e) {\r\n                            setPassword(e.currentTarget.value);\r\n                        }}\r\n\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <button style={{ marginTop: \"10px\" }}\r\n\r\n                        onClick={function () {\r\n                            login(userName,password)\r\n                        }}\r\n                    >Login</button>\r\n                </div>\r\n\r\n            </DivSub>\r\n\r\n\r\n        </Div>\r\n\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default LoginForm;","\r\nimport React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport ThemeSetter from './ThemeSetter';\r\n\r\n\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\n\r\n\r\n\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\nconst Div = styled.div`\r\n    z-index:10;\r\n    display: flex;\r\n    background-color: rgb(25,25,25,0.2);\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    left: 0; \r\n    top: 0;\r\n\r\n \r\n`\r\n\r\nconst DivSub = styled.div`\r\n    display: flex;\r\n    position:relative;\r\n    flex-direction:column;\r\n    width: ${function ({ isComputer }) { return isComputer ? \"50%\" : \"80%\" }};\r\n    height:${function ({ isComputer }) { return isComputer ? \"70%\" : \"90%\" }};\r\n    background-color: ${function ({ theme }) { return theme.color3 }};\r\n    /* justify-content: center; */\r\n    align-items: center;\r\n    font-size:${function ({ theme }) { return theme.fontSize1 }};\r\n    box-shadow: 0px 0px 2px #5f5f5f,\r\n                /* offset */\r\n                0px 0px 0px 5px #ecf0f3,\r\n                /*bottom right */\r\n                8px 8px 15px #a7aaaf,\r\n                /* top left */\r\n                -8px -8px 15px #ffffff;\r\n\r\n    & > div:nth-child(1){     \r\n             align-self:flex-end;\r\n    }\r\n    & > div >input , label,  button:nth-child(1), button:nth-child(2) {\r\n        font-size: ${function ({ theme }) { return theme.fontSize1 }};\r\n    }\r\n`\r\n\r\nconst LogoutForm = () => {\r\n\r\n    const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n    const {\r\n     \r\n\r\n        logout,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n\r\n        showLogout, setShowLogout,\r\n\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n\r\n    return (\r\n\r\n        showLogout && <Div>\r\n            <DivSub  isComputer={isComputer}>\r\n\r\n                <div>\r\n                    <button\r\n                        onClick={function (e) {\r\n                            setShowLogout(false)\r\n\r\n                        }}\r\n                    >close</button>\r\n                </div>\r\n\r\n                <div>\r\n\r\n                        <button\r\n                        \r\n                        onClick={function(e){\r\n                            logout()\r\n                        }}\r\n                        \r\n                        >OK</button>\r\n                        <button   onClick={function (e) {\r\n                            setShowLogout(false)\r\n\r\n                        }}>Cancel</button>\r\n\r\n                </div>\r\n            </DivSub>\r\n\r\n        </Div>\r\n\r\n\r\n    );\r\n}\r\n\r\nexport default LogoutForm;","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport axios from './contexts/axios';\r\n\r\n\r\nimport url from \"./config\";\r\n \r\nconst Div = styled.div`\r\n \r\ndisplay:flex;\r\njustify-content:center;\r\nbackground-color:pink;\r\n\r\n        /* ${function ({ theme }) { return theme.fontSize2 }} */\r\nwidth: ${function ({ theme, isSmall }) {\r\n\r\n        return isSmall ? Number(theme.avatarSize.replace(\"px\", \"\")) / 2 + \"px\" : theme.avatarSize\r\n    }} ;\r\nheight:${function ({ theme, isSmall }) { return isSmall ? Number(theme.avatarSize.replace(\"px\", \"\")) / 2 + \"px\" : theme.avatarSize }} ;\r\n\r\n\r\noverflow:hidden;\r\n\r\nborder-radius:1000px;\r\n\r\nbox-shadow:   ${function ({ theme, isSmall }) { return  isSmall?\"\":\"0px 0px 6px #5f5f5f;\" } };\r\n\r\n\r\n`\r\n\r\n\r\nconst Img = styled.img.attrs(\r\n    function ({ oriantation, theme, isSmall }) {\r\n\r\n        if (oriantation === \"horizontal\") {\r\n            return {\r\n\r\n                height: isSmall ? Number(theme.avatarSize.replace(\"px\", \"\")) / 2 + \"px\" : theme.avatarSize\r\n\r\n                //height: `${theme.avatarSize}`\r\n            }\r\n        }\r\n\r\n        if (oriantation === \"verticle\") {\r\n            return {\r\n                width: isSmall ? Number(theme.avatarSize.replace(\"px\", \"\")) / 2 + \"px\" : theme.avatarSize\r\n\r\n                //width:  `${theme.avatarSize}`\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n)`\r\nposition:relative;\r\ndisplay:inline;\r\n\r\n\r\n`\r\n\r\n\r\n\r\nexport default function Avartar({ peopleName, ...props }) {\r\n\r\n\r\n\r\n    const {\r\n        userAvatar,\r\n        userState,\r\n        axios,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n\r\n\r\n\r\n    const people = peopleName\r\n        ? userState\r\n            ? userState.userName === peopleName\r\n                ? null\r\n                : peopleName : peopleName\r\n        : null\r\n\r\n\r\n\r\n    const [oriantation, setOriantation] = useState(\"verticle\")\r\n    useMemo(function () {\r\n        (people || userState) && axios.get(`${url}/avatar/getoriantation/${people ? people : userState.userName}`)\r\n            .then((response) => {\r\n                setOriantation(response.data)\r\n\r\n            })\r\n\r\n    }, [people, userState, userAvatar])\r\n\r\n    const isSmall = props.isSmall;\r\n\r\n    return (\r\n        <>\r\n\r\n\r\n            {(people || userState) && <Div className=\"avatar\" isSmall={isSmall}>\r\n                <div href={\"/\" + people || userState.userName} download=\"pic_logo\" style={{ cursor: \"default\", }}\r\n\r\n                    onClick={\r\n                        function (e) {\r\n\r\n                            // props.onClick\r\n                            //     ? props.onClick(e)\r\n                            //     : alert(people || userState.userName)\r\n\r\n                        }}\r\n                >\r\n                    <Img title={people || userState.userName}\r\n                        oriantation={oriantation}\r\n                        src={people ? `${url}/avatar/downloadavatar/${people}` : userAvatar}\r\n                        download=\"dsd\" alt={people || userState.userName + \" logo\"}\r\n                        style={{ objectFit: \"contain\", }}\r\n                        isSmall={isSmall}\r\n                        onClick={props.onClick}\r\n                    />\r\n\r\n                </div>\r\n\r\n\r\n            </Div>}\r\n\r\n        </>\r\n    );\r\n}\r\n\r\n\r\nexport function AvartarSmall({ peopleName, ...props }) {\r\n\r\n\r\n\r\n    const {\r\n        userAvatar,\r\n        userState,\r\n        axios,\r\n    } = useContext(UserContext)\r\n\r\n    const {\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n\r\n\r\n\r\n    const people = peopleName\r\n    // ? userState\r\n    //     ? userState.userName === peopleName\r\n    //         ? null\r\n    //         : peopleName : peopleName\r\n    // : null\r\n\r\n\r\n\r\n    const [oriantation, setOriantation] = useState(\"verticle\")\r\n\r\n    // axios.get(`${url}/avatar/getoriantation/${people}`)\r\n    //     .then((response) => {\r\n    //         setOriantation(response.data)\r\n\r\n    //     })\r\n\r\n\r\n\r\n    const isSmall = props.isSmall;\r\n\r\n    return (\r\n\r\n\r\n\r\n        <Div className=\"avatar\" isSmall={isSmall} style={{ ...props.style }}    >\r\n            <div href={\"/\" + people || userState.userName} download=\"pic_logo\" style={{ cursor: \"default\", }}>\r\n                <Img title={people || userState.userName}\r\n                    oriantation={oriantation}\r\n                    src={ `${url}/avatar/downloadavatar/${people}` }\r\n                    download=\"dsd\" alt={people }\r\n                    style={{ objectFit: \"contain\", }}\r\n                    isSmall={isSmall}\r\n\r\n\r\n                />\r\n\r\n            </div>\r\n        </Div>\r\n\r\n\r\n\r\n\r\n    );\r\n\r\n}\r\n\r\n","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport axios from './contexts/axios';\r\n\r\n\r\nimport url from \"./config\";\r\nimport { object } from 'prop-types';\r\n\r\n\r\nimport {\r\n    isMobile,\r\n    isFirefox,\r\n    isChrome,\r\n    browserName,\r\n    engineName,\r\n} from \"react-device-detect\";\r\n\r\nexport function Avatar4_({ peopleName, ratio = 1, imgOnly = false, ...props }) {\r\n\r\n\r\n    const { userName, userAvatar } = useContext(UserContext)\r\n\r\n    const { fontSize1, fontSize2, ratioRemAndPx, setRatioRemAndPx, } = useContext(ThemeContext)\r\n\r\n\r\n    const [avatarSize, setAvatarSize] = useState(0)\r\n\r\n\r\n    const [avatarSourceSize, setAvatarSourceSize] = useState({ width: \"auto\", height: \"auto\", oriantation: true, /*shiftX: \"translateX(0)\"*/ })\r\n\r\n    const colorRandom = useRef(\"#\" + ((1 << 24) * Math.random() | 0).toString(16))\r\n\r\n\r\n    useEffect(function () {\r\n\r\n\r\n        const size = peopleName\r\n            ? parseFloat(getComputedStyle(document.getElementsByClassName(\"_avatar_size_\")[1]).fontSize)\r\n            : parseFloat(getComputedStyle(document.getElementsByClassName(\"_avatar_size_\")[0]).fontSize)\r\n\r\n        //   alert(parseFloat(getComputedStyle(document.getElementsByClassName(\"_avatar_size_\")[0]).fontSize))\r\n\r\n\r\n\r\n        // alert(size)\r\n\r\n        console.log(size)\r\n\r\n\r\n\r\n        setAvatarSize(size * ratio)\r\n\r\n        const ratio_size = parseFloat(getComputedStyle(document.getElementsByClassName(\"_avatar_size_\")[2]).fontSize)\r\n\r\n        const aaa = ratio_size / fontSize2\r\n\r\n        //   alert(  ratio_size/fontSize2 )\r\n        setRatioRemAndPx(ratio_size / fontSize2)\r\n\r\n    }, [fontSize1, fontSize2, peopleName, userAvatar])\r\n\r\n    useEffect(function () {\r\n\r\n        const ratio_size = parseFloat(getComputedStyle(document.getElementsByClassName(\"_avatar_size_\")[2]).fontSize)\r\n        //  alert((ratio_size) + \"===\"+ fontSize2 + \"===\"+ratio_size/fontSize2)\r\n    })\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n\r\n\r\n            <div\r\n                style={{\r\n                    width: avatarSize + \"px\",\r\n                    height: avatarSize + \"px\",\r\n                    backgroundColor: colorRandom.current,//\"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n                    overflow: \"hidden\",\r\n                    display: \"inline-block\",\r\n                    borderRadius: \"1000px\",\r\n                    fontSize: avatarSize / 2.5 + \"px\",\r\n                    //    fontSize: peopleName?fontSize2+\"rem\":fontSize1+\"rem\",\r\n                    verticalAlign: \"text-bottom\",\r\n                    boxShadow: !peopleName ? \"0px 0px 6px #5f5f5f\" : \"\",\r\n\r\n                    // borderStyle: \"solid\",\r\n                    borderWidth: \"0px\",\r\n                    // borderBlockColor: \"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n\r\n                }}\r\n                {...props}\r\n            >\r\n                <div style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"flex-start\" }}>\r\n                    <img\r\n\r\n                        src={\r\n                            peopleName\r\n                                ? `${url}/avatar/downloadavatar/${peopleName}`\r\n                                : userName\r\n                                    ? userAvatar\r\n                                    : `${url}/avatar/downloadavatar/__unknown_person_?__`\r\n\r\n                        }\r\n                        width={avatarSourceSize.oriantation ? \"auto\" : avatarSize + \"px\"}\r\n                        height={!avatarSourceSize.oriantation ? \"auto\" : avatarSize + \"px\"}\r\n\r\n                        // width={avatarSize + \"px\"}\r\n                        // height={avatarSize + \"px\"}\r\n\r\n\r\n                        style={{\r\n\r\n                            //transform: avatarSourceSize.shiftX,\r\n                            //transform: \"translateX(-25%)\"\r\n                            objectFit: \"cover\"\r\n\r\n                        }}\r\n                        // alt={peopleName || userName}\r\n                        download={peopleName || userName}\r\n                        title={peopleName || userName}\r\n                        crossOrigin=\"anonymous\"\r\n                        onLoad={function (e) {\r\n                            const img = e.currentTarget\r\n\r\n                            setAvatarSourceSize({\r\n                                // width: img.width,\r\n                                // height: img.height,\r\n                                oriantation: img.width >= img.height,\r\n                                // get shiftX() {\r\n                                //     return `translateX(-${this.oriantation ? img.width * avatarSize / img.height / 2 - avatarSize / 2 : 0}px)`\r\n                                // },\r\n                            })\r\n\r\n\r\n\r\n\r\n\r\n                        }}\r\n\r\n                    /></div>\r\n\r\n            </div>\r\n\r\n            {imgOnly ? \"\" : peopleName || userName}\r\n\r\n\r\n\r\n            <div style={{ display: \"none\", fontSize: fontSize1 + \"rem\", }} className=\"_avatar_size_\">@</div>\r\n            <div style={{ display: \"none\", fontSize: fontSize2 + \"rem\", }} className=\"_avatar_size_\">@</div>\r\n            <div style={{ display: \"none\", fontSize: fontSize2 + \"rem\", }} className=\"_avatar_size_\">@</div>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport function LongMentionOffHead({ imgurl, peopleName, children, ...props }) {\r\n\r\n    const { fontSize1, fontSize2, ratioRemAndPx, setRatioRemAndPx, } = useContext(ThemeContext)\r\n\r\n    const { userName, contentList, deleteContentList, friendsList, setFriendsList, uploadFriendsList } = useContext(UserContext)\r\n\r\n    return (\r\n        <span\r\n\r\n            style={{\r\n                display: \"inline\",\r\n                //        backgroundColor: \"#b7e1fc\",\r\n                borderTopLeftRadius: \"1000px\", borderBottomLeftRadius: \"1000px\",\r\n                //  borderRadius:\"1000px\"\r\n                //            verticalAlign: \"middle\",\r\n            }}\r\n\r\n            onClick={function (e) {\r\n\r\n                if (userName) {\r\n\r\n                    if(userName===peopleName){  alert(\"\") ;return null}\r\n\r\n                    console.log(friendsList)\r\n                    const isFriendBefore = friendsList.includes(peopleName)\r\n\r\n                    const answer = isFriendBefore\r\n                        ? window.confirm(\"\" + peopleName)\r\n                        : window.confirm(\" \" + peopleName)\r\n\r\n\r\n                    if (isFriendBefore && answer) {\r\n                        setFriendsList(pre => {\r\n\r\n                            const arr = pre.filter(people => { return people !== peopleName })\r\n\r\n                            console.log(arr)\r\n                            uploadFriendsList(arr)\r\n                            return arr\r\n                        })\r\n                    }\r\n\r\n\r\n                    else if (answer && !isFriendBefore) {\r\n                        setFriendsList(\r\n                            pre => {\r\n\r\n                                const arr = [...new Set([...pre, peopleName])]\r\n                                console.log(arr)\r\n                                uploadFriendsList(arr)\r\n                                return arr\r\n                            }\r\n                        )\r\n                    }\r\n\r\n\r\n                }\r\n\r\n\r\n\r\n            }}\r\n\r\n        >\r\n\r\n            <div style={{\r\n\r\n\r\n                //   lineHeight: \"0px\",\r\n                height: isMobile && isFirefox ? fontSize2 * 21.6 * 1.2 + \"px\" : fontSize2 * 16 * 1.2 + \"px\",\r\n                width: isMobile && isFirefox ? fontSize2 * 21.6 * 1.2 + \"px\" : fontSize2 * 16 * 1.2 + \"px\",\r\n                display: \"inline-flex\",\r\n                alignItems: \"center\",\r\n\r\n                color: \"rgba(200,0,0,0)\",\r\n                //     backgroundColor: \"purple\",\r\n                borderRadius: \"1000px\",\r\n                backgroundPosition: \"center center\",\r\n                backgroundImage: imgurl || `url(${url}/avatar/downloadavatar/${peopleName})`,\r\n                backgroundRepeat: \"no-repeat\",\r\n\r\n\r\n                backgroundSize: \"cover\",\r\n                boxShadow: \"rgb(180, 180, 180) -2px 0px 3px\",\r\n            }}>\r\n                {/* {node.children.map(item => item.data)} */}\r\n                {children}\r\n            </div>\r\n\r\n        </span>\r\n    )\r\n\r\n}\r\n\r\nexport function LongMentionOffBody({ children, ...props }) {\r\n\r\n    const { fontSize1, fontSize2, ratioRemAndPx, setRatioRemAndPx, } = useContext(ThemeContext)\r\n    return (\r\n\r\n        <span\r\n\r\n            style={{\r\n\r\n                lineHeight: \"0px\",\r\n                height: fontSize2 * 16 * 1.2 + \"px\",\r\n                display: \"inline-flex\",\r\n                alignItems: \"center\",\r\n                display: \"inline\",\r\n                //  backgroundColor: \"#b7e1fc\",\r\n\r\n                //   paddingLeft:10+\"px\",\r\n                //   paddingRight:fontSize2/2+\"rem\",\r\n\r\n                //    borderTopRightRadius: fontSize2*16+\"px\", borderBottomRightRadius: fontSize2*16+\"px\",\r\n                //    verticalAlign: \"middle\",\r\n            }}>\r\n            {children}\r\n        </span>\r\n\r\n    )\r\n\r\n\r\n\r\n}\r\n\r\nexport function Avatar5({ peopleName, ratio = 1, imgOnly = false, ...props }) {\r\n\r\n\r\n    return (\r\n        <>\r\n            <LongMentionOffHead></LongMentionOffHead>\r\n        </>\r\n\r\n\r\n    )\r\n\r\n}\r\n\r\nexport function Avatar4({ peopleName, imgOnly = true, ...props }) {\r\n\r\n    const { userName, userAvatar, contentList, deleteContentList, friendsList, setFriendsList, uploadFriendsList } = useContext(UserContext)\r\n    const { fontSize1, fontSize2, ratioRemAndPx, setRatioRemAndPx, avatarSize } = useContext(ThemeContext)\r\n\r\n    return (\r\n        <span {...props}   >\r\n\r\n\r\n\r\n            <img src={peopleName ? `${url}/avatar/downloadavatar/${peopleName}` : userAvatar}\r\n\r\n                style={{\r\n                    display: \"inline-block\",\r\n                    borderRadius: \"1000px\",\r\n                    height: avatarSize + \"px\",\r\n                    width: avatarSize + \"px\",\r\n                    boxShadow: !peopleName ? \"0px 0px 6px #5f5f5f\" : \"\",\r\n                    verticalAlign: \"middle\",\r\n                    backgroundColor:\"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n                }}\r\n\r\n                onClick={function () {\r\n\r\n\r\n                    if (userName && peopleName) {\r\n                        console.log(friendsList)\r\n\r\n                        if(userName===peopleName){  alert(\"\") ;return null}\r\n\r\n                        const isFriendBefore = friendsList.includes(peopleName)\r\n\r\n                        const answer = isFriendBefore\r\n                            ? window.confirm(\"\" + peopleName)\r\n                            : window.confirm(\" \" + peopleName)\r\n\r\n\r\n                        if (isFriendBefore && answer) {\r\n                            setFriendsList(pre => {\r\n\r\n                                const arr = pre.filter(people => { return people !== peopleName })\r\n\r\n                                console.log(arr)\r\n                                uploadFriendsList(arr)\r\n                                return arr\r\n                            })\r\n                        }\r\n\r\n\r\n                        else if (answer && !isFriendBefore) {\r\n                            setFriendsList(\r\n                                pre => {\r\n\r\n                                    const arr = [...new Set([...pre, peopleName])]\r\n                                    console.log(arr)\r\n                                    uploadFriendsList(arr)\r\n                                    return arr\r\n                                }\r\n                            )\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n\r\n\r\n\r\n                }}\r\n\r\n            />\r\n            <span style={{ fontSize: fontSize1 + \"rem\",      verticalAlign: \"middle\", }} >{imgOnly ? \"\" : peopleName || userName}</span>\r\n        </span>\r\n\r\n    )\r\n\r\n}","\r\nimport React, { useContext, useRef, useEffect, useState } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes , ThemeContext as ThemeStyledContext } from \"styled-components\";\r\nimport { Link } from 'react-router-dom';\r\n\r\n\r\nimport ThemeSetter from './ThemeSetter';\r\nimport LoginForm from './LoginForm';\r\nimport RegisterForm from './RegisterForm';\r\nimport LogoutForm from './LogoutForm';\r\nimport Avatar from './Avatar';\r\nimport {Avatar4} from './Avatar2';\r\n\r\nimport logo from './Images/logo.svg';\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\n\r\n\r\n\r\nconst Div = styled.div`\r\n    z-index:9;\r\n    color:${function ({ theme }) { return theme.color1 }};\r\n    background-color:${function ({ theme }) { return theme.color2 }}; \r\n   \r\n    display:flex;\r\n    flex-wrap:wrap;\r\n    justify-content:space-around;\r\n    align-items:center;\r\n\r\n     position:sticky;\r\n    \r\n    /* left:0px; */\r\n    top:0px; \r\n    \r\n    \r\n    \r\n    /* width:100%; */\r\n    box-shadow: 0px 0px 2px #5f5f5f,\r\n                /* offset */\r\n                0px 0px 0px 0px #ecf0f3,\r\n                /*bottom right */\r\n                8px -7px 15px #a7aaaf,\r\n                /* top left */\r\n                -8px -8px 15px #ffffff;\r\n               \r\n`\r\n\r\nconst LogoDiv = styled.div`\r\n\r\n    font-size: ${function ({ theme }) { return `${theme.logoTextSize}` }} ;\r\n \r\n    display:flex;\r\n    width:auto;\r\n    justify-content:space-between;\r\n    align-items:center;\r\n    \r\n\r\n    & > div:nth-child(1) > img:nth-child(1){\r\n\r\n        width:${function ({ theme }) { return `${theme.logoImageSize}` }}\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n`\r\n\r\nconst MenuDiv = styled.div`\r\n    display:flex;\r\n\r\n\r\n    justify-content:space-around;\r\n    align-items:center;\r\n\r\n    /* background-color:tan; */\r\n\r\n\r\n  & > button {\r\n      font-size:   ${function ({ theme }) { return theme.fontSize1 }};\r\n  }\r\n\r\n\r\n\r\n`\r\n\r\n\r\n\r\n\r\n\r\nconst Navbar = () => {\r\n  \r\n\r\n\r\n    const {  userName  } = useContext(UserContext)\r\n      \r\n\r\n\r\n  \r\n\r\n\r\n    const {\r\n\r\n        showLogin, setShowLogin,\r\n        showRegister, setShowRegister,\r\n        showLogout, setShowLogout,\r\n        showThemeSetter, setShowThemeSetter,\r\n\r\n\r\n\r\n    } = useContext(ThemeContext);\r\n\r\n    return (\r\n        <>\r\n\r\n\r\n            <ThemeSetter />\r\n            <LoginForm />\r\n            <RegisterForm />\r\n            <LogoutForm />\r\n\r\n            <Div id=\"navbar\">\r\n\r\n                <LogoDiv>\r\n                    <div><img src={logo} /></div>\r\n                    <div> <i></i> </div>\r\n                </LogoDiv>\r\n               \r\n\r\n                <MenuDiv>\r\n                    {!userName && <button onClick={function () {\r\n                        setShowLogin(true)\r\n                    }}\r\n                    ></button>}\r\n\r\n                    {!userName && <button onClick={function () {\r\n                        setShowRegister(true)\r\n                    }}\r\n                    ></button>}\r\n\r\n                    {userName && <button onClick={function () {\r\n                        setShowLogout(true)\r\n\r\n                    }}></button>}\r\n                    <button onClick={function () {\r\n\r\n                        setShowThemeSetter(true)\r\n                    }}></button>\r\n\r\n\r\n\r\n                    {/* <Avatar /> */}\r\n                    {userName&&<Avatar4 ratio={2} imgOnly={true} />}\r\n                   \r\n                </MenuDiv>\r\n\r\n               \r\n            </Div>\r\n\r\n\r\n\r\n\r\n\r\n        </>\r\n\r\n\r\n    );\r\n}\r\n\r\n\r\n\r\n\r\nexport default Navbar;\r\n\r\n","import React, { useContext } from \"react\";\r\nimport { RichUtils, KeyBindingUtil, EditorState, CompositeDecorator, Modifier } from \"draft-js\";\r\n\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\n\r\nexport const linkStyleMap = {\r\n\r\n    linkStyle: {\r\n        color: \"blue\",\r\n        textDecoration: \"underline\",\r\n\r\n    },\r\n\r\n}\r\n\r\n\r\nexport default function createLinkPlugin() {\r\n\r\n    let externalES = null;\r\n    let externalSetEditorState = null;\r\n\r\n\r\n    function linkStrategy(contentBlock, callback, contentState) {\r\n\r\n\r\n        ///  findWithRegex(/\\s([@#][\\w_\\[\\u4E00-\\u9FFF\\]]+)/g, contentBlock, callback)\r\n\r\n        contentBlock.findEntityRanges(\r\n            function (character) {\r\n                const entityKey = character.getEntity();\r\n                return (\r\n                    entityKey !== null && (\r\n                        contentState.getEntity(entityKey).getType() === \"linkOn\" ||\r\n                        contentState.getEntity(entityKey).getType() === \"linkOff\"\r\n                    )\r\n                );\r\n            },\r\n            callback\r\n        );\r\n    }\r\n\r\n    function Link(props) {\r\n        const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText } = props;\r\n        const { linkType, linkAddress, linkHost } = contentState.getEntity(entityKey).getData()\r\n\r\n        return (\r\n            <LinkComponent {...{\r\n                linkAddress,\r\n                linkType,\r\n                linkHost,\r\n                ...props\r\n            }}\r\n\r\n            />\r\n        )\r\n    }\r\n\r\n\r\n    function LinkComponent(props) {\r\n        const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText, linkType, linkAddress, linkHost } = props;\r\n        //  const { type, mutability, data: { link_address, link_length } } = contentState.getEntity(entityKey).toObject()\r\n        const { fontSize2 } = useContext(ThemeContext)\r\n\r\n        // console.log(type + \" \" + mutability + \" \" + link_address)\r\n        // style={{ fontSize: Math.max(fontSize2 * 0.7, 1) + \"rem\" }}>\r\n\r\n        if (linkType === \"linkOn\") {\r\n\r\n            return (\r\n                <>\r\n                    <span href={linkAddress} style={{ backgroundColor: \"#FAF\", fontSize: Math.max(fontSize2 * 0.7, 0.7) + \"rem\" }}>\r\n                        {props.children}\r\n                    </span>\r\n\r\n\r\n                </>\r\n            )\r\n\r\n\r\n        }\r\n        else if (linkType === \"linkOff\") {\r\n            return (\r\n                <>\r\n                    <span style={{\r\n                        fontSize: Math.max(fontSize2 * 0.7, 0.7) + \"rem\",\r\n\r\n\r\n                        color: \"blue\",\r\n                        //  textDecoration: \"underline\",\r\n\r\n                    }}>\r\n                        <span style={{\r\n                            width: \"0px\", height: \"0px\", display: \"inline-block\", overflow: \"hidden\", //clipPath:  \"circle(0% at 2250% 2250%)\",\r\n                        }}>\r\n                            {props.children}\r\n                        </span>\r\n                        {linkHost}\r\n                    </span>\r\n                </>\r\n\r\n\r\n            )\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    function taggingLink() {\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray();\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n            = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,];\r\n\r\n\r\n        const oldSelection = externalES.getSelection();\r\n        let newContent = externalES.getCurrentContent();\r\n        let newSelection = externalES.getSelection();\r\n\r\n\r\n\r\n        externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\r\n            const blockKey = block.getKey();\r\n            const blockType = block.getType();\r\n            const blockText = block.getText();\r\n\r\n\r\n            //   const regx = /\\s([a-zA-Z]{1,10}:\\/\\/)(([a-zA-Z0-9]+(\\.[a-zA-Z0-9]+){0,5})(:\\d{1,6})?)(\\/[^\\s\\r\\n\\/]+){0,6}(\\/)?/g\r\n\r\n            // const regx = /\\s([a-zA-Z]{1,10}:\\/\\/)((([a-zA-Z0-9]+(.?)){0,5})(:\\d{0,6})?)(\\/[^\\s\\r\\n\\/]+){0,7}(\\/)?/g\r\n\r\n            const regx = /\\s([a-zA-Z]{1,10}:\\/\\/)(([a-zA-Z0-9-_]+\\.?)+(:\\d{0,6})?)(\\/[^\\s\\r\\n\\/]+){0,7}(\\/)?/g\r\n\r\n            const metaArr = block.getCharacterList();\r\n            metaArr.forEach(function (item, index) {\r\n\r\n                if (item.getEntity()) {\r\n                    const entityType = newContent.getEntity(item.getEntity()).getType()\r\n\r\n                    if ((entityType === \"linkOn\") || (entityType === \"linkOff\")) {\r\n                        newSelection = externalES.getSelection().merge({\r\n                            anchorKey: blockKey,\r\n                            anchorOffset: index,\r\n                            focusKey: blockKey,\r\n                            focusOffset: index + 1,\r\n                            isBackward: false,\r\n                            hasFocus: false,\r\n                        })\r\n                        newContent = Modifier.applyEntity(newContent, newSelection, null)\r\n                    }\r\n                }\r\n                if (item.getStyle()) {\r\n                    const styleArr = item.getStyle().toArray()\r\n                    if (styleArr.includes(\"linkStyle\")) {\r\n                        newSelection = externalES.getSelection().merge({\r\n                            anchorKey: blockKey,\r\n                            anchorOffset: index,\r\n                            focusKey: blockKey,\r\n                            focusOffset: index + 1,\r\n                            isBackward: false,\r\n                            hasFocus: false,\r\n                        })\r\n                        newContent = Modifier.removeInlineStyle(newContent, newSelection, \"linkStyle\")\r\n                    }\r\n                }\r\n            })\r\n\r\n            let matchArr;\r\n            while ((matchArr = regx.exec(blockText)) !== null) {\r\n\r\n                const start = matchArr.index;\r\n                const end = matchArr.index + matchArr[0].length\r\n                const contentLenth = end - start;\r\n                const contentFocusAt = anchorFocusOffset - start;\r\n                const linkAddress = blockText.substring(start, end);\r\n                const linkHost = \" \" + matchArr[2];\r\n\r\n\r\n                const linkOn = hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt > 0) && (contentFocusAt <= contentLenth)\r\n                const linkOff = ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt <= 0) || (contentFocusAt - contentLenth > 0))\r\n\r\n\r\n\r\n\r\n                if (linkOn) {\r\n                    newContent = newContent.createEntity(\"linkOn\", \"MUTABLE\", { linkType: \"linkOn\", linkAddress, linkHost });\r\n                    const entityKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = externalES.getSelection().merge({\r\n                        anchorKey: blockKey,\r\n                        anchorOffset: start,   //[...blockText][start] === \" \" ? start + 1 : start,\r\n                        focusKey: blockKey,\r\n                        focusOffset: end,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n                }\r\n                else if (linkOff) {\r\n                    newContent = newContent.createEntity(\"linkOff\", \"MUTABLE\", { linkType: \"linkOff\", linkAddress, linkHost });\r\n                    const entityKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = externalES.getSelection().merge({\r\n                        anchorKey: blockKey,\r\n                        anchorOffset: start,   //[...blockText][start] === \" \" ? start + 1 : start,\r\n                        focusKey: blockKey,\r\n                        focusOffset: end,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n                    //  newContent = Modifier.applyInlineStyle(newContent, newSelection, \"linkStyle\")\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n            }\r\n        });\r\n\r\n        externalES = EditorState.push(externalES, newContent, \"insert-fragment\");\r\n        externalES = EditorState.acceptSelection(externalES, oldSelection);\r\n        return externalES;\r\n\r\n\r\n\r\n\r\n\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n    return {\r\n        keyBindingFn(event, { getEditorState, setEditorState }) {\r\n\r\n        },\r\n\r\n\r\n        handleKeyCommand(command, editorState, { getEditorState, setEditorState }) {\r\n            return \"un-handled\"\r\n\r\n        },\r\n\r\n        onChange(editorState, { setEditorState }) {\r\n            externalES = editorState;\r\n            externalSetEditorState = setEditorState;\r\n            externalES = taggingLink();\r\n            return externalES\r\n            //  return editorState \r\n        },\r\n\r\n\r\n\r\n\r\n        decorators: [\r\n            {\r\n                strategy: linkStrategy,\r\n                component: Link\r\n            }\r\n        ],\r\n    }\r\n\r\n};\r\n\r\n","import React, { useState, useRef, useEffect, useContext } from 'react';\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport url from \"./config\";\r\n\r\n//import { usePicDataList } from './Uploader';\r\n\r\nimport { update } from 'immutable';\r\n\r\nimport axios from './contexts/axios';\r\n\r\n\r\nexport default function ImgTag({ id, isIcon = false, ...props }) {\r\n\r\n    const { userName, axios, picDataList, setPicDataList } = useContext(UserContext)\r\n\r\n\r\n    const [src, setSrc] = useState()\r\n    useEffect(function () {\r\n        if (picDataList[id]) { setSrc(picDataList[id]) }\r\n        else {\r\n            axios.get(isIcon ? `${url}/picture/downloadiconpicture/${id}` : `${url}/picture/downloadpicture/${id}`,\r\n                { responseType: 'arraybuffer', }\r\n            ).then(function (response) {\r\n\r\n                const base64 = btoa(\r\n                    new Uint8Array(response.data).reduce(\r\n                        (data, byte) => data + String.fromCharCode(byte),\r\n                        '',\r\n                    ),\r\n                );\r\n                setSrc(\"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64)\r\n\r\n\r\n                setPicDataList(\r\n                    pre => {\r\n                        const obj = { ...pre, [id]:\"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64 }\r\n                        return obj\r\n                    }\r\n                )\r\n\r\n\r\n            })\r\n                .catch(err => { console.log(err.response) })\r\n        }\r\n\r\n\r\n\r\n    }, [id])\r\n\r\n    return (\r\n        <img src={src} id={id}  {...props} \r\n        \r\n       \r\n        \r\n        \r\n        \r\n        />\r\n    );\r\n}\r\n\r\n","\r\nimport React, { useContext, useRef, useEffect, useState, useMemo, } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes, ThemeContext as ThemeStyledContext } from \"styled-components\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport ImgTag from './ImgTag';\r\n\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n//import { EditorContext } from './EditorContextProvider';\r\nimport { EditorContext } from './DraftEditor4';\r\n\r\nimport url from \"./config\";\r\n\r\nimport Button from \"./Button\";\r\n\r\n\r\n\r\n\r\n\r\nexport default function Uploader({ insertImageBlock, deleteImageBlock, ...props }) {\r\n\r\n    const { userName, axios, picDataList, setPicDataList } = useContext(UserContext)\r\n\r\n    const { showPlugin, toggleShow } = useContext(EditorContext)\r\n\r\n    const isOn = showPlugin[\"ImagePluginPanel\"]\r\n    function setOn(...prop) { toggleShow(\"ImagePluginPanel\",...prop) }\r\n       \r\n\r\n\r\n        const { color2 } = useContext(ThemeContext)\r\n        const [pic, setPic] = useState()\r\n        const [picList, setPicList] = useState({})\r\n\r\n        const [uploadProgress, setUploadProgress] = useState(\"\")\r\n\r\n        const inputRef = useRef()\r\n\r\n        function getPictureList() {\r\n            if (!userName) { console.log(\"Please login first\"); alert(\"please login first\"); return null }\r\n\r\n\r\n            return axios.get(`${url}/picture/getpictureid/${userName}`)\r\n                .then(function ({ data }) {\r\n\r\n                    setPicList(\r\n                        function (pre) { return { ...data, ...pre } }\r\n                    )\r\n\r\n                })\r\n                .catch(function (err) {\r\n                    document.getElementById(`button_history`).disabled = false\r\n                    console.log(err)\r\n                })\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n        function uploadPicture(pic) {\r\n            if (!userName) { console.log(\"Please login first\"); alert(\"please login first\"); return null }\r\n\r\n            const data = new FormData();\r\n            data.append('file', pic);  // data.append('file', pic2);  //multi-uploading just append data\r\n\r\n            data.append('obj',\r\n                JSON.stringify({\r\n                    filename: pic.name.trim(),\r\n                    ownerName: userName,\r\n                    uploadTime: Date.now(),\r\n\r\n                })\r\n            );\r\n            setUploadProgress(\"0%\")\r\n            return axios.post(`${url}/picture/uploadpicture`, data, {\r\n                headers: { 'content-type': 'multipart/form-data' },\r\n\r\n\r\n\r\n                onUploadProgress: progressEvent => {\r\n\r\n                    const percent = (progressEvent.loaded * 100 / progressEvent.total).toFixed(0) + \"%\"\r\n\r\n                    percent === \"100%\"\r\n                        ? setUploadProgress(\"gathering\")\r\n                        : setUploadProgress(percent)\r\n\r\n                },\r\n            })\r\n        }\r\n\r\n\r\n        useEffect(function () {\r\n\r\n            pic && uploadPicture(pic).then(function (response) {\r\n\r\n                setPicList(pre => { return { ...pre, [response.data[0]]: response.data[1] } })\r\n\r\n                setPicDataList(pre => { return { ...pre, [response.data[1]]: URL.createObjectURL(pic) } })\r\n\r\n                insertImageBlock(`${url}/picture/downloadpicture/${response.data[1]}`, response.data[1], URL.createObjectURL(pic))\r\n\r\n                setPic(null)\r\n                setUploadProgress(\"\")\r\n\r\n            }).catch(function (err) { setUploadProgress(\"\"); console.log(err) })\r\n\r\n        }, [pic])\r\n\r\n        return (\r\n            <>\r\n\r\n\r\n                <div style={{\r\n                    display: isOn ? \"flex\" : \"none\",\r\n                    flexDirection: \"column\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    // position:\"fixed\",\r\n                    // left:0,\r\n                    // top:0,\r\n                    // zIndex:10,\r\n                }}>\r\n\r\n                    <div style={{\r\n                        // marginTop:\"10px\",\r\n                        display: \"flex\", \r\n                     //   backgroundColor: \"#\" + ((1 << 24) * Math.random() | 0).toString(16),//color2,\r\n                        backgroundColor: color2,\r\n                        width: \"100%\",\r\n                        alignItems: \"flex-end\", flexDirection: \"row-reverse\", flexWrap: \"wrap\",\r\n                        justifyContent: \"space-around\",\r\n                        position: \"relative\",\r\n\r\n                        // boxShadow: `0px 0px 2px #5f5f5f,\r\n\r\n                        // 0px 0px 0px 0px #ecf0f3,\r\n\r\n                        // 8px -7px 15px #a7aaaf,\r\n\r\n                        // -8px -8px 15px #ffffff`,\r\n\r\n\r\n                    }} >\r\n                        {isOn && <Button\r\n                            style={{ display: \"block\", position: \"absolute\", top: 0, right: 0 }}\r\n                            onClick={function () { setOn(false) }}>[ X ]</Button>}\r\n\r\n\r\n\r\n\r\n                        {Object.keys(picList).map(function (item, index) {\r\n\r\n                            return (\r\n                                <ImageUnit key={item} item={item} picList={picList} insertImageBlock={insertImageBlock}\r\n                                    deleteImageBlock={deleteImageBlock} setPicList={setPicList} />\r\n                            )\r\n\r\n                        })}\r\n\r\n\r\n\r\n\r\n                        <div style={{\r\n                            textAlign: \"center\",\r\n                            width: \"100%\",\r\n                        }}>\r\n                            <input type=\"file\" style={{ display: \"none\" }} ref={inputRef}\r\n                                onClick={function (e) {\r\n                                    e.currentTarget.value = null;\r\n                                }}\r\n\r\n                                onChange={function (e) {\r\n                                    // alert((e.currentTarget.files[0].name).trim());\r\n                                    e.currentTarget.files[0].name.trim().match(/\\.(gif|jpe?g|tiff|png|webp|bmp)$/i)\r\n                                        ? setPic(e.currentTarget.files[0])\r\n                                        : setPic(null);\r\n                                }}\r\n                            />\r\n\r\n                            <Button\r\n                                style={{ marginTop: \"10px\", marginBottom: \"10px\", marginRight: \"10px\" }}\r\n                                onClick={function (e) { setPic(null); inputRef.current.click() }}\r\n                                disabled={pic ? true : false}\r\n                            >\r\n                                {uploadProgress}\r\n                            </Button>\r\n\r\n                            <Button\r\n                                id=\"button_history\"\r\n                                style={{ marginTop: \"10px\", marginBottom: \"10px\", marginLeft: \"10px\" }}\r\n                                onClick={function (e) {\r\n\r\n                                    e.target.disabled = true\r\n                                    getPictureList()\r\n                                }}\r\n                            >\r\n                                \r\n                        </Button>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n\r\n\r\n\r\n            </>\r\n\r\n        );\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    function ImageUnit({ item, picList, insertImageBlock, deleteImageBlock, setPicList, ...props }) {\r\n\r\n        const { axios, picDataList, setPicDataList } = useContext(UserContext)\r\n\r\n\r\n\r\n\r\n        const [progress, setProgress] = useState(\"\")\r\n\r\n        function downloadPicture(item, callback = function () { }) {\r\n\r\n\r\n            if (document.getElementById(`button_load_${item}`).disabled === true) {\r\n                alert(`yes, id = ${item} is in processing...`)\r\n                return\r\n            }\r\n\r\n            const imgUrl = `${url}/picture/downloadpicture/${picList[item]}`\r\n            const imgId = picList[item]\r\n\r\n\r\n\r\n\r\n            document.getElementById(`button_delete_${item}`).disabled = true\r\n            document.getElementById(`button_load_${item}`).disabled = true\r\n\r\n            if (!picDataList[picList[item]]) {\r\n\r\n                setProgress(\"0%\")\r\n                axios.get(imgUrl, {\r\n                    responseType: 'arraybuffer',\r\n                    onDownloadProgress: function (progressEvent) {\r\n\r\n                        setProgress((progressEvent.loaded * 100 / progressEvent.total).toFixed(0) + \"%\")\r\n                    },\r\n                })\r\n                    .then((response) => {\r\n\r\n\r\n\r\n                        const base64 = btoa(\r\n                            new Uint8Array(response.data).reduce(\r\n                                (data, byte) => data + String.fromCharCode(byte),\r\n                                '',\r\n                            ),\r\n                        );\r\n\r\n\r\n\r\n                        setPicDataList(\r\n                            function (pre) {\r\n                                return {\r\n                                    ...pre,\r\n                                    [imgId]: \"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64,\r\n                                }\r\n                            }\r\n                        )\r\n\r\n                        callback(imgUrl, imgId, \"data:\" + response.headers[\"content-type\"] + \";base64,\" + base64)\r\n\r\n                        document.getElementById(`button_delete_${item}`).disabled = false\r\n                        document.getElementById(`button_load_${item}`).disabled = false\r\n\r\n\r\n\r\n                    })\r\n                    .catch(err => {\r\n                        document.getElementById(`button_delete_${item}`).disabled = false\r\n                        document.getElementById(`button_load_${item}`).disabled = false\r\n\r\n                        console.log(err)\r\n                    })\r\n            }\r\n            else {\r\n\r\n                callback(imgUrl, imgId, picDataList[picList[item]])\r\n\r\n                document.getElementById(`button_delete_${item}`).disabled = false\r\n                document.getElementById(`button_load_${item}`).disabled = false\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <span key={item} style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n                    <ImgTag\r\n\r\n                        id={item}\r\n                        isIcon={true}\r\n                        style={{ display: \"block\" }}\r\n                        // style={{ width: \"100px\", height: \"auto\" }}\r\n                        onClick={function (e) {\r\n\r\n\r\n                            downloadPicture(item, insertImageBlock)\r\n                        }}\r\n                    />\r\n                    <div>\r\n                        <Button\r\n                            id={`button_delete_${item}`}\r\n                            onClick={function (e) {\r\n\r\n\r\n                                document.getElementById(`button_load_${item}`).disabled = true\r\n                                document.getElementById(`button_delete_${item}`).disabled = true\r\n\r\n\r\n                                axios.get(`${url}/picture/deleteiconpicture/${item}/${picList[item]}`)\r\n                                    .then(function () {\r\n\r\n                                        document.getElementById(`button_load_${item}`).style.display = false\r\n                                        document.getElementById(`button_delete_${item}`).style.display = false\r\n\r\n\r\n                                        const iconid = item\r\n                                        const picid = picList[item]\r\n                                        deleteImageBlock(picList[item])\r\n\r\n\r\n                                        setPicList(\r\n                                            pre => {\r\n                                                const obj = pre;\r\n                                                deleteFromObject(iconid, obj)\r\n                                                return { ...obj }\r\n                                            })\r\n                                        setPicDataList(\r\n                                            pre => {\r\n                                                const obj = pre;\r\n                                                deleteFromObject(picid, obj)\r\n                                                return { ...obj }\r\n                                            }\r\n                                        )\r\n\r\n\r\n\r\n                                    }).catch(function (err) {\r\n                                        console.log(err)\r\n                                        document.getElementById(`button_load_${item}`).disabled = false\r\n                                        document.getElementById(`button_delete_${item}`).disabled = false\r\n                                    })\r\n                            }}\r\n\r\n                        ></Button>\r\n\r\n                        <Button\r\n\r\n                            id={`button_load_${item}`}\r\n                            style={{ display: picDataList.hasOwnProperty(picList[item]) ? \"none\" : \"inline\" }}\r\n                            onClick={function (e) {\r\n\r\n                                downloadPicture(item)\r\n\r\n                            }}\r\n                        >{progress}</Button>\r\n                    </div>\r\n                </span>\r\n            </>\r\n        )\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    function deleteFromObject(keyPart, obj) {\r\n        for (var k in obj) {          // Loop through the object\r\n            if (~k.indexOf(keyPart)) { // If the current key contains the string we're looking for\r\n                delete obj[k];       // Delete obj[key];\r\n            }\r\n        }\r\n    }","import React, { useState, useRef, useEffect } from 'react';\r\n//import { EditorState, ContentBlock,KeyBindingUtil, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, SelectionState, CharacterMetadata } from 'draft-js';\r\n\r\n\r\nimport { EditorState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\n\r\n\r\n\r\nimport Immutable from 'immutable'\r\nimport Button from './Button';\r\nimport Uploader from './Uploader';\r\n\r\nfunction genKey(length = 4) {\r\n\r\n    var result = '';\r\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    var charactersLength = characters.length;\r\n    for (var i = 0; i < length; i++) {\r\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n    }\r\n    return result;\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport default function createImagePlugin() {\r\n\r\n\r\n    let externalES = null;\r\n    let externalSetEditorState = null;\r\n\r\n\r\n    function insertImageBlock(url, id, imgdata) {\r\n\r\n\r\n        const selection = externalES.getSelection();\r\n        let contentState = externalES.getCurrentContent();\r\n\r\n        const currentBlock = contentState.getBlockForKey(selection.getEndKey());\r\n        const blockMap = contentState.getBlockMap()\r\n\r\n        const blocksBefore = blockMap.toSeq().takeUntil(function (v) { return v === currentBlock })\r\n        const blocksAfter = blockMap.toSeq().skipUntil(function (v) { return v === currentBlock }).rest()\r\n\r\n\r\n        const newBlockKey = id + genKey()\r\n\r\n        const newBlockKey2 = id + genKey()\r\n\r\n\r\n\r\n\r\n        let newBlocks =\r\n            [\r\n                [currentBlock.getKey(), currentBlock],\r\n                [newBlockKey, new ContentBlock({\r\n                    key: newBlockKey,\r\n                    type: \"imageBlock\",\r\n                    text: '',\r\n                    data: Immutable.fromJS({ imgUrl: url, imgId: id, imgData: imgdata }),\r\n                })],\r\n                [newBlockKey2, new ContentBlock({\r\n                    key: newBlockKey2,\r\n                    type: \"unstyled\",\r\n                    text: '',\r\n                    //  data: Immutable.fromJS({ imgUrl: url, imgId: id, imgData: imgdata }),\r\n\r\n                })],\r\n            ];\r\n        const newBlockMap = blocksBefore.concat(newBlocks, blocksAfter).toOrderedMap()\r\n        contentState = contentState.merge({\r\n            blockMap: newBlockMap,\r\n            selectionBefore: selection,//.merge({ hasFocus: true,}),\r\n            selectionAfter: selection.merge({\r\n                anchorKey: newBlockKey2,\r\n                anchorOffset: 0,\r\n                focusKey: newBlockKey2,\r\n                focusOffset: 0,\r\n                isBackward: false,\r\n                hasFocus: true,\r\n            }),\r\n        })\r\n\r\n\r\n        externalES = EditorState.push(externalES, contentState, 'insert-fragment');\r\n        externalSetEditorState(externalES)\r\n\r\n\r\n    };\r\n\r\n    function deleteImageBlock(id) {\r\n\r\n        const selection = externalES.getSelection();\r\n        let contentState = externalES.getCurrentContent();\r\n\r\n        const blockMap = contentState.getBlockMap()\r\n        const newBlockMap = blockMap.toSeq().filter(function (block) {\r\n\r\n            if (block.getType() === \"imageBlock\" && block.getKey().indexOf(id) >= 0) {\r\n                return false\r\n            }\r\n            else if (\r\n                block.getType() === \"unstyled\"\r\n                && block.getKey().indexOf(id) >= 0\r\n                && block.getText().length === 0\r\n                && selection.getFocusKey() !== block.getKey()\r\n            ) {\r\n                return false\r\n            }\r\n            else {\r\n                return true\r\n            }\r\n\r\n\r\n\r\n        }).toOrderedMap()\r\n\r\n\r\n\r\n        contentState = contentState.merge({\r\n            blockMap: newBlockMap,\r\n            selectionBefore: selection,\r\n            selectionAfter: selection,\r\n        })\r\n\r\n\r\n        externalES = EditorState.push(externalES, contentState, 'remove-fragment');\r\n        externalSetEditorState(externalES)\r\n\r\n    }\r\n\r\n\r\n\r\n    function ImagePluginPanel() {\r\n\r\n\r\n        return (\r\n            <>\r\n                <Uploader insertImageBlock={insertImageBlock} deleteImageBlock={deleteImageBlock} />\r\n            </>\r\n\r\n        )\r\n\r\n\r\n\r\n\r\n    };\r\n\r\n\r\n    return {\r\n\r\n        ImagePluginPanel,\r\n        imagePlugin: {\r\n\r\n            onChange(editorState, { setEditorState }) {\r\n\r\n                externalES = editorState\r\n                externalSetEditorState = setEditorState\r\n\r\n                return externalES\r\n            },\r\n        }\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n\r\n\r\n","\r\nimport React, { useState, useRef, useEffect, useContext, useCallback, createContext, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { UserContext } from './contexts/UserContextProvider';\r\n\r\nimport url from \"./config\";\r\n\r\nimport Button from \"./Button\"\r\n\r\n\r\nimport { EditorState, ContentBlock, CharacterMetadata, SelectionState, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, AtomicBlockUtils } from 'draft-js';\r\nimport Editor from \"draft-js-plugins-editor\"\r\n\r\n\r\nimport { stateToHTML } from 'draft-js-export-html';\r\n\r\n\r\n\r\nimport createLinkPlugin, { linkStyleMap } from './LinkPlugin';\r\n\r\n\r\nimport createEmojiPlugin from './EmojiPlugin'\r\n\r\n\r\nimport createMentionPlugin from './MentionPlugin';\r\n\r\nimport createImagePlugin from './ImagePlugin';\r\n\r\nimport {\r\n    isMobile,\r\n    isFirefox,\r\n    isChrome,\r\n    browserName,\r\n    engineName,\r\n} from \"react-device-detect\";\r\n\r\n\r\n\r\nimport Immutable from 'immutable'\r\n\r\nconst { imagePlugin, ImagePluginPanel } = createImagePlugin()\r\nconst { emojiPlugin, insertEmoji, getEmoji, getEmojiAll, EmojiPluginPanel } = createEmojiPlugin()\r\n\r\n\r\nconst mentionPlugin = createMentionPlugin()\r\nconst linkPlugin = createLinkPlugin()\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst panelMappingObj = { EmojiPluginPanel: <EmojiPluginPanel />, ImagePluginPanel: <ImagePluginPanel /> }\r\n\r\nexport const EditorContext = createContext();\r\n\r\n\r\nexport default function DraftEditor4() {\r\n\r\n\r\n    const isComputer = !isMobile\r\n    const [showPlugin, setShowPlugin] = useState({\r\n\r\n        EmojiPluginPanel: false,\r\n        ImagePluginPanel: false,\r\n    })\r\n\r\n    function toggleShow(...props) {\r\n\r\n        setShowPlugin(function (pre) {\r\n\r\n            return {\r\n                ...pre,\r\n                [props[0]]: props.length === 1\r\n                    ? !pre[props[0]]\r\n                    : props[1]\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n\r\n    const [preHtml, setPreHtml] = useState(stateToHTML(editorState.getCurrentContent()))\r\n\r\n    const editor = useRef()\r\n    const [readOnly, setReadOnly] = useState(false)\r\n\r\n    const { fontSize2, editorWidth } = useContext(ThemeContext)\r\n    const { userName, uploadContentList, friendsList } = useContext(UserContext)\r\n    useMemo(function () { mentionPlugin.setFriendsList(friendsList) }, [friendsList])\r\n\r\n\r\n\r\n    const { width, minWidth, maxWidth } = editorWidth\r\n    const width_ = width + \"%\", minWidth_ = minWidth + \"px\", maxWidth_ = maxWidth + \"px\"\r\n\r\n    const [panelArr, setPanelArr] = useState([\r\n        { key: genKey(), panelName: \"ImagePluginPanel\" },\r\n        { key: genKey(), panelName: \"EmojiPluginPanel\" },\r\n\r\n    ])\r\n\r\n    function stateToPreHtml(es) {\r\n\r\n        const preHtml_ = stateToHTML(\r\n            es.getCurrentContent(),\r\n            {\r\n\r\n\r\n                defaultBlockTag: \"div\",\r\n\r\n                blockStyleFn: function (block) {\r\n\r\n                    //const data = block.getData().toObject()\r\n                    const type = block.getType()\r\n\r\n                    if (type === \"colorBlock\") {\r\n                        return {\r\n                            //element: \"img\", //not working redered as \"<p>\"\r\n                            attributes: {\r\n                                className: \"colorBlockClass\",\r\n                                // src: data.imgUrl,\r\n                                // aas: \"fffd\",\r\n                            },\r\n                            style: {\r\n                                color: \"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n                                // display: \"block\",\r\n                                // marginLeft: \"12px\",\r\n                                // marginRight: \"auto\",\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n\r\n                blockRenderers: {\r\n                    imageBlock: function (block) {\r\n                        const text = block.getText()\r\n                        const data = block.getData().toObject()\r\n                        const type = block.getType()\r\n\r\n                        //  return `<img src=${data.imgUrl} style=max-width:300px;display:block;margin-left:auto;margin-right:auto;/>`\r\n\r\n                        return `<div><imgtag id=${data.imgId} style=max-width:100%;display:block;margin-left:auto;margin-right:auto;/></div>`\r\n\r\n\r\n                    }\r\n                },\r\n                inlineStyles: {\r\n\r\n\r\n\r\n                    linkStyle: { style: linkStyleMap.linkStyle, },\r\n\r\n\r\n\r\n                },\r\n\r\n                entityStyleFn: function (entity) {\r\n                    const { type, data, mutablity } = entity.toObject()\r\n\r\n                    if ((type === \"EMOJI\") && (isComputer)) {\r\n\r\n                        return {\r\n                            element: \"span\",\r\n\r\n                            style: {\r\n\r\n                                backgroundColor: \"transparent\",\r\n                                backgroundRepeat: \"no-repeat\",\r\n                                backgroundPosition: \"center center\",\r\n                                backgroundSize: \"contain\",\r\n                                display: \"inline-block\",\r\n\r\n                                textAlign: \"right\",\r\n                                verticalAlign: \"middle\",\r\n\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                backgroundImage: data.url,\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                                minWidth: `${fontSize2 * 16}px`,\r\n                                //  width: `${fontSize2 * 16}px`,\r\n                                height: `${fontSize2 * 16}px`,\r\n\r\n                                //   backgroundColor:\"transparent\",\r\n\r\n                            }\r\n                        }\r\n\r\n\r\n                    }\r\n                    if ((type === \"EMOJI\") && (!isComputer)) {\r\n                        return {\r\n                            element: \"emoji_phone\",\r\n                            attributes: {\r\n                                background_image: data.url,\r\n                            },\r\n                        }\r\n\r\n\r\n\r\n                    }\r\n\r\n                    if ((type === \"linkOff\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if ((type === \"linkOn\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if (type === \"shortMentionOff\") {\r\n                        return {\r\n                            element: \"shortMentionoff\",\r\n                        }\r\n\r\n                    }\r\n\r\n                    if (type === \"longMentionOff_HEAD\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_head\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n                            style: {\r\n                                // display: \"inline\",\r\n                                // backgroundColor: \"#b7e1fc\", borderTopLeftRadius: \"1000px\", borderBottomLeftRadius: \"1000px\",\r\n                                // verticalAlign: \"middle\",\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                    if (type === \"longMentionOff_BODY\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_body\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n\r\n                        }\r\n\r\n                    }\r\n                    if (type === 'photo') {\r\n                        const data = entity.getData();\r\n                        return {\r\n                            element: 'img',\r\n                            attributes: {\r\n                                src: data.src,\r\n                            },\r\n                            style: {\r\n                                display: \"block\",\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            },\r\n\r\n                        };\r\n\r\n                    }\r\n\r\n\r\n\r\n                },\r\n\r\n            }\r\n        )\r\n        setPreHtml(preHtml_)\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    useEffect(function () {\r\n\r\n        stateToPreHtml(editorState)\r\n\r\n    }, [preHtml])\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <EditorContext.Provider value={{ showPlugin, toggleShow }}>\r\n\r\n\r\n\r\n            <div style={{\r\n                width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                margin: \"auto\",\r\n            }}>\r\n                {\r\n                    panelArr.map(function (component, index) {\r\n                        const Compo = panelMappingObj[component.panelName];\r\n\r\n                        return <div key={component.key}>{Compo}</div>\r\n                        // return <Compo key={index} />\r\n                    })}\r\n            </div>\r\n\r\n            <div style={{\r\n                width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                margin: \"auto\",\r\n            }}>\r\n\r\n                {isMobile || <Button\r\n                    onClick={function (e) {\r\n\r\n\r\n                        setPanelArr(pre => {\r\n                            let dropItem = [];\r\n                            return (\r\n                                [...pre.filter(function (item) {\r\n\r\n                                    if (item.panelName === \"EmojiPluginPanel\") {\r\n                                        dropItem.push(item)\r\n                                    }\r\n\r\n                                    return item.panelName !== \"EmojiPluginPanel\"\r\n                                }), ...dropItem]\r\n                            )\r\n\r\n                        })\r\n                        toggleShow(\"EmojiPluginPanel\")\r\n\r\n\r\n                    }}\r\n                ></Button>}\r\n                <Button\r\n                    onClick={function (e) {\r\n\r\n                        setPanelArr(pre => {\r\n                            let dropItem = [];\r\n                            return (\r\n                                [...pre.filter(function (item) {\r\n\r\n                                    if (item.panelName === \"ImagePluginPanel\") {\r\n                                        dropItem.push(item)\r\n                                    }\r\n\r\n                                    return item.panelName !== \"ImagePluginPanel\"\r\n                                }), ...dropItem]\r\n                            )\r\n\r\n                        })\r\n\r\n                        toggleShow(\"ImagePluginPanel\")\r\n                    }}\r\n\r\n                ></Button>\r\n                <Button\r\n                    onClick={function (e) {\r\n\r\n                        setEditorState(inserBotomBlock(editorState))\r\n                    }}\r\n                ></Button>\r\n\r\n\r\n            </div>\r\n\r\n\r\n            <div\r\n                style={{\r\n                    backgroundColor: \"#f9f9f9\",\r\n                    borderStyle: \"solid\",\r\n                    borderWidth: \"0px\",\r\n                    borderTopWidth: \"1px\",\r\n                    borderBottomWidth: \"1px\",\r\n                    minHeight: \"5rem\",\r\n                    fontSize: fontSize2 + \"rem\",\r\n                    width: width_,\r\n                    minWidth: minWidth_,\r\n                    maxWidth_: maxWidth_,\r\n                    margin: \"auto\",\r\n\r\n                    whiteSpace: \"pre-line\",\r\n                }}\r\n                onClick={function () {\r\n                    editor.current.focus()\r\n                }}\r\n            >\r\n                <Editor\r\n                    editorState={editorState}\r\n\r\n                    //    customStyleMap={customStyleMap} //customStyleFn={customStyleFns}      \r\n\r\n                    customStyleFn={function (item, block) {\r\n\r\n\r\n                    }}\r\n\r\n                    blockRenderMap={Immutable.Map({\r\n\r\n\r\n                        'imageBlock': {\r\n                            element: \"figure\",\r\n                        },\r\n\r\n\r\n                    })}\r\n\r\n                    blockRendererFn={function (block) {\r\n\r\n                        const text = block.getText()\r\n                        const data = block.getData().toObject()\r\n                        const type = block.getType()\r\n\r\n                        if (type === \"imageBlock\") {\r\n\r\n\r\n                            return {\r\n                                component: function (props) {\r\n\r\n                                    const { block, contentState } = props;\r\n\r\n                                    return <img\r\n\r\n                                        src={data.imgData}\r\n                                        id={data.imgId}\r\n                                        style={{\r\n\r\n                                            maxWidth: editorWidth.width * 0.3 + \"%\",\r\n                                            display: \"block\",\r\n                                            marginLeft: \"auto\",\r\n                                            marginRight: \"auto\"\r\n                                        }} />\r\n\r\n\r\n\r\n                                },\r\n                                editable: false\r\n                            }\r\n                        }\r\n\r\n                        else { return null }\r\n\r\n                    }}\r\n\r\n                    blockStyleFn={function (blockContent) {\r\n\r\n                        if (blockContent.getType() === \"unstyled\") {\r\n                            return \"UnstyledBlockClass\"\r\n                        }\r\n\r\n\r\n\r\n\r\n                    }}\r\n\r\n                    ref={function (element) { editor.current = element; }}\r\n\r\n                    plugins={[emojiPlugin, linkPlugin, mentionPlugin, imagePlugin,]}\r\n\r\n\r\n\r\n                    handleKeyCommand={function (command, editorState, evenTimeStamp, { getEditorState }) {\r\n\r\n\r\n                        const newState = RichUtils.handleKeyCommand(editorState, command);\r\n                        if (newState) {\r\n                            setEditorState(newState)\r\n                            return 'handled';\r\n                        }\r\n                        return 'not-handled';\r\n                    }}\r\n\r\n\r\n                    onChange={function (newState) {\r\n\r\n                        stateToPreHtml(newState)\r\n                        setEditorState(newState)\r\n\r\n                    }}\r\n\r\n\r\n                    readOnly={readOnly}\r\n                    stripPastedStyles={true}\r\n\r\n                    handlePastedText={function (text, html, editorState) {\r\n\r\n\r\n\r\n                    }}\r\n                />\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n            <hr />\r\n\r\n            <div style={{\r\n                fontSize: fontSize2 + \"rem\",\r\n\r\n                margin: \"auto\",\r\n                width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                //  backgroundColor: \"lightgreen\",\r\n                wordBreak: \"break-all\",\r\n                whiteSpace: \"pre-wrap\",\r\n                // whiteSpace: \"break-spaces\",\r\n            }}>\r\n                <Button onClick={\r\n                    function (e) {\r\n                        e.persist()\r\n                        e.target.disabled = true\r\n\r\n                        setReadOnly(true)\r\n                        uploadContentList(preHtml)\r\n                            .then(function () {\r\n\r\n                                setEditorState(EditorState.createEmpty())\r\n                                e.target.disabled = false;\r\n                                setReadOnly(false)\r\n                            })\r\n                            .catch(e => {\r\n                                e.target.disabled = false;\r\n                                setReadOnly(false)\r\n\r\n                            })\r\n\r\n                    }\r\n\r\n                }></Button>\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n\r\n\r\n\r\n        </EditorContext.Provider>\r\n    )\r\n\r\n\r\n}\r\n\r\n\r\nexport function CommentEditor({ articleId, setCommentObj, setContentList, ...props }) {\r\n\r\n\r\n\r\n    const isComputer = !isMobile\r\n    const [showPlugin, setShowPlugin] = useState({\r\n\r\n        EmojiPluginPanel: false,\r\n        ImagePluginPanel: false,\r\n    })\r\n\r\n    function toggleShow(...props) {\r\n\r\n        setShowPlugin(function (pre) {\r\n\r\n            return {\r\n                ...pre,\r\n                [props[0]]: props.length === 1\r\n                    ? !pre[props[0]]\r\n                    : props[1]\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n\r\n    const [preHtml, setPreHtml] = useState(stateToHTML(editorState.getCurrentContent()))\r\n\r\n    const editor = useRef()\r\n    const [readOnly, setReadOnly] = useState(false)\r\n\r\n    const { fontSize2, editorWidth } = useContext(ThemeContext)\r\n    const { userName, uploadContentList, friendsList, axios } = useContext(UserContext)\r\n    useMemo(function () { mentionPlugin.setFriendsList(friendsList) }, [friendsList])\r\n\r\n\r\n\r\n    const { width, minWidth, maxWidth } = editorWidth\r\n    const width_ = width + \"%\", minWidth_ = minWidth + \"px\", maxWidth_ = maxWidth + \"px\"\r\n\r\n    const [panelArr, setPanelArr] = useState([\r\n        { key: genKey(), panelName: \"ImagePluginPanel\" },\r\n        { key: genKey(), panelName: \"EmojiPluginPanel\" },\r\n\r\n    ])\r\n\r\n    function stateToPreHtml(es) {\r\n\r\n        const preHtml_ = stateToHTML(\r\n            es.getCurrentContent(),\r\n            {\r\n\r\n\r\n                defaultBlockTag: \"div\",\r\n\r\n\r\n\r\n\r\n                entityStyleFn: function (entity) {\r\n                    const { type, data, mutablity } = entity.toObject()\r\n\r\n                    if ((type === \"EMOJI\") && (isComputer)) {\r\n\r\n                        return {\r\n                            element: \"span\",\r\n\r\n                            style: {\r\n\r\n                                backgroundColor: \"transparent\",\r\n                                backgroundRepeat: \"no-repeat\",\r\n                                backgroundPosition: \"center center\",\r\n                                backgroundSize: \"contain\",\r\n                                display: \"inline-block\",\r\n\r\n                                textAlign: \"right\",\r\n                                verticalAlign: \"middle\",\r\n\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                backgroundImage: data.url,\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                                minWidth: `${fontSize2 * 16}px`,\r\n                                //  width: `${fontSize2 * 16}px`,\r\n                                height: `${fontSize2 * 16}px`,\r\n\r\n                                //   backgroundColor:\"transparent\",\r\n\r\n                            }\r\n                        }\r\n\r\n\r\n                    }\r\n                    if ((type === \"EMOJI\") && (!isComputer)) {\r\n                        return {\r\n                            element: \"emoji_phone\",\r\n                            attributes: {\r\n                                background_image: data.url,\r\n                            },\r\n                        }\r\n\r\n\r\n\r\n                    }\r\n\r\n                    if ((type === \"linkOff\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if ((type === \"linkOn\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if (type === \"shortMentionOff\") {\r\n                        return {\r\n                            element: \"shortMentionoff\",\r\n                        }\r\n\r\n                    }\r\n\r\n                    if (type === \"longMentionOff_HEAD\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_head\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n                            style: {\r\n                                // display: \"inline\",\r\n                                // backgroundColor: \"#b7e1fc\", borderTopLeftRadius: \"1000px\", borderBottomLeftRadius: \"1000px\",\r\n                                // verticalAlign: \"middle\",\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                    if (type === \"longMentionOff_BODY\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_body\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n\r\n                        }\r\n\r\n                    }\r\n                    if (type === 'photo') {\r\n                        const data = entity.getData();\r\n                        return {\r\n                            element: 'img',\r\n                            attributes: {\r\n                                src: data.src,\r\n                            },\r\n                            style: {\r\n                                display: \"block\",\r\n                                marginLeft: \"auto\",\r\n                                marginRight: \"auto\",\r\n                            },\r\n\r\n                        };\r\n\r\n                    }\r\n\r\n\r\n\r\n                },\r\n\r\n            }\r\n        )\r\n        setPreHtml(preHtml_)\r\n    }\r\n\r\n\r\n    useEffect(function () {\r\n\r\n        stateToPreHtml(editorState)\r\n\r\n    }, [preHtml])\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <EditorContext.Provider value={{ showPlugin, toggleShow }}>\r\n\r\n\r\n\r\n            <div style={{\r\n                width: \"100%\",\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                margin: \"auto\",\r\n                paddingLeft: \"5%\", paddingRight: \"5%\",\r\n            }}>\r\n                {\r\n                    panelArr.map(function (component, index) {\r\n                        const Compo = panelMappingObj[component.panelName];\r\n\r\n                        return <div key={component.key}>{Compo}</div>\r\n                        // return <Compo key={index} />\r\n                    })}\r\n            </div>\r\n\r\n            <div style={{\r\n                width: width_,\r\n\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                //  margin: \"auto\",\r\n            }}>\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n            <div\r\n                style={{\r\n                    backgroundColor: \"#f9f9f9\",\r\n                    borderStyle: \"solid\",\r\n                    borderWidth: \"0px\",\r\n                    borderTopWidth: \"1px\",\r\n                    borderBottomWidth: \"1px\",\r\n\r\n                    fontSize: fontSize2 + \"rem\",\r\n                    // width: width_,\r\n                    // minWidth: minWidth_,\r\n                    // maxWidth_: maxWidth_,\r\n                    width: \"90%\",\r\n                    margin: \"auto\",\r\n\r\n                    whiteSpace: \"pre-line\",\r\n                }}\r\n                onClick={function () {\r\n                    editor.current.focus()\r\n                }}\r\n            >\r\n                <Editor\r\n                    editorState={editorState}\r\n\r\n                    blockStyleFn={function (blockContent) {\r\n\r\n                        if (blockContent.getType() === \"unstyled\") {\r\n                            return \"UnstyledBlockClass\"\r\n                        }\r\n\r\n                    }}\r\n\r\n                    ref={function (element) { editor.current = element; }}\r\n\r\n                    plugins={[emojiPlugin, linkPlugin, mentionPlugin, imagePlugin,]}\r\n\r\n\r\n\r\n                    handleKeyCommand={function (command, editorState, evenTimeStamp, { getEditorState }) {\r\n\r\n\r\n                        const newState = RichUtils.handleKeyCommand(editorState, command);\r\n                        if (newState) {\r\n                            setEditorState(newState)\r\n                            return 'handled';\r\n                        }\r\n                        return 'not-handled';\r\n                    }}\r\n\r\n\r\n                    onChange={function (newState) {\r\n\r\n                        stateToPreHtml(newState)\r\n                        setEditorState(newState)\r\n\r\n                    }}\r\n\r\n\r\n                    readOnly={readOnly}\r\n                    stripPastedStyles={true}\r\n\r\n                    handlePastedText={function (text, html, editorState) { }}\r\n\r\n\r\n\r\n\r\n                />\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n            {/* <hr /> */}\r\n\r\n            <div style={{\r\n                fontSize: fontSize2 + \"rem\",\r\n\r\n                margin: \"auto\",\r\n                //    width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                //  backgroundColor: \"lightgreen\",\r\n                wordBreak: \"break-all\",\r\n                whiteSpace: \"pre-wrap\",\r\n                paddingLeft: \"5%\", paddingRight: \"5%\",\r\n                // whiteSpace: \"break-spaces\",\r\n            }}>\r\n\r\n                {isMobile || <Button\r\n                    onClick={function (e) {\r\n\r\n\r\n                        setPanelArr(pre => {\r\n                            let dropItem = [];\r\n                            return (\r\n                                [...pre.filter(function (item) {\r\n\r\n                                    if (item.panelName === \"EmojiPluginPanel\") {\r\n                                        dropItem.push(item)\r\n                                    }\r\n\r\n                                    return item.panelName !== \"EmojiPluginPanel\"\r\n                                }), ...dropItem]\r\n                            )\r\n\r\n                        })\r\n                        toggleShow(\"EmojiPluginPanel\")\r\n\r\n\r\n                    }}\r\n                ></Button>}\r\n\r\n\r\n\r\n                <Button onClick={\r\n                    function (e) {\r\n                        e.persist()\r\n                        e.target.disabled = true\r\n\r\n                        setReadOnly(true)\r\n\r\n                        return userName && axios.post(`${url}/comment`, {\r\n                            articleId: articleId,\r\n                            ownerName: userName,\r\n                            content: preHtml,\r\n                        }).then(function (response) {\r\n                            setEditorState(EditorState.createEmpty())\r\n                            e.target.disabled = false;\r\n                            setReadOnly(false)\r\n\r\n                            setCommentObj(pre => {\r\n\r\n                                const poster = response.data\r\n                                pre[poster.articleId].push(response.data)\r\n\r\n                                pre[poster.articleId] = pre[poster.articleId].sort(function (item1, item2) {\r\n                                    if (item1._id > item2._id) { return -1 }\r\n                                    else if (item1._id < item2._id) { return 1 }\r\n                                    else { return 0 }\r\n                                })\r\n\r\n                                return { ...pre }\r\n                            })\r\n                            return response\r\n                        }).then(function () {\r\n\r\n                            setContentList(pre => {\r\n\r\n                                const arr = pre.map(function (content) {\r\n                                    if (content._id !== articleId) {\r\n                                        return content\r\n                                    }\r\n                                    else {\r\n                                        content.commentNum++\r\n                                        return content\r\n                                    }\r\n                                })\r\n                                return arr\r\n                            })\r\n\r\n                        })\r\n                        // .catch(e => {\r\n                        //     e.target.disabled = false;\r\n                        //     setReadOnly(false)\r\n\r\n                        // })\r\n\r\n                    }\r\n\r\n                }></Button>\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n\r\n\r\n\r\n        </EditorContext.Provider>\r\n    )\r\n\r\n\r\n}\r\n\r\n\r\nexport function SubCommentEditor({ commentId, setSubCommentObj, ...props }) {\r\n\r\n    const isComputer = !isMobile\r\n    const [showPlugin, setShowPlugin] = useState({\r\n\r\n        EmojiPluginPanel: false,\r\n        ImagePluginPanel: false,\r\n    })\r\n\r\n    function toggleShow(...props) {\r\n\r\n        setShowPlugin(function (pre) {\r\n\r\n            return {\r\n                ...pre,\r\n                [props[0]]: props.length === 1\r\n                    ? !pre[props[0]]\r\n                    : props[1]\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n\r\n    const [preHtml, setPreHtml] = useState(stateToHTML(editorState.getCurrentContent()))\r\n\r\n    const editor = useRef()\r\n    const [readOnly, setReadOnly] = useState(false)\r\n\r\n    const { fontSize2, editorWidth } = useContext(ThemeContext)\r\n    const { userName, uploadContentList, friendsList, axios } = useContext(UserContext)\r\n    useMemo(function () { mentionPlugin.setFriendsList(friendsList) }, [friendsList])\r\n\r\n\r\n\r\n    const { width, minWidth, maxWidth } = editorWidth\r\n    const width_ = width + \"%\", minWidth_ = minWidth + \"px\", maxWidth_ = maxWidth + \"px\"\r\n\r\n    const [panelArr, setPanelArr] = useState([\r\n        { key: genKey(), panelName: \"ImagePluginPanel\" },\r\n        { key: genKey(), panelName: \"EmojiPluginPanel\" },\r\n\r\n    ])\r\n\r\n    function stateToPreHtml(es) {\r\n\r\n        const preHtml_ = stateToHTML(\r\n            es.getCurrentContent(),\r\n            {\r\n\r\n\r\n                defaultBlockTag: \"div\",\r\n\r\n\r\n\r\n\r\n                entityStyleFn: function (entity) {\r\n                    const { type, data, mutablity } = entity.toObject()\r\n\r\n                    if ((type === \"EMOJI\") && (isComputer)) {\r\n\r\n                        return {\r\n                            element: \"span\",\r\n\r\n                            style: {\r\n\r\n                                backgroundColor: \"transparent\",\r\n                                backgroundRepeat: \"no-repeat\",\r\n                                backgroundPosition: \"center center\",\r\n                                backgroundSize: \"contain\",\r\n                                display: \"inline-block\",\r\n\r\n                                textAlign: \"right\",\r\n                                verticalAlign: \"middle\",\r\n\r\n                                color: \"rgba(0,0,0,0)\",\r\n                                backgroundImage: data.url,\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                                minWidth: `${fontSize2 * 16}px`,\r\n                                //  width: `${fontSize2 * 16}px`,\r\n                                height: `${fontSize2 * 16}px`,\r\n\r\n                                //   backgroundColor:\"transparent\",\r\n\r\n                            }\r\n                        }\r\n\r\n\r\n                    }\r\n                    if ((type === \"EMOJI\") && (!isComputer)) {\r\n                        return {\r\n                            element: \"emoji_phone\",\r\n                            attributes: {\r\n                                background_image: data.url,\r\n                            },\r\n                        }\r\n\r\n\r\n\r\n                    }\r\n\r\n                    if ((type === \"linkOff\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if ((type === \"linkOn\")) {\r\n\r\n                        return {\r\n                            element: \"mylink\",\r\n                            attributes: {\r\n                                host: data.linkHost,\r\n                                address: data.linkAddress,\r\n                            },\r\n                            style: { display: \"hidden\" }\r\n                        }\r\n\r\n                    }\r\n                    if (type === \"shortMentionOff\") {\r\n                        return {\r\n                            element: \"shortMentionoff\",\r\n                        }\r\n\r\n                    }\r\n\r\n                    if (type === \"longMentionOff_HEAD\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_head\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n                            style: {\r\n                                // display: \"inline\",\r\n                                // backgroundColor: \"#b7e1fc\", borderTopLeftRadius: \"1000px\", borderBottomLeftRadius: \"1000px\",\r\n                                // verticalAlign: \"middle\",\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                    if (type === \"longMentionOff_BODY\") {\r\n\r\n                        return {\r\n\r\n                            element: \"longmentionoff_body\",\r\n                            attributes: {\r\n                                imgurl: data.imgurl,\r\n                                person: data.person,\r\n                            },\r\n\r\n                        }\r\n\r\n                    }\r\n\r\n\r\n\r\n\r\n                },\r\n\r\n            }\r\n        )\r\n        setPreHtml(preHtml_)\r\n    }\r\n\r\n\r\n    useEffect(function () {\r\n\r\n        stateToPreHtml(editorState)\r\n\r\n    }, [preHtml])\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <EditorContext.Provider value={{ showPlugin, toggleShow }}>\r\n\r\n\r\n\r\n            <div style={{\r\n                width: \"100%\",\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                margin: \"auto\",\r\n                paddingLeft: \"5%\", paddingRight: \"5%\",\r\n            }}>\r\n                {\r\n                    panelArr.map(function (component, index) {\r\n                        const Compo = panelMappingObj[component.panelName];\r\n\r\n                        return <div key={component.key}>{Compo}</div>\r\n                        // return <Compo key={index} />\r\n                    })}\r\n            </div>\r\n\r\n            <div style={{\r\n                width: width_,\r\n\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                //  margin: \"auto\",\r\n            }}>\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n            <div\r\n                style={{\r\n                    backgroundColor: \"#f9f9f9\",\r\n                    borderStyle: \"solid\",\r\n                    borderWidth: \"0px\",\r\n                    borderTopWidth: \"1px\",\r\n                    borderBottomWidth: \"1px\",\r\n\r\n                    fontSize: fontSize2 + \"rem\",\r\n                    // width: width_,\r\n                    // minWidth: minWidth_,\r\n                    // maxWidth_: maxWidth_,\r\n                    width: \"90%\",\r\n                    margin: \"auto\",\r\n\r\n                    whiteSpace: \"pre-line\",\r\n                }}\r\n                onClick={function () {\r\n                    editor.current.focus()\r\n                }}\r\n            >\r\n                <Editor\r\n                    editorState={editorState}\r\n\r\n                    blockStyleFn={function (blockContent) {\r\n\r\n                        if (blockContent.getType() === \"unstyled\") {\r\n                            return \"UnstyledBlockClass\"\r\n                        }\r\n\r\n                    }}\r\n\r\n                    ref={function (element) { editor.current = element; }}\r\n\r\n                    plugins={[emojiPlugin, linkPlugin, mentionPlugin, imagePlugin,]}\r\n\r\n\r\n\r\n                    handleKeyCommand={function (command, editorState, evenTimeStamp, { getEditorState }) {\r\n\r\n\r\n                        const newState = RichUtils.handleKeyCommand(editorState, command);\r\n                        if (newState) {\r\n                            setEditorState(newState)\r\n                            return 'handled';\r\n                        }\r\n                        return 'not-handled';\r\n                    }}\r\n\r\n\r\n                    onChange={function (newState) {\r\n\r\n                        stateToPreHtml(newState)\r\n                        setEditorState(newState)\r\n\r\n                    }}\r\n\r\n\r\n                    readOnly={readOnly}\r\n                    stripPastedStyles={true}\r\n\r\n                    handlePastedText={function (text, html, editorState) { }}\r\n\r\n\r\n\r\n\r\n                />\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n            {/* <hr /> */}\r\n\r\n            <div style={{\r\n                fontSize: fontSize2 + \"rem\",\r\n\r\n                margin: \"auto\",\r\n                //    width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n                //  backgroundColor: \"lightgreen\",\r\n                wordBreak: \"break-all\",\r\n                whiteSpace: \"pre-wrap\",\r\n                paddingLeft: \"5%\", paddingRight: \"5%\",\r\n                // whiteSpace: \"break-spaces\",\r\n            }}>\r\n\r\n                {isMobile || <Button\r\n                    onClick={function (e) {\r\n\r\n\r\n                        setPanelArr(pre => {\r\n                            let dropItem = [];\r\n                            return (\r\n                                [...pre.filter(function (item) {\r\n\r\n                                    if (item.panelName === \"EmojiPluginPanel\") {\r\n                                        dropItem.push(item)\r\n                                    }\r\n\r\n                                    return item.panelName !== \"EmojiPluginPanel\"\r\n                                }), ...dropItem]\r\n                            )\r\n\r\n                        })\r\n                        toggleShow(\"EmojiPluginPanel\")\r\n\r\n\r\n                    }}\r\n                ></Button>}\r\n\r\n\r\n\r\n                <Button onClick={\r\n                    function (e) {\r\n                        e.persist()\r\n                        e.target.disabled = true\r\n\r\n                        setReadOnly(true)\r\n\r\n                        return userName && axios.post(`${url}/subcomment`, {\r\n                            commentId: commentId,\r\n                            ownerName: userName,\r\n                            content: preHtml,\r\n                        }).then(function (response) {\r\n                            setEditorState(EditorState.createEmpty())\r\n                            e.target.disabled = false;\r\n                            setReadOnly(false)\r\n\r\n                            setSubCommentObj(pre => {\r\n\r\n                                const poster = response.data\r\n                                if (!Array.isArray(pre[commentId])) {\r\n                                    pre[commentId] = []\r\n                                }\r\n\r\n                                pre[commentId].push(poster)\r\n                                pre[commentId] = pre[commentId].sort(function (item1, item2) {\r\n                                    if (item1._id > item2._id) { return -1 }\r\n                                    else if (item1._id < item2._id) { return 1 }\r\n                                    else { return 0 }\r\n                                })\r\n\r\n                                return { ...pre }\r\n                            })\r\n                            return response\r\n                        })\r\n\r\n                    }\r\n\r\n                }></Button>\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n\r\n\r\n\r\n\r\n        </EditorContext.Provider>\r\n    )\r\n}\r\n\r\n\r\n\r\n\r\nfunction inserBotomBlock(editorState, typeName = \"unstyled\", text = \"\") {\r\n\r\n    const blockMap = editorState.getCurrentContent().getBlockMap().toSeq()\r\n\r\n    // const lastBlock = blockMap.last()\r\n    console.log([...blockMap])\r\n\r\n    // const blocksBefore = blockMap.takeUntil(function (v) {\r\n    //     return v === lastBlock.getKey()\r\n    // })\r\n\r\n\r\n    const blockKey = genKey()\r\n\r\n    const newBlocks = [\r\n        //      [lastBlock.getKey(), lastBlock],\r\n\r\n        [blockKey, new ContentBlock({\r\n            key: blockKey,\r\n            type: typeName,\r\n            text: text,\r\n        })]\r\n    ]\r\n\r\n    const newBlockMap = blockMap.concat(newBlocks).toOrderedMap()\r\n\r\n\r\n    let newContentState = editorState.getCurrentContent().merge({\r\n        blockMap: newBlockMap,\r\n        selectionBefore: editorState.getSelection(),\r\n        selectionAfter: editorState.getSelection().merge({\r\n            anchorKey: blockKey,\r\n            anchorOffset: 0,\r\n            focusKey: blockKey,\r\n            focusOffset: 0,\r\n            isBackward: false,\r\n            hasFocus: true,\r\n        }),\r\n    })\r\n\r\n    return EditorState.push(editorState, newContentState, 'insert-fragment');\r\n\r\n\r\n}\r\n\r\n\r\nfunction genKey(length = 4) {\r\n\r\n    var result = '';\r\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    var charactersLength = characters.length;\r\n    for (var i = 0; i < length; i++) {\r\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n    }\r\n    return result;\r\n}\r\n\r\n\r\n\r\n","\r\nimport React, { useContext, useState, useRef, useEffect } from 'react';\r\nimport { EditorState, KeyBindingUtil, convertToRaw, convertFromRaw, RichUtils, Modifier, convertFromHTML, SelectionState, CharacterMetadata } from 'draft-js';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n//import { EditorContext } from './EditorContextProvider';\r\nimport { EditorContext } from './DraftEditor4';\r\nimport Button from './Button';\r\n\r\nimport {\r\n    isMobile,\r\n    isChrome,\r\n    isFirefox,\r\n} from \"react-device-detect\";\r\n\r\n\r\n\r\nimport url from './config';\r\n\r\nimport { useMediaQuery } from 'react-responsive';\r\n\r\n\r\nfunction genKey(length = 4) {\r\n\r\n    var result = '';\r\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    var charactersLength = characters.length;\r\n    for (var i = 0; i < length; i++) {\r\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n    }\r\n    return result;\r\n}\r\n\r\n\r\n\r\n\r\nexport default function createEmojiPlugin() {\r\n\r\n    let externalES = null;\r\n    let externalSetEditorState = null;\r\n\r\n    let emojiArr = [\r\n\r\n\r\n        '\\u2620',\r\n        '\\u2764',\r\n        '\\uD83D\\uDC69\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC8B\\u200D\\uD83D\\uDC69',\r\n        '\\uD83D\\uDC7F',\r\n        '\\uD83D\\uDC80',\r\n        '\\uD83D\\uDCA9',\r\n        '\\uD83D\\uDE01',\r\n        '\\uD83D\\uDE02',\r\n        '\\uD83D\\uDE03',\r\n        '\\uD83D\\uDE04',\r\n        '\\uD83D\\uDE05',\r\n        '\\uD83D\\uDE06',\r\n        '\\uD83D\\uDE07',\r\n        '\\uD83D\\uDE08',\r\n        '\\uD83D\\uDE09',\r\n        '\\uD83D\\uDE0A',\r\n        '\\uD83D\\uDE0B',\r\n        '\\uD83D\\uDE0C',\r\n        '\\uD83D\\uDE0D',\r\n        '\\uD83D\\uDE0E',\r\n        '\\uD83D\\uDE0F',\r\n        '\\uD83D\\uDE10',\r\n        '\\uD83D\\uDE12',\r\n        '\\uD83D\\uDE13',\r\n        '\\uD83D\\uDE14',\r\n        '\\uD83D\\uDE16',\r\n        '\\uD83D\\uDE18',\r\n        '\\uD83D\\uDE1A',\r\n        '\\uD83D\\uDE1C',\r\n        '\\uD83D\\uDE1D',\r\n        '\\uD83D\\uDE1E',\r\n        '\\uD83D\\uDE20',\r\n        '\\uD83D\\uDE21',\r\n        '\\uD83D\\uDE22',\r\n        '\\uD83D\\uDE23',\r\n        '\\uD83D\\uDE24',\r\n        '\\uD83D\\uDE25',\r\n        '\\uD83D\\uDE28',\r\n        '\\uD83D\\uDE29',\r\n        '\\uD83D\\uDE2A',\r\n        '\\uD83D\\uDE2B',\r\n        '\\uD83D\\uDE2D',\r\n        '\\uD83D\\uDE30',\r\n        '\\uD83D\\uDE31',\r\n        '\\uD83D\\uDE32',\r\n        '\\uD83D\\uDE33',\r\n        '\\uD83D\\uDE35',\r\n        '\\uD83D\\uDE36',\r\n        '\\uD83D\\uDE37',\r\n        '\\uD83D\\uDE47\\u200D\\u2640\\uFE0F',\r\n        '\\uD83E\\uDD24',\r\n        '\\uD83E\\uDD71'\r\n    ]\r\n\r\n    const emojiUrl = `url(${url}/emoji/downloademoji/`\r\n    let emoji = {}\r\n\r\n    emojiArr.forEach(icon => {\r\n\r\n        emoji[icon] = emojiUrl + icon + \".png\"\r\n    })\r\n\r\n\r\n\r\n    function findWithRegex(regex, contentBlock, callback) {\r\n        const text = contentBlock.getText();\r\n        let matchArr, start;\r\n        while ((matchArr = regex.exec(text)) !== null) {\r\n            start = matchArr.index;\r\n            callback(start, start + matchArr[0].length);\r\n        }\r\n    }\r\n\r\n    function emojiStrategy(contentBlock, callback, contentState) {\r\n\r\n        //findWithRegex(//g, contentBlock, callback)\r\n\r\n        // Object.keys(emoji).forEach(function (key) {\r\n        //     const regx = new RegExp(`${key}`, \"g\")\r\n        //     findWithRegex(regx, contentBlock, callback)\r\n        // })\r\n\r\n        contentBlock.findEntityRanges(\r\n            function (character) {\r\n                const entityKey = character.getEntity();\r\n                return (\r\n                    entityKey !== null &&\r\n                    contentState.getEntity(entityKey).getType() === \"EMOJI\"\r\n\r\n                );\r\n            },\r\n            callback\r\n        );\r\n    };\r\n\r\n  \r\n    function Emoji(props) {\r\n        const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText } = props;\r\n  \r\n        const { fontSize2 } = useContext(ThemeContext)\r\n        const isComputer = !useMediaQuery({ query: '(hover: none)' });\r\n\r\n        const iconRef = useRef()\r\n\r\n\r\n    \r\n\r\n        if (isComputer) {\r\n            return (\r\n                <>\r\n                    <span\r\n\r\n                        ref={iconRef}\r\n                        className=\"emoji\"\r\n                        style={{\r\n                        \r\n\r\n                            backgroundRepeat: \"no-repeat\",\r\n                   \r\n                            backgroundPosition: \"center center\",\r\n                            backgroundSize: \"contain\",\r\n                            display: \"inline-block\",\r\n                         \r\n                            textAlign: \"right\",\r\n                            verticalAlign: \"middle\",\r\n\r\n\r\n                            backgroundImage: isFirefox ? null : emoji[decoratedText],\r\n\r\n                            height: fontSize2 * 16 + \"px\",\r\n                            minWidth: fontSize2 * 16 + \"px\",\r\n                            lineHeight: fontSize2 + \"rem\",\r\n              \r\n                        }}\r\n                    >\r\n                        <span style={{\r\n                            clipPath: isFirefox ? null : \"circle(0% at 50% 50%)\",\r\n                        }}>\r\n                            {props.children}\r\n\r\n                        </span>\r\n                    </span>\r\n\r\n                </>\r\n\r\n            );\r\n        }\r\n        else {\r\n            return (\r\n\r\n                <span className=\"emoji_phone\" >\r\n                    {props.children}\r\n                </span>\r\n            )\r\n\r\n        }\r\n    };\r\n\r\n    function taggingEmoji() {\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n            = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n        const oldSelection = externalES.getSelection();\r\n        let newContent = externalES.getCurrentContent();\r\n        let newSelection = externalES.getSelection();\r\n\r\n\r\n\r\n\r\n        externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\r\n            const blockKey = block.getKey();\r\n            const blockType = block.getType();\r\n            const blockText = block.getText();\r\n\r\n\r\n            const metaArr = block.getCharacterList();\r\n            metaArr.forEach(function (item, index) {\r\n\r\n                if (item.getEntity()) {\r\n                    const entityType = newContent.getEntity(item.getEntity()).getType()\r\n                    if (entityType === \"EMOJI\") {\r\n\r\n                        newSelection = externalES.getSelection().merge({\r\n                            anchorKey: blockKey,\r\n                            anchorOffset: index,\r\n                            focusKey: blockKey,\r\n                            focusOffset: index + 1,\r\n                            isBackward: false,\r\n                            hasFocus: false,\r\n                        })\r\n                        newContent = Modifier.applyEntity(newContent, newSelection, null)\r\n                    }\r\n                }\r\n            })\r\n\r\n\r\n\r\n\r\n\r\n\r\n            Object.keys(emoji).forEach(function (emojiKey) {\r\n\r\n                const regx = new RegExp(`${emojiKey}`, \"g\")\r\n                // const array = [...blockText.matchAll(regx)].map(a => a.index);\r\n                const array = []\r\n                let matchArr;\r\n                while ((matchArr = regx.exec(blockText)) !== null) {\r\n\r\n                    const start = matchArr.index;\r\n                    const end = matchArr.index + matchArr[0].length;\r\n\r\n                    array.push(start)\r\n                }\r\n\r\n\r\n                array.forEach(function (offset) {\r\n\r\n                    newContent = newContent.createEntity(\"EMOJI\", \"IMMUTABLE\", { url: emoji[emojiKey] });\r\n                    const entityKey = newContent.getLastCreatedEntityKey();\r\n\r\n                    newSelection = externalES.getSelection().merge({\r\n                        anchorKey: blockKey,\r\n                        anchorOffset: offset,\r\n                        focusKey: blockKey,\r\n                        focusOffset: offset + emojiKey.length,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n\r\n                    })\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n\r\n                })\r\n\r\n            })\r\n\r\n        })\r\n        externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n        externalES = EditorState.acceptSelection(externalES, oldSelection);\r\n        return externalES\r\n    }\r\n\r\n    function insertEmoji(text) {\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n            = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n        let newContent = Modifier.replaceText(\r\n            externalES.getCurrentContent(),\r\n            externalES.getSelection(),\r\n            text,\r\n        )\r\n\r\n        let newSelection = externalES.getSelection().merge({\r\n\r\n            anchorKey: anchorStartKey,\r\n            anchorOffset: anchorStartOffset + text.length,\r\n            focusKey: anchorStartKey,\r\n            focusOffset: anchorStartOffset + text.length,\r\n            isBackward: false,\r\n            hasFocus: true,\r\n        })\r\n\r\n        externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n        externalES = EditorState.acceptSelection(externalES, newSelection)\r\n\r\n        externalSetEditorState(externalES)\r\n    }\r\n\r\n    function getEmoji(index) {\r\n        return Object.keys(emoji)[index % Object.keys(emoji).length]\r\n    }\r\n\r\n    function getEmojiAll() {\r\n\r\n        let icons = \"\";\r\n        Object.keys(emoji).forEach(function (icon) {\r\n            icons = icons + icon\r\n        })\r\n        return icons\r\n    }\r\n\r\n    function EmojiPluginPanel() {\r\n\r\n\r\n        const { showPlugin, toggleShow } = useContext(EditorContext)\r\n        const { fontSize1, fontSize2,color2 } = useContext(ThemeContext)\r\n\r\n        const isOn = showPlugin[\"EmojiPluginPanel\"]\r\n      \r\n\r\n        return (\r\n            <>\r\n                <div style={{\r\n                    display: isOn ? \"block\" : \"none\",\r\n                    //   backgroundColor: \"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n                    backgroundColor: color2,\r\n\r\n                    width: \"100%\",\r\n                }}>\r\n                    <button style={{float:\"right\",fontSize:fontSize1+\"rem\"}}\r\n                    \r\n                    onClick={function(e){\r\n                        toggleShow(\"EmojiPluginPanel\",false)\r\n                    }}\r\n                    >[ X ]</button>\r\n                       \r\n                \r\n\r\n\r\n                    {\r\n                        Object.keys(emoji).map(function (icon, index) {\r\n                            return (\r\n\r\n                                <button\r\n                                    key={index}\r\n                                  \r\n                                    onMouseEnter={\r\n                                        function (e) {\r\n                                            e.target.style.backgroundColor =\"lightgray\"\r\n                                        }\r\n                                    }\r\n                                    onMouseOut={\r\n                                        function (e) {\r\n                                            e.target.style.backgroundColor = null\r\n                                        }\r\n                                    }\r\n                                   onClick={\r\n                                       function(e){\r\n                                          // alert(\"dsd\")\r\n                                           insertEmoji(icon)\r\n                                       }\r\n                                   }\r\n\r\n                                    style={{\r\n                                        color: \"rgba(0,0,0,0)\",\r\n                                        borderWidth: \"1px\",\r\n                                        backgroundImage: emoji[icon],\r\n                                        backgroundRepeat: \"no-repeat\",\r\n\r\n                                        backgroundPosition: \"center center\",\r\n                                        backgroundSize: \"contain\",\r\n                                        fontSize: fontSize1 + \"rem\",\r\n\r\n                                        minWidth: fontSize1 * 16 * 1.2 + \"px\",\r\n                                    }}\r\n\r\n\r\n                                >{icon}</button>\r\n                            )\r\n\r\n                        })\r\n                    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                </div>\r\n\r\n            </>\r\n        )\r\n    }\r\n\r\n\r\n\r\n    return {\r\n\r\n        emojiPlugin: {\r\n            keyBindingFn(e, { getEditorState }) {\r\n                if (e.ctrlKey && e.shiftKey && e.keyCode === 76) {\r\n                    return \"add-emoji\";\r\n                }\r\n            },\r\n\r\n            handleKeyCommand(command, editorState, /*{ getEditorState, setEditorState2 }*/) {\r\n\r\n                if (command !== \"add-emoji\") { return \"un-handled\" }\r\n\r\n                if (command === \"add-emoji\") {\r\n                    insertEmoji(getEmoji(0) + \" @tomK\" + getEmoji(1));\r\n                    return \"emoji-adding-handled\";\r\n                }\r\n            },\r\n\r\n            onChange(editorState, { setEditorState }) {\r\n\r\n                externalES = editorState\r\n                externalSetEditorState = setEditorState\r\n                externalES = taggingEmoji()\r\n\r\n                return externalES\r\n            },\r\n\r\n            decorators: [\r\n                {\r\n                    strategy: emojiStrategy,\r\n                    component: Emoji\r\n                }\r\n            ],\r\n\r\n        },\r\n\r\n        EmojiPluginPanel,\r\n        insertEmoji,\r\n        getEmoji,\r\n        getEmojiAll,\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n","import React, { useState, useEffect, useContext, useRef } from \"react\";\r\nimport { RichUtils, Modifier, KeyBindingUtil, EditorState, CompositeDecorator } from \"draft-js\";\r\n\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport Avartar, { AvartarSmall } from \"./Avatar\";\r\nimport Avartar2, { Avatar4 } from \"./Avatar2\";\r\n\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\nimport url from './config.js';\r\n\r\nimport cpath from './Images/clippath.svg';\r\nimport {\r\n    isMobile,\r\n    isFirefox,\r\n    isChrome,\r\n    browserName,\r\n    engineName,\r\n} from \"react-device-detect\";\r\n\r\n\r\n\r\nexport default function createMentionPlugin() {\r\n    let externalES = null;\r\n    let friendsList = [];\r\n    let externalSetEditorState = null;\r\n    let tabIndex = -123;\r\n    \r\n\r\n    function Mention(props) {\r\n        const { contentState, entityKey, blockKey, offsetKey, start, end, decoratedText, } = props;\r\n\r\n\r\n        const { mentionHeadKey, mentionBodyKey, person, imgurl, mentionType } = contentState.getEntity(entityKey).getData()\r\n\r\n        return (\r\n            <MentionComponent {...{\r\n                inputFriendName,\r\n                friendsList,\r\n                decoratedText,\r\n\r\n                // menuIndex: tabIndex % friendsList.length,\r\n                entityKey,\r\n                mentionHeadKey,\r\n                mentionBodyKey,\r\n                person,\r\n                imgurl,\r\n                mentionType,\r\n                ...props\r\n            }}\r\n            />\r\n        )\r\n\r\n    }\r\n\r\n\r\n    function MentionComponent(props) {\r\n\r\n        const { mentionHeadKey, mentionBodyKey, person, imgurl, mentionType, children, friendsList, entityKey } = props;\r\n        const { fontSize2 } = useContext(ThemeContext)\r\n\r\n\r\n        if ((mentionType === \"shortMentionOn\")) {\r\n            return (\r\n\r\n                <span style={{\r\n                    display: \"inline\",\r\n                    backgroundColor: \"wheat\",\r\n                    //     verticalAlign: \"middle\",\r\n                    position: \"relative\",\r\n                }}>\r\n                    <div style={{\r\n                        lineHeight: \"0px\",\r\n                        //      height: fontSize2 * 16 * 1.2 + \"px\",\r\n                        minWidth: fontSize2 * 16 * 1.2 + \"px\",\r\n                        display: \"inline-block\",\r\n\r\n                    }}>\r\n                        {children}\r\n                    </div>\r\n\r\n\r\n                    {!isMobile && <div style={{\r\n\r\n                        backgroundColor: \"seashell\",\r\n                        width: \"max-content\",\r\n\r\n\r\n                        position: \"absolute\",\r\n                        //top:0,\r\n                        top: fontSize2 * 16 * 1.2 + \"px\",\r\n                        left: \"0px\",\r\n                        zIndex: 22,\r\n                        display: \"flex\",\r\n                        flexDirection: \"column\",\r\n\r\n                        opacity: 1,\r\n                    }}>\r\n                        {friendsList.map(function (friendName, index) {\r\n\r\n                            return (\r\n\r\n                                <div key={index}\r\n                                    contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n                                    className=\"personCard\"\r\n                                    style={{\r\n                                        display: \"flex\",\r\n                                        backgroundColor: tabIndex % friendsList.length === index ? \"brown\" : \"\"\r\n                                    }}\r\n\r\n                                    onClick={function (e) {\r\n                                        inputFriendName(friendName, mentionHeadKey, mentionBodyKey, entityKey)\r\n                                    }}\r\n                                >\r\n\r\n                                    <img src={`${url}/avatar/downloadavatar/${friendName}`}\r\n                                        contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n                                        height={fontSize2 * 16 * 1.2 + \"px\"}\r\n                                        width={fontSize2 * 16 * 1.2 + \"px\"}\r\n                                        style={{ clipPath: \"circle(50% at 50% 50%)\", }}\r\n\r\n                                    />\r\n\r\n                                    <div contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n\r\n                                        style={{\r\n                                            //  flexGrow: 100,\r\n                                            display: \"block\", position: \"relative\",\r\n                                            //      backgroundColor: \"lightblue\",\r\n                                        }}\r\n\r\n                                    >\r\n                                        <img style={{\r\n                                            backgroundColor: \"brown\", position: \"absolute\", width: \"100%\", top: 0,\r\n                                            height: \"100%\", opacity: \"0.01\",\r\n                                        }}\r\n                                        />\r\n                                        {friendName}\r\n                                    </div>\r\n                                </div>\r\n\r\n\r\n                            )\r\n\r\n                        })}\r\n                    </div>}\r\n\r\n                </span>\r\n            )\r\n        }\r\n        else if (mentionType === \"shortMentionOff\") {\r\n\r\n            return (\r\n\r\n                <span style={{\r\n                    display: \"inline\",\r\n                    backgroundColor: \"#AAF\",\r\n                    //       verticalAlign: \"middle\",\r\n                    position: \"relative\",\r\n                }}>\r\n                    <div style={{\r\n                        lineHeight: \"0px\",\r\n                        //  height: fontSize2 * 16 * 1.2 + \"px\",\r\n                        minWidth: fontSize2 * 16 * 1.2 + \"px\",\r\n                        display: \"inline-block\",\r\n\r\n                    }}>\r\n                        {children}\r\n                    </div>\r\n                </span>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            )\r\n        }\r\n        else if (mentionType === \"longMentionOnAt_HEAD\") {\r\n            return (\r\n\r\n                <span style={{\r\n                    display: \"inline\",\r\n                    backgroundColor: \"gold\",\r\n                    //         verticalAlign: \"middle\",\r\n                    position: \"relative\",\r\n\r\n                }}>\r\n\r\n                    <div style={{\r\n                        lineHeight: \"0px\",\r\n                        //        height: fontSize2 * 16 * 1.2 + \"px\",\r\n                        minWidth: fontSize2 * 16 * 1.2 + \"px\",\r\n                        display: \"inline-block\",\r\n                        alignItems: \"center\",\r\n                    }}>\r\n                        {children}\r\n                    </div>\r\n\r\n\r\n                    {!isMobile && <div style={{\r\n\r\n                        backgroundColor: \"seashell\",\r\n                        width: \"max-content\",\r\n\r\n\r\n                        position: \"absolute\",\r\n                        //top:0,\r\n                        top: fontSize2 * 16 * 1.2 + \"px\",\r\n                        left: \"0px\",\r\n                        zIndex: 22,\r\n                        display: \"flex\",\r\n                        flexDirection: \"column\",\r\n\r\n                        opacity: 1,\r\n\r\n\r\n\r\n                    }}>\r\n                        {!isMobile && friendsList.map(function (friendName, index) {\r\n\r\n                            return (\r\n\r\n                                <div key={index}\r\n                                    contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n                                    className=\"personCard\"\r\n                                    style={{\r\n                                        display: \"flex\",\r\n                                        backgroundColor: tabIndex % friendsList.length === index ? \"brown\" : \"\"\r\n                                    }}\r\n\r\n                                    onClick={function (e) {\r\n                                        inputFriendName(friendName, mentionHeadKey, mentionBodyKey, entityKey)\r\n                                    }}\r\n                                >\r\n                                    <div contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n\r\n                                        style={{\r\n                                            display: \"flex\",\r\n                                            //    backgroundColor: \"orange\"\r\n                                        }}\r\n\r\n                                    >\r\n                                        <img src={`${url}/avatar/downloadavatar/${friendName}`}\r\n                                            contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n                                            height={fontSize2 * 16 * 1.2 + \"px\"}\r\n                                            width={fontSize2 * 16 * 1.2 + \"px\"}\r\n                                            style={{ clipPath: \"circle(50% at 50% 50%)\", }}\r\n\r\n                                        />\r\n                                    </div>\r\n                                    <div contentEditable=\"false\" suppressContentEditableWarning=\"true\"\r\n\r\n                                        style={{\r\n                                            flexGrow: 100, display: \"block\", position: \"relative\",\r\n                                            //      backgroundColor: \"lightblue\",\r\n                                        }}\r\n\r\n                                    >\r\n                                        <img style={{\r\n                                            backgroundColor: \"brown\", position: \"absolute\", width: \"100%\", top: 0,\r\n                                            height: \"100%\", opacity: \"0.01\",\r\n                                        }}\r\n                                        />\r\n                                        {friendName}\r\n                                    </div>\r\n                                </div>\r\n\r\n\r\n\r\n                            )\r\n\r\n                        })}\r\n\r\n\r\n\r\n\r\n                    </div>}\r\n\r\n                </span>\r\n\r\n\r\n            )\r\n        }\r\n        else if (mentionType === \"longMentionOnAt_BODY\") {\r\n            return (\r\n\r\n                <span style={{\r\n                    lineHeight: \"0px\",\r\n                    height: fontSize2 * 16 * 1.2 + \"px\",\r\n                    display: \"inline-flex\",\r\n                    alignItems: \"center\",\r\n                    display: \"inline\",\r\n                    backgroundColor: \"gold\",\r\n                    //        verticalAlign: \"middle\",\r\n\r\n                }}>\r\n                    {children}\r\n                </span>\r\n\r\n\r\n            )\r\n        }\r\n        else if (mentionType === \"longMentionOnOther_HEAD\") {\r\n            return (\r\n                <span style={{\r\n                    display: \"inline\",\r\n                    backgroundColor: \"pink\",\r\n                    //            verticalAlign: \"middle\",\r\n\r\n                }}>\r\n                    <div style={{\r\n                        lineHeight: \"0px\",\r\n                        height: fontSize2 * 16 * 1.2 + \"px\",\r\n                        minWidth: fontSize2 * 16 * 1.2 + \"px\",\r\n                        display: \"inline-flex\",  //   display: \"inline-block\", \r\n                        alignItems: \"center\"\r\n\r\n                    }}>\r\n                        {children}\r\n                    </div>\r\n                </span >\r\n            )\r\n        }\r\n        else if (mentionType === \"longMentionOnOther_BODY\") {\r\n            return (\r\n\r\n\r\n                <span style={{\r\n                    lineHeight: \"0px\",\r\n                    height: fontSize2 * 16 * 1.2 + \"px\",\r\n                    display: \"inline-flex\",\r\n                    alignItems: \"center\",\r\n                    display: \"inline\",\r\n                    backgroundColor: \"pink\",\r\n                    //      verticalAlign: \"middle\",\r\n\r\n                }}>\r\n                    {children}\r\n                </span>\r\n            )\r\n        }\r\n        else if (mentionType === \"longMentionOff_HEAD\") {\r\n\r\n\r\n\r\n\r\n            return (\r\n                <span style={{\r\n                    display: \"inline\",\r\n                    backgroundColor: \"#b7e1fc\", borderTopLeftRadius: \"1000px\", borderBottomLeftRadius: \"1000px\",\r\n                    //       verticalAlign: \"middle\",\r\n                }}>\r\n                    <div style={{\r\n                        //   lineHeight: \"0px\",\r\n                        height: isMobile && isFirefox ? fontSize2 * 21.6 * 1.2 + \"px\" : fontSize2 * 16 * 1.2 + \"px\",\r\n                        width: isMobile && isFirefox ? fontSize2 * 21.6 * 1.2 + \"px\" : fontSize2 * 16 * 1.2 + \"px\",\r\n                        display: \"inline-flex\",\r\n                        alignItems: \"center\",\r\n\r\n                        color: \"rgba(200,0,0,0)\",\r\n                        backgroundColor: \"purple\",\r\n                        borderRadius: \"1000px\",\r\n                        backgroundPosition: \"center center\",\r\n                        backgroundImage: imgurl,\r\n                        backgroundRepeat: \"no-repeat\",\r\n                        //   backgroundSize: isMobile && isFirefox ? \"cover\" : \"contain\",\r\n                        backgroundSize: \"cover\",\r\n                        boxShadow: \"rgb(180, 180, 180) -2px 0px 3px\",\r\n                    }}>\r\n                        {children}\r\n                    </div>\r\n\r\n                </span>\r\n            )\r\n\r\n\r\n        }\r\n        else if (mentionType === \"longMentionOff_BODY\") {\r\n            return (\r\n\r\n\r\n                <span style={{\r\n                    lineHeight: \"0px\",\r\n                    height: fontSize2 * 16 * 1.2 + \"px\",\r\n                    display: \"inline-flex\",\r\n                    alignItems: \"center\",\r\n                    display: \"inline\",\r\n                    backgroundColor: \"#b7e1fc\",\r\n                    //     verticalAlign: \"middle\",\r\n\r\n                }}>\r\n                    {children}\r\n                </span>\r\n\r\n\r\n\r\n            )\r\n        }\r\n    }\r\n\r\n\r\n    function taggingMention() {\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n            = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n        const oldSelection = externalES.getSelection();\r\n        let newSelection = externalES.getSelection();\r\n\r\n        let newContent = externalES.getCurrentContent();\r\n\r\n\r\n\r\n\r\n        externalES.getCurrentContent().getBlocksAsArray().forEach(function (block) {\r\n            const blockKey = block.getKey();\r\n            const blockType = block.getType();\r\n            const blockText = block.getText();\r\n\r\n            const regx = /\\s([@][\\w_\\[\\u4E00-\\u9FCA\\]]*)/g\r\n            //  const regx = /\\s([@#][\\w_]*)/g\r\n            //   const array = [...blockText.matchAll(regx)].map(a => a.index);\r\n\r\n\r\n            const metaArr = block.getCharacterList();\r\n            metaArr.forEach(function (item, index) {\r\n                if (item.getEntity()) {\r\n                    const entityType = newContent.getEntity(item.getEntity()).getType()\r\n\r\n                    if (entityType.indexOf(\"Mention\") >= 0) {\r\n\r\n                        newSelection = externalES.getSelection().merge({\r\n                            anchorKey: blockKey,\r\n                            anchorOffset: index,\r\n                            focusKey: blockKey,\r\n                            focusOffset: index + 1,\r\n                            isBackward: false,\r\n                            hasFocus: false,\r\n                        })\r\n                        newContent = Modifier.applyEntity(newContent, newSelection, null)\r\n                    }\r\n                }\r\n            })\r\n\r\n\r\n\r\n            let matchArr;\r\n            while ((matchArr = regx.exec(blockText)) !== null) {\r\n\r\n\r\n                const start = matchArr.index;\r\n                const end = matchArr.index + matchArr[0].length;\r\n                const contentLenth = end - start;\r\n                const contentFocusAt = anchorFocusOffset - start;\r\n\r\n                const shortMentionOn = (contentLenth === 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt === 2)\r\n                const shortMentionOff = (contentLenth === 2) && ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt !== 2))\r\n\r\n                const longMentionOnAt = (contentLenth > 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt === 2)\r\n                const longMentionOnOther = (contentLenth > 2) && hasfocus && (blockKey === anchorFocusKey) && (contentFocusAt !== 2) && (contentFocusAt > 0) && (contentFocusAt <= contentLenth)\r\n\r\n\r\n                const longMentionOff = (contentLenth > 2) && ((!hasfocus) || (blockKey !== anchorFocusKey) || (contentFocusAt <= 0) || (contentFocusAt > contentLenth))\r\n\r\n\r\n\r\n                if (shortMentionOn) {\r\n                    newContent = newContent.createEntity(\"shortMentionOn\", \"MUTABLE\", { mentionType: \"shortMentionOn\" });\r\n                    let entityKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = newSelection.merge({\r\n                        anchorKey: blockKey,\r\n                        focusKey: blockKey,\r\n                        anchorOffset: start,\r\n                        focusOffset: end,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n\r\n                }\r\n                else if (shortMentionOff) {\r\n                    newContent = newContent.createEntity(\"shortMentionOff\", \"MUTABLE\", { mentionType: \"shortMentionOff\" });\r\n                    let entityKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = newSelection.merge({\r\n                        anchorKey: blockKey,\r\n                        focusKey: blockKey,\r\n                        anchorOffset: start,\r\n                        focusOffset: end,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, entityKey)\r\n\r\n                }\r\n                else if (longMentionOnAt) {\r\n\r\n                    createTag(\"longMentionOnAt\")\r\n\r\n                }\r\n                else if (longMentionOnOther) {\r\n\r\n                    createTag(\"longMentionOnOther\")\r\n\r\n                }\r\n                else if (longMentionOff) {\r\n                    createTag(\"longMentionOff\")\r\n                }\r\n\r\n\r\n\r\n                function createTag(tagName, ) {\r\n\r\n                    newContent = newContent.createEntity(`${tagName}_HEAD`, \"MUTABLE\", { mentionType: `${tagName}_HEAD` });\r\n                    let mentionHeadKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = newSelection.merge({\r\n                        anchorKey: blockKey,\r\n                        focusKey: blockKey,\r\n                        anchorOffset: start,\r\n                        focusOffset: start + 2,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, mentionHeadKey)\r\n\r\n                    newContent = newContent.createEntity(`${tagName}_BODY`, \"MUTABLE\", { mentionType: `${tagName}_BODY` });\r\n                    let mentionBodyKey = newContent.getLastCreatedEntityKey();\r\n                    newSelection = newSelection.merge({\r\n                        anchorKey: blockKey,\r\n                        focusKey: blockKey,\r\n                        anchorOffset: start + 2,\r\n                        focusOffset: end,\r\n                        isBackward: false,\r\n                        hasFocus: false,\r\n                    })\r\n\r\n                    newContent = Modifier.applyEntity(newContent, newSelection, mentionBodyKey)\r\n\r\n\r\n                    newContent = newContent.mergeEntityData(\r\n                        mentionHeadKey,\r\n                        {\r\n                            mentionHeadKey, mentionBodyKey,\r\n                            person: blockText.substring(start, end).replace(\" @\", \"\"),\r\n                            imgurl: `url(${url}/avatar/downloadavatar/${blockText.substring(start, end).replace(\" @\", \"\")})`\r\n                        }\r\n                    )\r\n\r\n                    newContent = newContent.mergeEntityData(\r\n                        mentionBodyKey,\r\n                        {\r\n                            mentionHeadKey, mentionBodyKey,\r\n                            person: blockText.substring(start, end).replace(\" @\", \"\"),\r\n                            imgurl: `url(${url}/avatar/downloadavatar/${blockText.substring(start, end).replace(\" @\", \"\")})`\r\n                        }\r\n                    )\r\n                }\r\n\r\n\r\n\r\n\r\n\r\n            }\r\n        })\r\n\r\n        externalES = EditorState.push(externalES, newContent, \"insert-fragment\");\r\n        externalES = EditorState.acceptSelection(externalES, oldSelection);\r\n        //externalES = EditorState.forceSelection(externalES, oldSelection);\r\n        return externalES\r\n\r\n    }\r\n\r\n    function inputFriendName(friendName, mentionHeadKey, mentionBodyKey, entityKey) {\r\n\r\n\r\n        const text = friendName + \" \"\r\n        const contentState = externalES.getCurrentContent();\r\n        const selection = externalES.getSelection();\r\n\r\n\r\n        const mentionBodyText = mentionBodyKey\r\n            ? contentState.getEntity(mentionBodyKey).getData().person.replace(\" @\", \"\")\r\n            : \"\"\r\n\r\n        const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = selection.toArray()\r\n        const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n            = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n\r\n        let newSelection = selection.merge({\r\n            anchorKey: anchorStartKey,\r\n            anchorOffset: anchorStartOffset,\r\n            focusKey: anchorStartKey,\r\n            focusOffset: anchorStartOffset + mentionBodyText.length,\r\n            isBackward: false,\r\n            hasFocus: true,\r\n\r\n        })\r\n\r\n\r\n        let newContent = Modifier.replaceText(\r\n            contentState,\r\n            newSelection,\r\n            text,\r\n        )\r\n\r\n        newSelection = externalES.getSelection().merge({\r\n\r\n            anchorKey: anchorStartKey,\r\n            anchorOffset: anchorStartOffset + text.length,\r\n            focusKey: anchorStartKey,\r\n            focusOffset: anchorStartOffset + text.length,\r\n            isBackward: false,\r\n            hasFocus: true,\r\n        })\r\n\r\n        externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n        externalES = EditorState.acceptSelection(externalES, newSelection)\r\n\r\n        externalSetEditorState(externalES)\r\n    }\r\n\r\n\r\n    function hasOnAtTag() {\r\n\r\n        if (friendsList.length <= 0) { return false }\r\n\r\n        let isAtOn = false;\r\n        const contentState = externalES.getCurrentContent();\r\n        contentState.getBlocksAsArray().forEach(function (block) {\r\n\r\n            const metaArr = block.getCharacterList();\r\n            metaArr.forEach(function (item, index) {\r\n\r\n                const tagKey = item.getEntity()\r\n                if (tagKey) {\r\n                    const { mentionType, mentionHeadKey, mentionBodyKey } = contentState.getEntity(tagKey).getData()\r\n                    if (mentionType) {\r\n\r\n\r\n\r\n\r\n\r\n                        if (mentionType === \"shortMentionOn\") {\r\n\r\n\r\n                            return isAtOn = [friendsList[tabIndex % friendsList.length], \"\", \"\", tagKey]\r\n                        }\r\n                        else if (mentionType.indexOf(\"longMentionOnAt\") >= 0) {\r\n\r\n                            return isAtOn = [friendsList[tabIndex % friendsList.length], mentionHeadKey, mentionBodyKey, tagKey]\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n\r\n            if (isAtOn) { return isAtOn }\r\n        })\r\n        return isAtOn\r\n    }\r\n\r\n\r\n    function mentionStrategy(contentBlock, callback, contentState) {\r\n\r\n\r\n        ///  findWithRegex(/\\s([@#][\\w_\\[\\u4E00-\\u9FFF\\]]*)/g, contentBlock, callback)\r\n\r\n        contentBlock.findEntityRanges(\r\n            function (character) {\r\n                const entityKey = character.getEntity();\r\n\r\n                return entityKey !== null && contentState.getEntity(entityKey).getType().indexOf(\"Mention\") >= 0\r\n\r\n\r\n            },\r\n            callback\r\n        );\r\n    }\r\n\r\n    return {\r\n\r\n        setFriendsList(friendsArr) {\r\n            friendsList = friendsArr\r\n            tabIndex = tabIndex === -123 ? 1000 * friendsList.length : tabIndex\r\n        },\r\n\r\n        handleBeforeInput(chars, editorState, evenTimeStamp, { setEditorState }) {\r\n\r\n            if ((hasOnAtTag() && isMobile && (!isFirefox))) {\r\n                externalES = editorState;\r\n                externalSetEditorState = setEditorState;\r\n\r\n\r\n\r\n                const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n                const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n                    = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n                let newSelection = externalES.getSelection()\r\n                let newContent = externalES.getCurrentContent()\r\n\r\n\r\n                newSelection = newSelection.merge({\r\n\r\n                    isBackward: false,\r\n                    hasFocus: true,\r\n                })\r\n\r\n\r\n                newContent = Modifier.replaceText(\r\n                    newContent,\r\n                    newSelection,\r\n                    chars,\r\n                )\r\n\r\n\r\n\r\n\r\n\r\n                newSelection = newSelection.merge({\r\n                    // anchorOffset: anchorStartOffset ,//+ chars.length*2 ,\r\n                    // focusOffset: anchorFocusOffset ,//+ chars.length*2 ,\r\n                    // isBackward: false,\r\n                    // hasFocus: true,\r\n                })\r\n\r\n\r\n                externalES = EditorState.push(externalES, newContent, \"insert-characters\");\r\n                externalES = EditorState.acceptSelection(externalES, newSelection)\r\n\r\n                setEditorState(externalES)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                return \"handled\"\r\n            }\r\n\r\n\r\n\r\n\r\n        },\r\n\r\n        keyBindingFn(e, { getEditorState, setEditorState, ...obj }) {\r\n\r\n\r\n\r\n\r\n            if ((e.keyCode === 40) && hasOnAtTag()) {\r\n                tabIndex = tabIndex + 1;\r\n\r\n                return \"fire-arrow\";\r\n            }\r\n\r\n            else if ((e.keyCode === 38) && hasOnAtTag()) {\r\n                tabIndex = tabIndex - 1;\r\n                return \"fire-arrow\";\r\n            }\r\n\r\n            else if ((e.keyCode === 13) && hasOnAtTag()) {\r\n\r\n                return \"fire-enter\";\r\n            }\r\n\r\n\r\n        },\r\n\r\n        onChange(editorState, { setEditorState }) {\r\n\r\n            externalES = editorState\r\n            externalSetEditorState = setEditorState\r\n            externalES = taggingMention()\r\n\r\n\r\n\r\n            if (Array.isArray(hasOnAtTag())) {\r\n\r\n\r\n                const [anchorKey, anchorOffset, focusKey, focusOffset, isBackward, hasfocus] = externalES.getSelection().toArray()\r\n                const [anchorStartKey, anchorStartOffset, anchorFocusKey, anchorFocusOffset, isAnchorBackward, isAnchorFocused]\r\n                    = [!isBackward ? anchorKey : focusKey, !isBackward ? anchorOffset : focusOffset, isBackward ? anchorKey : focusKey, isBackward ? anchorOffset : focusOffset,]\r\n\r\n                console.log(hasfocus)\r\n            }\r\n\r\n\r\n            return externalES\r\n\r\n        },\r\n\r\n        handleKeyCommand(command, editorState, evenTimeStamp, { setEditorState }) {\r\n\r\n            //   externalES = editorState;\r\n\r\n            //     if ((command !== \"fire-arrow\") && (command !== \"fire-enter\")) { return \"un-handled\" }\r\n\r\n            if (command === \"fire-arrow\") {\r\n\r\n                externalSetEditorState(externalES)\r\n\r\n                return \"handled\"\r\n            }\r\n\r\n            if (command === \"fire-enter\") {\r\n\r\n                inputFriendName(...hasOnAtTag())\r\n\r\n                return \"handled\"\r\n            }\r\n\r\n\r\n            //  return 'not-handled';\r\n        },\r\n\r\n        decorators: [\r\n            {\r\n                strategy: mentionStrategy,\r\n                component: Mention\r\n            }\r\n        ],\r\n    }\r\n\r\n};\r\n\r\n","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\n\r\nimport { compareAsc, format, formatDistanceToNow, } from 'date-fns'\r\n\r\nimport { zhCN } from 'date-fns/locale'\r\n\r\nimport DraftEditor4, { CommentEditor, SubCommentEditor } from './DraftEditor4';\r\nimport {\r\n    isMobile,\r\n    isFirefox,\r\n    isChrome,\r\n    browserName,\r\n    engineName,\r\n} from \"react-device-detect\";\r\nimport axios from './contexts/axios';\r\n\r\n\r\nimport Immutable from 'immutable'\r\nimport Button from \"./Button\"\r\n\r\nimport { Avatar4, LongMentionOffHead, LongMentionOffBody } from \"./Avatar2\"\r\n\r\n\r\nimport ReactHtmlParser, { processNodes, convertNodeToElement, htmlparser2 } from 'react-html-parser';\r\nimport ImgTag from './ImgTag';\r\nimport url from \"./config\";\r\nimport { generateKeyPair } from 'crypto';\r\n\r\n\r\n\r\n\r\n\r\nexport default function Content() {\r\n\r\n\r\n\r\n    const {\r\n        userName, contentList, setContentList, downloadContentList,\r\n        deleteContentList, friendsList, setFriendsList, uploadFriendsList,\r\n        countContentNum, contentNum,\r\n    } = useContext(UserContext)\r\n\r\n    const { fontSize2, editorWidth, color4 } = useContext(ThemeContext)\r\n\r\n\r\n    const { width, minWidth, maxWidth } = editorWidth\r\n    const width_ = width + \"%\", minWidth_ = minWidth + \"px\", maxWidth_ = maxWidth + \"px\"\r\n\r\n    const isComputer = !isMobile\r\n\r\n    const [commentObj, setCommentObj] = useState({})\r\n    const [subCommentObj, setSubCommentObj] = useState({})\r\n\r\n\r\n    //  const [commentNumObj,setCommentNumObj] = useState({})\r\n\r\n    function renderHtml(contentToRent = \"Nothing to Render\") {\r\n\r\n\r\n\r\n        while (contentToRent.indexOf(\"&nbsp;\") >= 0) {\r\n            contentToRent = contentToRent.replace(\"&nbsp;\", \" \")\r\n        }\r\n\r\n\r\n        return ReactHtmlParser(contentToRent, {\r\n            transform: function (node, index) {\r\n\r\n\r\n                if (node.name === \"imgtag\") {\r\n                    return <ImgTag key={index} id={node.attribs.id} style={{ maxWidth: width * 0.3 + \"%\", display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }}\r\n\r\n                        onClick={function (e) {\r\n\r\n                            return e.target.style.maxWidth === \"100%\" ? e.target.style.maxWidth = width * 0.3 + \"%\" : e.target.style.maxWidth = \"100%\"\r\n                        }}\r\n\r\n                    />\r\n                    //  return <img key={index} id={node.attribs.id}  src={`${url}/picture/downloadpicture/${node.attribs.id}`}  style={{ maxWidth: \"100%\", display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }} />\r\n                }\r\n                if (node.name === \"shortmentionoff\") {\r\n\r\n                    return <span\r\n                        key={index}\r\n                        style={{\r\n                            display: \"inline\",\r\n                            backgroundColor: \"#AAF\",\r\n                            //           verticalAlign: \"middle\",\r\n                            position: \"relative\",\r\n                        }}>\r\n                        <div style={{\r\n                            lineHeight: \"0px\",\r\n                            //    height: fontSize2 * 16 * 1.2 + \"px\",\r\n                            minWidth: fontSize2 * 16 * 1.2 + \"px\",\r\n                            display: \"inline-block\",\r\n\r\n                        }}>\r\n                            {node.children.map(item => item.data)}\r\n                            {/* node.children[0].data */}\r\n\r\n\r\n                        </div>\r\n                    </span>\r\n                }\r\n                if (node.name === \"longmentionoff_head\") {\r\n\r\n                    return (\r\n\r\n                        <LongMentionOffHead key={index} peopleName={node.attribs.person}>\r\n                            {node.children.map(item => item.data)}\r\n                        </LongMentionOffHead>\r\n                    )\r\n\r\n                }\r\n                if (node.name === \"longmentionoff_body\") {\r\n\r\n                    return <LongMentionOffBody key={index}>{node.children.map(item => item.data)}</LongMentionOffBody>\r\n\r\n\r\n                }\r\n\r\n\r\n                if (node.name === \"mylink\") {\r\n                    return <a\r\n                        target=\"_blank\"\r\n                        key={index}\r\n                        style={{ color: \"blue\", fontSize: Math.max(fontSize2 * 0.7, 0.7) + \"rem\", cursor: \"pointer\" }}\r\n\r\n                        onClick={function (e) {\r\n                            e.target.innerHTML === node.attribs.host && e.preventDefault()\r\n                            e.target.innerHTML = node.attribs.address\r\n                            e.target.href = node.attribs.address.substr(1)\r\n                        }}\r\n                    >\r\n                        {node.attribs.host}\r\n                    </a>\r\n\r\n                }\r\n                if ((node.name === \"emoji_phone\") && (isComputer)) {\r\n\r\n\r\n                    return <span\r\n                        key={index}\r\n                        style={{\r\n\r\n                            backgroundColor: \"wheat\",\r\n                            backgroundRepeat: \"no-repeat\",\r\n                            backgroundPosition: \"left center\",\r\n                            backgroundSize: \"contain\",\r\n                            display: \"inline-block\",\r\n                            //   width: \"48px\",\r\n                            // height: \"48px\",\r\n                            //   textAlign: \"right\",\r\n                            verticalAlign: \"middle\",\r\n\r\n\r\n                            color: \"rgba(0,0,0,0)\",\r\n                            backgroundImage: node.attribs.background_image,\r\n\r\n                            //   width: `${fontSize2 * 16}px`,\r\n                            minWidth: fontSize2 * 16 + \"px\",\r\n                            height: `${fontSize2 * 16}px`,\r\n                        }}\r\n\r\n\r\n                    >{node.children[0].data}</span>\r\n                }\r\n                if ((node.name === \"emoji_phone\") && (!isComputer)) {\r\n                    return <span key={index}   >{node.children[0].data}</span>\r\n                }\r\n            }\r\n        })\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n\r\n            <div style={{\r\n                fontSize: fontSize2 + \"rem\",\r\n\r\n                margin: \"auto\",\r\n                marginBottom: \"20px\",\r\n                width: width_,\r\n                minWidth: minWidth_,\r\n                maxWidth_: maxWidth_,\r\n\r\n                wordBreak: \"break-all\",\r\n                whiteSpace: \"pre-wrap\",\r\n\r\n            }}>\r\n                {contentList.map((poster, index) => {\r\n\r\n\r\n                    return (\r\n\r\n                        <div key={poster._id} id={poster._id}\r\n                            style={{\r\n                                //  backgroundColor: \"#\" + ((1 << 24) * Math.random() | 0).toString(16),\r\n                                backgroundColor: color4,\r\n\r\n                                marginBottom: \"10px\",\r\n\r\n                            }}>\r\n                            <div style={{ paddingTop: \"5px\", paddingBottom: \"5px\", verticalAlign: \"middle\", }}>\r\n\r\n\r\n\r\n                                <Avatar4 peopleName={poster.ownerName} imgOnly={false} />\r\n\r\n\r\n\r\n\r\n\r\n\r\n                                <span style={{ fontSize: fontSize2 * 0.7 + \"rem\" }}>\r\n                                    &nbsp;&nbsp;{formatDistanceToNow(new Date(poster.postingTime), { locale: zhCN, })}\r\n                                </span>\r\n\r\n\r\n\r\n                                {userName === poster.ownerName && <Button\r\n                                    style={{  /*verticalAlign:\"middle\",*/ }}\r\n\r\n\r\n                                    onClick={function (e) {\r\n                                        e.persist()\r\n                                        e.target.disabled = true\r\n                                        deleteContentList(poster._id)\r\n                                            .catch(function (err) {\r\n                                                console.log(err)\r\n                                                e.target.disabled = false\r\n                                            })\r\n\r\n\r\n                                    }}\r\n                                ></Button>}\r\n\r\n                                {userName && <Button\r\n\r\n                                    onClick={function (e) {\r\n                                        e.persist()\r\n                                        e.target.disabled = true;\r\n                                        axios.get(`${url}/comment/count/${poster._id}`).then(({ data }) => {\r\n\r\n                                            setContentList(pre => {\r\n                                                const arr = pre.map(function (content) {\r\n                                                    if (content._id !== poster._id) {\r\n                                                        return content\r\n                                                    }\r\n                                                    else {\r\n                                                        content.commentNum = data\r\n                                                        return content\r\n                                                    }\r\n                                                })\r\n                                                return arr\r\n                                            })\r\n\r\n                                        })\r\n\r\n                                        if (commentObj[poster._id]) {\r\n\r\n                                            setCommentObj(pre => {\r\n                                                const obj = pre;\r\n                                                delete obj[poster._id]\r\n\r\n\r\n                                                return { ...obj }\r\n                                            })\r\n\r\n                                            e.target.disabled = false;\r\n                                        }\r\n                                        else {\r\n                                            axios.get(`${url}/comment/${poster._id}`).then(({ data }) => {\r\n\r\n                                                setCommentObj((pre) => {\r\n                                                    const obj = { [poster._id]: data }\r\n\r\n\r\n                                                    return { ...pre, ...obj }\r\n                                                })\r\n                                                e.target.disabled = false;\r\n\r\n                                                setSubCommentObj((pre) => {\r\n\r\n                                                    data.forEach(function (comment) {\r\n\r\n                                                        //       pre[comment._id] = new Array(Number(comment.subCommentNum))\r\n                                                        pre[comment._id] = (Number(comment.subCommentNum))\r\n\r\n                                                    })\r\n\r\n                                                    console.log(pre)\r\n                                                    return { ...pre }\r\n                                                })\r\n                                            })\r\n                                        }\r\n                                    }}\r\n\r\n                                >{poster.commentNum}</Button>}\r\n\r\n                            </div>\r\n\r\n\r\n\r\n\r\n                            <div>\r\n                                {renderHtml(poster.content)}\r\n\r\n\r\n                                <div>\r\n                                    {commentObj[poster._id] && <hr style={{ marginBottom: \"5px\" }} />}\r\n\r\n\r\n                                    {/* {commentObj[poster._id] && <LongMentionOffHead peopleName={userName}> @</LongMentionOffHead>} */}\r\n                                    {commentObj[poster._id] && <CommentEditor articleId={poster._id} setCommentObj={setCommentObj} setContentList={setContentList} />}\r\n\r\n                                    {(function () {\r\n\r\n                                        if (commentObj[poster._id]) {\r\n                                            return commentObj[poster._id].sort(\r\n                                                function (item1, item2) {\r\n                                                    if (item1._id > item2._id) { return -1 }\r\n                                                    else if (item1._id < item2._id) { return 1 }\r\n                                                    else { return 0 }\r\n                                                }\r\n\r\n                                            ).map((data, index) => {\r\n                                                return (\r\n                                                    <div key={index}>\r\n                                                        <div style={{ verticalAlign: \"middle\", paddingLeft: \"5%\", paddingRight: \"5%\" }}>\r\n                                                            <LongMentionOffHead peopleName={data.ownerName}> @</LongMentionOffHead>\r\n                                                            <LongMentionOffBody>{data.ownerName}</LongMentionOffBody>\r\n                                                            <span style={{ fontSize: fontSize2 * 0.7 + \"rem\" }}>\r\n                                                                &nbsp;&nbsp;{formatDistanceToNow(new Date(data.postingTime), { locale: zhCN, })}\r\n                                                            </span>\r\n\r\n\r\n                                                            {userName === data.ownerName && <Button\r\n\r\n                                                                onClick={function (e) {\r\n                                                                    // e.target.disabled = true\r\n                                                                    axios.get(`${url}/comment/delete/${data._id}`).then(() => {\r\n\r\n                                                                        setCommentObj(pre => {\r\n                                                                            const arr = pre[poster._id].filter(item => {\r\n                                                                                return item._id !== data._id\r\n                                                                            })\r\n                                                                            pre[poster._id] = arr\r\n\r\n                                                                            return { ...pre }\r\n\r\n                                                                        })\r\n\r\n                                                                        setContentList(pre => {\r\n                                                                            const arr = pre.map(function (content) {\r\n                                                                                if (content._id !== poster._id) {\r\n                                                                                    return content\r\n                                                                                }\r\n                                                                                else {\r\n                                                                                    content.commentNum--\r\n                                                                                    return content\r\n                                                                                }\r\n                                                                            })\r\n                                                                            return arr\r\n                                                                        })\r\n\r\n\r\n                                                                    })\r\n\r\n                                                                }}\r\n\r\n                                                            ></Button>}\r\n                                                            <Button\r\n\r\n                                                                onClick={function () {\r\n                                                                    const commentId = data._id\r\n\r\n                                                                    if (Array.isArray(subCommentObj[commentId])) {\r\n                                                                        axios.get(`${url}/subcomment/count/${commentId}`).then((response) => {\r\n                                                                            setSubCommentObj(pre => {\r\n                                                                                pre[commentId] = Number(response.data)\r\n                                                                                return { ...pre }\r\n                                                                            })\r\n\r\n                                                                        })\r\n                                                                    }\r\n                                                                    else {\r\n                                                                        axios.get(`${url}/subcomment/${commentId}`).then((response) => {\r\n\r\n                                                                            const subcommentsArr = response.data\r\n\r\n                                                                            setSubCommentObj(pre => {\r\n                                                                                if (!Array.isArray(pre[commentId])) {\r\n                                                                                    pre[commentId] = []\r\n                                                                                }\r\n                                                                                pre[commentId] = [...subcommentsArr]\r\n\r\n                                                                                return { ...pre }\r\n                                                                            })\r\n\r\n                                                                        })\r\n                                                                    }\r\n\r\n                                                                }}\r\n\r\n\r\n                                                            >{Array.isArray(subCommentObj[data._id]) ? subCommentObj[data._id].length : subCommentObj[data._id]}</Button>\r\n\r\n                                                        </div>\r\n\r\n                                                        <div style={{ paddingLeft: \"5%\", paddingRight: \"5%\" }}>\r\n\r\n\r\n\r\n                                                            {renderHtml(data.content)}\r\n\r\n\r\n                                                            {Array.isArray(subCommentObj[data._id]) && <SubCommentEditor commentId={data._id} setSubCommentObj={setSubCommentObj} />}\r\n\r\n\r\n                                                            <div style={{ paddingLeft: \"5%\", paddingRight: \"5%\" }}>\r\n\r\n                                                                {(function () {\r\n                                                                    if (Array.isArray(subCommentObj[data._id])) {\r\n                                                                        return subCommentObj[data._id].map(function (subcomment, index) {\r\n                                                                            return (\r\n                                                                                <span key={index}>\r\n                                                                                    <LongMentionOffHead peopleName={subcomment.ownerName}> @</LongMentionOffHead>\r\n                                                                                    <LongMentionOffBody>{subcomment.ownerName}</LongMentionOffBody>\r\n\r\n                                                                                    <span style={{ fontSize: fontSize2 * 0.7 + \"rem\" }}>\r\n                                                                                        &nbsp;&nbsp;{formatDistanceToNow(new Date(subcomment.postingTime), { locale: zhCN, })}\r\n                                                                                    </span>\r\n\r\n\r\n                                                                                    {userName === subcomment.ownerName && <Button\r\n\r\n                                                                                        onClick={function () {\r\n                                                                                            axios.get(`${url}/subcomment/delete/${subcomment._id}`).then((response) => {\r\n\r\n                                                                                                setSubCommentObj(pre => {\r\n\r\n                                                                                                    pre[data._id] = pre[data._id].filter(item => {\r\n                                                                                                        return item._id !== subcomment._id\r\n                                                                                                    })\r\n\r\n                                                                                                    return { ...pre }\r\n                                                                                                })\r\n                                                                                            })\r\n                                                                                        }}\r\n\r\n                                                                                    ></Button>}\r\n                                                                                    {renderHtml(subcomment.content)}\r\n                                                                                </span>\r\n                                                                            )\r\n                                                                        })\r\n                                                                    }\r\n                                                                }())}\r\n\r\n\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <hr />\r\n                                                    </div>\r\n\r\n                                                )\r\n                                            })\r\n                                        }\r\n\r\n                                    }())}\r\n                                </div>\r\n                            </div>\r\n\r\n\r\n                        </div>\r\n\r\n\r\n                    )\r\n                })}\r\n\r\n\r\n                {userName && <Button style={{ width: \"100%\" }}\r\n\r\n                    onClick={\r\n                        function (e) {\r\n                            e.persist()\r\n                            e.target.disabled = true\r\n                            downloadContentList().then(function () {\r\n                                e.target.disabled = false\r\n                            })\r\n                            countContentNum()\r\n                        }\r\n\r\n                    }\r\n                >{contentList.length}/{contentNum}</Button>}\r\n            </div>\r\n\r\n\r\n\r\n        </>\r\n    );\r\n}\r\n","import React, { useContext, useRef, useEffect, useState, useCallback, useMemo } from 'react';\r\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\r\nimport { UserContext } from './contexts/UserContextProvider';\r\nimport { ThemeContext } from './contexts/ThemeContextProvider';\r\nimport { useMediaQuery } from 'react-responsive';\r\nimport axios from './contexts/axios';\r\n\r\nimport url from \"./config\";\r\n\r\n\r\nconst Div0 = styled.div`\r\n\r\n\r\n    position:fixed;\r\n    top:0;\r\n    left:0;\r\n    width:100vw;\r\n    height:100vh;\r\n    background-color:${function ({ theme }) { return theme.color3 }};\r\n    z-index:-2;\r\n\r\n`\r\n\r\n\r\nconst Div = styled.div`\r\n\r\n    position:fixed;\r\n    top:0;\r\n    left:0;\r\n    width:100vw;\r\n    height:100vh;\r\n    /* background-color:${function ({ theme }) { return theme.color4 }}; */\r\n    opacity:${function({theme:{backPicOpacity}}){ return backPicOpacity}};\r\n\r\n    /* background-color:${function ({ theme }) { return theme.color3 }}; */\r\n    background-image:${function ({ img }) {   return `url(${img})` }};\r\n    \r\n    /* background-image:url(\"http://192.168.0.103/api/backpicture/downloadbackpicture/aaa\"); */\r\n    \r\n    background-size:${function ({ oriantation }) { return oriantation === \"horizontal\" ? `100% auto` : `auto 100%` }};\r\n\r\n\r\n\r\n    /* background-position: center; */\r\n    /* background-repeat:no-repeat; */\r\n   \r\n    /* background-position: left;\r\n    opacity:0.5; */\r\n   \r\n\r\n\r\n\r\n\r\n     /* Center the imagebackground-repeat: no-repeat; \r\n    /* Do not repeat the image */\r\n\r\n\r\n \r\n\r\n    /* background-image:     url(\"https://mernchen.herokuapp.com/api/picture/download/5f197ef0452cc60017f9f488\"); */\r\n    /* background-image:   ${function ({ url }) { return ` url(${url}/backpicture/downloadbackpicture/aaa);` }}   ;   */\r\n\r\n    overflow:auto;\r\n    z-index:-1;\r\n\r\n`\r\n\r\n\r\nconst BackPicture = () => {\r\n\r\n\r\n\r\n    const {\r\n        userAvatar,\r\n        userBackPicture,\r\n        userName,\r\n        axios,\r\n    } = useContext(UserContext)\r\n    // console.log(userBackPicture)\r\n    const {\r\n        backPicOrian,\r\n   \r\n        backPicOpacity,\r\n\r\n    } = useContext(ThemeContext)\r\n\r\n  \r\n\r\n    // const [oriantation, setOriantation] = useState(\"verticle\")\r\n    // useMemo(function () {\r\n    //     userBackPicture && (function () {\r\n\r\n    //         const img = new Image();\r\n    //         img.src = userBackPicture;\r\n    //         img.onload = function () {\r\n    //             setOriantation(img.width>=img.height?\"horizontal\":\"verticle\")           \r\n    //         }\r\n\r\n    //     }())\r\n\r\n    // }, [userBackPicture])\r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            <Div0></Div0>\r\n            <Div img={userBackPicture} oriantation={backPicOrian}  />\r\n\r\n            {/* {userName && <Div img={userBackPicture} oriantation={backPicOrian} />} */}\r\n\r\n        </>\r\n    );\r\n}\r\n\r\nexport default BackPicture;","import React, { useState, useContext, useEffect, useRef, useReducer } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport './App.css';\n\nimport styled, { ThemeProvider, css, keyframes } from \"styled-components\";\n\n\n\nimport Navbar from './Navbar';\nimport Avatar from './Avatar';\nimport Content from './Content';\nimport BackPicture from './BackPicture';\n\nimport DraftEditor4 from './DraftEditor4';\n\n\nimport ColorPicker from './ThemeSetter';\n\nimport Uploader from './Uploader';\n\nimport EmojiUpload from './EmojiUpload';\n\nimport { UserContext } from './contexts/UserContextProvider';\n\nconst Div = styled.div`\n    /* background-color:${function ({ theme }) { return theme.color3 }}; */\n\n`\n\n\n\nexport default function App() {\n  \n  const { userName } = useContext(UserContext)\n\n\n\n  return (\n\n    <>\n\n      <BackPicture />\n\n      <Navbar />\n\n      {/* <EmojiUpload/> */}\n\n      {/* <RichText2/> */}\n\n      {/* <RichText3/> */}\n\n      {/* <DraftEditor /> */}\n      {/* <RichEditor2 /> */}\n      {/* <DraftEditor2 /> */}\n      {/* <DraftEditor3 /> */}\n\n      {userName && <DraftEditor4 />}\n\n      <Content />\n\n      {/* <EditorContextProvider /> */}\n      {/* <Content /> */}\n\n\n\n\n\n\n    </>\n  )\n\n}\n\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport { BrowserRouter } from 'react-router-dom'\nimport UserContextProvider from './contexts/UserContextProvider';\nimport ThemeContextProvider from './contexts/ThemeContextProvider';\n\nReactDOM.render(\n\n  <BrowserRouter>\n    <UserContextProvider>\n      <ThemeContextProvider>\n      <App />\n      </ThemeContextProvider>\n    </UserContextProvider>\n  </BrowserRouter>\n\n\n  , document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}